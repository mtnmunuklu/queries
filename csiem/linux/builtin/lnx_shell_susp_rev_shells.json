{
  "Description": "Detects suspicious shell commands or program code that may be executed or used in command line to establish a reverse shell\n\nAuthor: Florian Roth (Nextron Systems)\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "738d9bcf-6999-4fdb-b4ac-3033037db8ab",
  "InsertDate": "2025-01-19T11:33:32Z",
  "LastUpdateDate": "2025-01-19T11:33:32Z",
  "Level": "high",
  "Name": "Suspicious Reverse Shell Command Line",
  "Query": "sourcetype like 'linux-%' eql select * from _source_ where (log like '%begin {s = \"/inet/tcp/0/%' or log like '%bash -i \u003e\u0026 /dev/tcp/%' or log like '%bash -i \u003e\u0026 /dev/udp/%' or log like '%sh -i \u003e$ /dev/udp/%' or log like '%sh -i \u003e$ /dev/tcp/%' or log like '%\u0026\u0026 while read line 0\u003c\u00265; do%' or log like '%/bin/bash -c exec 5\u003c\u003e/dev/tcp/%' or log like '%/bin/bash -c exec 5\u003c\u003e/dev/udp/%' or log like '%nc -e /bin/sh %' or log like '%/bin/sh | nc%' or log like '%rm -f backpipe; mknod /tmp/backpipe p \u0026\u0026 nc %' or log like '%;socket(s,pf_inet,sock_stream,getprotobyname(\"tcp\"));if(connect(s,sockaddr_in($p,inet_aton($i))))%' or log like '%;stdin-\u003efdopen($c,r);$~-\u003efdopen($c,w);system$_ while\u003c\u003e;%' or log like '%/bin/sh -i \u003c\u00263 \u003e\u00263 2\u003e\u00263%' or log like '%uname -a; w; id; /bin/bash -i%' or log like '%$sendbyte = ([text.encoding]::ascii).getbytes($sendback2); $stream.write($sendbyte,0,$sendbyte.length); $stream.flush()};%' or log like '%;os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);os.putenv('histfile','/dev/null');%' or log like '%.to_i;exec sprintf(\"/bin/sh -i \u003c\u0026%d \u003e\u0026%d 2\u003e\u0026%d\",f,f,f)%' or log like '%;while(cmd=c.gets);io.popen(cmd,\"r\"){|io|c.print%' or log like '%socat exec:'bash -li',pty,stderr,setsid,sigint,sane tcp:%' or log like '%rm -f /tmp/p; mknod /tmp/p p \u0026\u0026%' or log like '% | /bin/bash | telnet %' or log like '%,echo=0,raw tcp-listen:%' or log like '%nc -lvvp %' or log like '%xterm -display 1%')",
  "Tags": [
    "attack.execution",
    "attack.t1059.004"
  ],
  "Version": "0.1"
}