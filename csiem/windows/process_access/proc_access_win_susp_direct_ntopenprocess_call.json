{
  "Description": "Detects potential calls to NtOpenProcess directly from NTDLL.\n\nAuthor: Christian Burkard (Nextron Systems), Tim Shelton (FP)\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "3f3f3506-1895-401b-9cc3-e86b16e630d0",
  "InsertDate": "2025-01-21T09:28:15Z",
  "LastUpdateDate": "2025-01-21T09:28:15Z",
  "Level": "medium",
  "Name": "Potential Direct Syscall of NtOpenProcess",
  "Query": "sourcetype='windows-sysmon' eql select * from _source_ where (call_trace like 'unknown%' and  not ((dst_process_path like '%vcredist_x64.exe' and process_path like '%vcredist_x64.exe') or ((process_path like '%:\\program files (x86)\\%' or process_path like '%:\\program files\\%' or process_path like '%:\\windows\\system32\\%' or process_path like '%:\\windows\\syswow64\\%' or process_path like '%:\\windows\\winsxs\\%') and (dst_process_path like '%:\\program files (x86)\\%' or dst_process_path like '%:\\program files\\%' or dst_process_path like '%:\\windows\\system32\\%' or dst_process_path like '%:\\windows\\syswow64\\%' or dst_process_path like '%:\\windows\\winsxs\\%')) or provider_name = 'microsoft-windows-kernel-audit-api-calls') and  not ((process_path like '%:\\windows\\explorer.exe' and dst_process_path like '%:\\program files\\cylance\\desktop\\cylanceui.exe') or (dst_process_path like '%\\appdata\\local\\microsoft\\teams\\current\\teams.exe' and process_path like '%\\appdata\\local\\microsoft\\teams\\current\\teams.exe') or (process_path like '%\\appdata\\local\\yammerdesktop\\app-%' and process_path like '%\\yammer.exe' and dst_process_path like '%\\appdata\\local\\yammerdesktop\\app-%' and dst_process_path like '%\\yammer.exe' and granted_access = '0x1000') or dst_process_path like '%\\evernote\\evernote.exe' or (process_path like '%:\\program files\\adobe\\acrobat dc\\acrobat\\%' and process_path like '%\\acrocef.exe' and dst_process_path like '%:\\program files\\adobe\\acrobat dc\\acrobat\\%' and dst_process_path like '%\\acrocef.exe') or (dst_process_path like '%:\\windows\\system32\\systeminfo.exe' and process_path like '%setup64.exe') or (process_path like '%amazonssmagentsetup.exe' and dst_process_path like '%amazonssmagentsetup.exe') or (process_path like '%\\appdata\\local\\programs\\microsoft vs code\\code.exe' and dst_process_path like '%\\appdata\\local\\programs\\microsoft vs code\\code.exe') or (dst_process_path like '%\\appdata\\local\\discord\\%' and dst_process_path like '%\\discord.exe')))",
  "Tags": [
    "attack.execution",
    "attack.t1106"
  ],
  "Version": "0.1"
}