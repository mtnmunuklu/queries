{
  "Description": "Detects Commandlet names from well-known PowerShell exploitation frameworks\n\nAuthor: Nasreddine Bencherchali (Nextron Systems)\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "7d0d0329-0ef1-4e84-a9f5-49500f9d7c6c",
  "InsertDate": "2025-01-19T11:34:15Z",
  "LastUpdateDate": "2025-01-19T11:34:15Z",
  "Level": "high",
  "Name": "Malicious PowerShell Commandlets - PoshModule",
  "Query": "sourcetype like 'windows-%' eql select * from _source_ where (payload like '%add-exfiltration%' or payload like '%add-persistence%' or payload like '%add-regbackdoor%' or payload like '%add-remoteregbackdoor%' or payload like '%add-scrnsavebackdoor%' or payload like '%check-vm%' or payload like '%convertto-rc4bytestream%' or payload like '%decrypt-hash%' or payload like '%disable-adidnsnode%' or payload like '%disable-machineaccount%' or payload like '%do-exfiltration%' or payload like '%enable-adidnsnode%' or payload like '%enable-machineaccount%' or payload like '%enabled-duplicatetoken%' or payload like '%exploit-jboss%' or payload like '%export-adr%' or payload like '%export-adrcsv%' or payload like '%export-adrexcel%' or payload like '%export-adrhtml%' or payload like '%export-adrjson%' or payload like '%export-adrxml%' or payload like '%find-fruit%' or payload like '%find-gpolocation%' or payload like '%find-trusteddocuments%' or payload like '%get-adidns%' or payload like '%get-applicationhost%' or payload like '%get-chromedump%' or payload like '%get-clipboardcontents%' or payload like '%get-foxdump%' or payload like '%get-gpppassword%' or payload like '%get-indexeditem%' or payload like '%get-kerberosaeskey%' or payload like '%get-keystrokes%' or payload like '%get-lsasecret%' or payload like '%get-machineaccountattribute%' or payload like '%get-machineaccountcreator%' or payload like '%get-passhashes%' or payload like '%get-regalwaysinstallelevated%' or payload like '%get-regautologon%' or payload like '%get-remotebootkey%' or payload like '%get-remotecachedcredential%' or payload like '%get-remotelocalaccounthash%' or payload like '%get-remotelsakey%' or payload like '%get-remotemachineaccounthash%' or payload like '%get-remotenlkmkey%' or payload like '%get-rickastley%' or payload like '%get-screenshot%' or payload like '%get-securitypackages%' or payload like '%get-servicefilepermission%' or payload like '%get-servicepermission%' or payload like '%get-serviceunquoted%' or payload like '%get-sitelistpassword%' or payload like '%get-system%' or payload like '%get-timedscreenshot%' or payload like '%get-unattendedinstallfile%' or payload like '%get-unconstrained%' or payload like '%get-usbkeystrokes%' or payload like '%get-vaultcredential%' or payload like '%get-vulnautorun%' or payload like '%get-vulnschtask%' or payload like '%grant-adidnspermission%' or payload like '%gupt-backdoor%' or payload like '%http-login%' or payload like '%install-servicebinary%' or payload like '%install-ssp%' or payload like '%invoke-aclscanner%' or payload like '%invoke-adrecon%' or payload like '%invoke-adsbackdoor%' or payload like '%invoke-agentsmith%' or payload like '%invoke-allchecks%' or payload like '%invoke-arpscan%' or payload like '%invoke-azurehound%' or payload like '%invoke-backdoorlnk%' or payload like '%invoke-badpotato%' or payload like '%invoke-bettersafetykatz%' or payload like '%invoke-bypassuac%' or payload like '%invoke-carbuncle%' or payload like '%invoke-certify%' or payload like '%invoke-conptyshell%' or payload like '%invoke-credentialinjection%' or payload like '%invoke-daft%' or payload like '%invoke-dcsync%' or payload like '%invoke-dinvokekatz%' or payload like '%invoke-dllinjection%' or payload like '%invoke-dnsupdate%' or payload like '%invoke-domainpasswordspray%' or payload like '%invoke-downgradeaccount%' or payload like '%invoke-egresscheck%' or payload like '%invoke-eyewitness%' or payload like '%invoke-fakelogonscreen%' or payload like '%invoke-farmer%' or payload like '%invoke-get-rbcd-threaded%' or payload like '%invoke-gopher%' or payload like '%invoke-grouper%' or payload like '%invoke-handlekatz%' or payload like '%invoke-impersonatedprocess%' or payload like '%invoke-impersonatesystem%' or payload like '%invoke-interactivesystempowershell%' or payload like '%invoke-internalmonologue%' or payload like '%invoke-inveigh%' or payload like '%invoke-inveighrelay%' or payload like '%invoke-krbrelay%' or payload like '%invoke-ldapsigncheck%' or payload like '%invoke-lockless%' or payload like '%invoke-malsccm%' or payload like '%invoke-mimikatz%' or payload like '%invoke-mimikittenz%' or payload like '%invoke-mitm6%' or payload like '%invoke-nanodump%' or payload like '%invoke-netripper%' or payload like '%invoke-nightmare%' or payload like '%invoke-ninjacopy%' or payload like '%invoke-officescrape%' or payload like '%invoke-oxidresolver%' or payload like '%invoke-p0wnedshell%' or payload like '%invoke-paranoia%' or payload like '%invoke-portscan%' or payload like '%invoke-poshrathttp%' or payload like '%invoke-postexfil%' or payload like '%invoke-powerdump%' or payload like '%invoke-powershelltcp%' or payload like '%invoke-powershellwmi%' or payload like '%invoke-ppldump%' or payload like '%invoke-psexec%' or payload like '%invoke-psinject%' or payload like '%invoke-psuacme%' or payload like '%invoke-reflectivepeinjection%' or payload like '%invoke-reversednslookup%' or payload like '%invoke-rubeus%' or payload like '%invoke-runas%' or payload like '%invoke-safetykatz%' or payload like '%invoke-sauroneye%' or payload like '%invoke-scshell%' or payload like '%invoke-seatbelt%' or payload like '%invoke-serviceabuse%' or payload like '%invoke-shadowspray%' or payload like '%invoke-sharp%' or payload like '%invoke-shellcode%' or payload like '%invoke-smbscanner%' or payload like '%invoke-snaffler%' or payload like '%invoke-spoolsample%' or payload like '%invoke-spraysinglepassword%' or payload like '%invoke-sshcommand%' or payload like '%invoke-standin%' or payload like '%invoke-stickynotesextract%' or payload like '%invoke-systemcommand%' or payload like '%invoke-tasksbackdoor%' or payload like '%invoke-tater%' or payload like '%invoke-thunderfox%' or payload like '%invoke-thunderstruck%' or payload like '%invoke-tokenmanipulation%' or payload like '%invoke-tokenvator%' or payload like '%invoke-totalexec%' or payload like '%invoke-urbanbishop%' or payload like '%invoke-userhunter%' or payload like '%invoke-voicetroll%' or payload like '%invoke-whisker%' or payload like '%invoke-winenum%' or payload like '%invoke-winpeas%' or payload like '%invoke-wiretap%' or payload like '%invoke-wmicommand%' or payload like '%invoke-wmiexec%' or payload like '%invoke-wscriptbypassuac%' or payload like '%invoke-zerologon%' or payload like '%mailraider%' or payload like '%new-adidnsnode%' or payload like '%new-dnsrecordarray%' or payload like '%new-honeyhash%' or payload like '%new-inmemorymodule%' or payload like '%new-machineaccount%' or payload like '%new-soaserialnumberarray%' or payload like '%out-minidump%' or payload like '%port-scan%' or payload like '%powerbreach%' or payload like '%powercat %' or payload like '%powerup%' or payload like '%powerview%' or payload like '%remove-adidnsnode%' or payload like '%remove-machineaccount%' or payload like '%remove-update%' or payload like '%rename-adidnsnode%' or payload like '%revoke-adidnspermission%' or payload like '%set-adidnsnode%' or payload like '%set-macattribute%' or payload like '%set-machineaccountattribute%' or payload like '%set-wallpaper%' or payload like '%show-targetscreen%' or payload like '%start-captureserver%' or payload like '%start-dnscat2%' or payload like '%start-webcamrecorder%' or payload like '%volumeshadowcopytools%')",
  "Tags": [
    "attack.execution",
    "attack.discovery",
    "attack.t1482",
    "attack.t1087",
    "attack.t1087.001",
    "attack.t1087.002",
    "attack.t1069.001",
    "attack.t1069.002",
    "attack.t1069",
    "attack.t1059.001"
  ],
  "Version": "0.1"
}