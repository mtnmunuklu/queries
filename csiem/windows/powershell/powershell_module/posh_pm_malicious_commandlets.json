{
  "Description": "Detects Commandlet names from well-known PowerShell exploitation frameworks\n\nAuthor: Nasreddine Bencherchali (Nextron Systems)\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "7d0d0329-0ef1-4e84-a9f5-49500f9d7c6c",
  "InsertDate": "2025-01-25T21:21:20Z",
  "LastUpdateDate": "2025-01-25T21:21:20Z",
  "Level": "high",
  "Name": "Malicious PowerShell Commandlets - PoshModule",
  "Query": "sourcetype like 'windows-%' eql select * from _source_ where (payload like '%Add-Exfiltration%' or payload like '%Add-Persistence%' or payload like '%Add-RegBackdoor%' or payload like '%Add-RemoteRegBackdoor%' or payload like '%Add-ScrnSaveBackdoor%' or payload like '%Check-VM%' or payload like '%ConvertTo-Rc4ByteStream%' or payload like '%Decrypt-Hash%' or payload like '%Disable-ADIDNSNode%' or payload like '%Disable-MachineAccount%' or payload like '%Do-Exfiltration%' or payload like '%Enable-ADIDNSNode%' or payload like '%Enable-MachineAccount%' or payload like '%Enabled-DuplicateToken%' or payload like '%Exploit-Jboss%' or payload like '%Export-ADR%' or payload like '%Export-ADRCSV%' or payload like '%Export-ADRExcel%' or payload like '%Export-ADRHTML%' or payload like '%Export-ADRJSON%' or payload like '%Export-ADRXML%' or payload like '%Find-Fruit%' or payload like '%Find-GPOLocation%' or payload like '%Find-TrustedDocuments%' or payload like '%Get-ADIDNS%' or payload like '%Get-ApplicationHost%' or payload like '%Get-ChromeDump%' or payload like '%Get-ClipboardContents%' or payload like '%Get-FoxDump%' or payload like '%Get-GPPPassword%' or payload like '%Get-IndexedItem%' or payload like '%Get-KerberosAESKey%' or payload like '%Get-Keystrokes%' or payload like '%Get-LSASecret%' or payload like '%Get-MachineAccountAttribute%' or payload like '%Get-MachineAccountCreator%' or payload like '%Get-PassHashes%' or payload like '%Get-RegAlwaysInstallElevated%' or payload like '%Get-RegAutoLogon%' or payload like '%Get-RemoteBootKey%' or payload like '%Get-RemoteCachedCredential%' or payload like '%Get-RemoteLocalAccountHash%' or payload like '%Get-RemoteLSAKey%' or payload like '%Get-RemoteMachineAccountHash%' or payload like '%Get-RemoteNLKMKey%' or payload like '%Get-RickAstley%' or payload like '%Get-Screenshot%' or payload like '%Get-SecurityPackages%' or payload like '%Get-ServiceFilePermission%' or payload like '%Get-ServicePermission%' or payload like '%Get-ServiceUnquoted%' or payload like '%Get-SiteListPassword%' or payload like '%Get-System%' or payload like '%Get-TimedScreenshot%' or payload like '%Get-UnattendedInstallFile%' or payload like '%Get-Unconstrained%' or payload like '%Get-USBKeystrokes%' or payload like '%Get-VaultCredential%' or payload like '%Get-VulnAutoRun%' or payload like '%Get-VulnSchTask%' or payload like '%Grant-ADIDNSPermission%' or payload like '%Gupt-Backdoor%' or payload like '%HTTP-Login%' or payload like '%Install-ServiceBinary%' or payload like '%Install-SSP%' or payload like '%Invoke-ACLScanner%' or payload like '%Invoke-ADRecon%' or payload like '%Invoke-ADSBackdoor%' or payload like '%Invoke-AgentSmith%' or payload like '%Invoke-AllChecks%' or payload like '%Invoke-ARPScan%' or payload like '%Invoke-AzureHound%' or payload like '%Invoke-BackdoorLNK%' or payload like '%Invoke-BadPotato%' or payload like '%Invoke-BetterSafetyKatz%' or payload like '%Invoke-BypassUAC%' or payload like '%Invoke-Carbuncle%' or payload like '%Invoke-Certify%' or payload like '%Invoke-ConPtyShell%' or payload like '%Invoke-CredentialInjection%' or payload like '%Invoke-DAFT%' or payload like '%Invoke-DCSync%' or payload like '%Invoke-DinvokeKatz%' or payload like '%Invoke-DllInjection%' or payload like '%Invoke-DNSUpdate%' or payload like '%Invoke-DomainPasswordSpray%' or payload like '%Invoke-DowngradeAccount%' or payload like '%Invoke-EgressCheck%' or payload like '%Invoke-Eyewitness%' or payload like '%Invoke-FakeLogonScreen%' or payload like '%Invoke-Farmer%' or payload like '%Invoke-Get-RBCD-Threaded%' or payload like '%Invoke-Gopher%' or payload like '%Invoke-Grouper%' or payload like '%Invoke-HandleKatz%' or payload like '%Invoke-ImpersonatedProcess%' or payload like '%Invoke-ImpersonateSystem%' or payload like '%Invoke-InteractiveSystemPowerShell%' or payload like '%Invoke-Internalmonologue%' or payload like '%Invoke-Inveigh%' or payload like '%Invoke-InveighRelay%' or payload like '%Invoke-KrbRelay%' or payload like '%Invoke-LdapSignCheck%' or payload like '%Invoke-Lockless%' or payload like '%Invoke-MalSCCM%' or payload like '%Invoke-Mimikatz%' or payload like '%Invoke-Mimikittenz%' or payload like '%Invoke-MITM6%' or payload like '%Invoke-NanoDump%' or payload like '%Invoke-NetRipper%' or payload like '%Invoke-Nightmare%' or payload like '%Invoke-NinjaCopy%' or payload like '%Invoke-OfficeScrape%' or payload like '%Invoke-OxidResolver%' or payload like '%Invoke-P0wnedshell%' or payload like '%Invoke-Paranoia%' or payload like '%Invoke-PortScan%' or payload like '%Invoke-PoshRatHttp%' or payload like '%Invoke-PostExfil%' or payload like '%Invoke-PowerDump%' or payload like '%Invoke-PowerShellTCP%' or payload like '%Invoke-PowerShellWMI%' or payload like '%Invoke-PPLDump%' or payload like '%Invoke-PsExec%' or payload like '%Invoke-PSInject%' or payload like '%Invoke-PsUaCme%' or payload like '%Invoke-ReflectivePEInjection%' or payload like '%Invoke-ReverseDNSLookup%' or payload like '%Invoke-Rubeus%' or payload like '%Invoke-RunAs%' or payload like '%Invoke-SafetyKatz%' or payload like '%Invoke-SauronEye%' or payload like '%Invoke-SCShell%' or payload like '%Invoke-Seatbelt%' or payload like '%Invoke-ServiceAbuse%' or payload like '%Invoke-ShadowSpray%' or payload like '%Invoke-Sharp%' or payload like '%Invoke-Shellcode%' or payload like '%Invoke-SMBScanner%' or payload like '%Invoke-Snaffler%' or payload like '%Invoke-Spoolsample%' or payload like '%Invoke-SpraySinglePassword%' or payload like '%Invoke-SSHCommand%' or payload like '%Invoke-StandIn%' or payload like '%Invoke-StickyNotesExtract%' or payload like '%Invoke-SystemCommand%' or payload like '%Invoke-Tasksbackdoor%' or payload like '%Invoke-Tater%' or payload like '%Invoke-Thunderfox%' or payload like '%Invoke-ThunderStruck%' or payload like '%Invoke-TokenManipulation%' or payload like '%Invoke-Tokenvator%' or payload like '%Invoke-TotalExec%' or payload like '%Invoke-UrbanBishop%' or payload like '%Invoke-UserHunter%' or payload like '%Invoke-VoiceTroll%' or payload like '%Invoke-Whisker%' or payload like '%Invoke-WinEnum%' or payload like '%Invoke-winPEAS%' or payload like '%Invoke-WireTap%' or payload like '%Invoke-WmiCommand%' or payload like '%Invoke-WMIExec%' or payload like '%Invoke-WScriptBypassUAC%' or payload like '%Invoke-Zerologon%' or payload like '%MailRaider%' or payload like '%New-ADIDNSNode%' or payload like '%New-DNSRecordArray%' or payload like '%New-HoneyHash%' or payload like '%New-InMemoryModule%' or payload like '%New-MachineAccount%' or payload like '%New-SOASerialNumberArray%' or payload like '%Out-Minidump%' or payload like '%Port-Scan%' or payload like '%PowerBreach%' or payload like '%powercat %' or payload like '%PowerUp%' or payload like '%PowerView%' or payload like '%Remove-ADIDNSNode%' or payload like '%Remove-MachineAccount%' or payload like '%Remove-Update%' or payload like '%Rename-ADIDNSNode%' or payload like '%Revoke-ADIDNSPermission%' or payload like '%Set-ADIDNSNode%' or payload like '%Set-MacAttribute%' or payload like '%Set-MachineAccountAttribute%' or payload like '%Set-Wallpaper%' or payload like '%Show-TargetScreen%' or payload like '%Start-CaptureServer%' or payload like '%Start-Dnscat2%' or payload like '%Start-WebcamRecorder%' or payload like '%VolumeShadowCopyTools%')",
  "Tags": [
    "attack.execution",
    "attack.discovery",
    "attack.t1482",
    "attack.t1087",
    "attack.t1087.001",
    "attack.t1087.002",
    "attack.t1069.001",
    "attack.t1069.002",
    "attack.t1069",
    "attack.t1059.001"
  ],
  "Version": "0.1"
}