{
  "Description": "Detects the execution of known offensive powershell scripts used for exploitation or reconnaissance\n\nAuthor: frack113, Nasreddine Bencherchali (Nextron Systems)\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "41025fd7-0466-4650-a813-574aaacbe7f4",
  "InsertDate": "2025-01-25T21:21:18Z",
  "LastUpdateDate": "2025-01-25T21:21:18Z",
  "Level": "high",
  "Name": "Malicious PowerShell Scripts - PoshModule",
  "Query": "sourcetype like 'windows-%' eql select * from _source_ where ((contextinfo like '%Add-ConstrainedDelegationBackdoor.ps1%' or contextinfo like '%Add-Exfiltration.ps1%' or contextinfo like '%Add-Persistence.ps1%' or contextinfo like '%Add-RegBackdoor.ps1%' or contextinfo like '%Add-RemoteRegBackdoor.ps1%' or contextinfo like '%Add-ScrnSaveBackdoor.ps1%' or contextinfo like '%Check-VM.ps1%' or contextinfo like '%ConvertTo-ROT13.ps1%' or contextinfo like '%Copy-VSS.ps1%' or contextinfo like '%Create-MultipleSessions.ps1%' or contextinfo like '%DNS_TXT_Pwnage.ps1%' or contextinfo like '%dnscat2.ps1%' or contextinfo like '%Do-Exfiltration.ps1%' or contextinfo like '%DomainPasswordSpray.ps1%' or contextinfo like '%Download_Execute.ps1%' or contextinfo like '%Download-Execute-PS.ps1%' or contextinfo like '%Enabled-DuplicateToken.ps1%' or contextinfo like '%Enable-DuplicateToken.ps1%' or contextinfo like '%Execute-Command-MSSQL.ps1%' or contextinfo like '%Execute-DNSTXT-Code.ps1%' or contextinfo like '%Execute-OnTime.ps1%' or contextinfo like '%ExetoText.ps1%' or contextinfo like '%Exploit-Jboss.ps1%' or contextinfo like '%Find-AVSignature.ps1%' or contextinfo like '%Find-Fruit.ps1%' or contextinfo like '%Find-GPOLocation.ps1%' or contextinfo like '%Find-TrustedDocuments.ps1%' or contextinfo like '%FireBuster.ps1%' or contextinfo like '%FireListener.ps1%' or contextinfo like '%Get-ApplicationHost.ps1%' or contextinfo like '%Get-ChromeDump.ps1%' or contextinfo like '%Get-ClipboardContents.ps1%' or contextinfo like '%Get-ComputerDetail.ps1%' or contextinfo like '%Get-FoxDump.ps1%' or contextinfo like '%Get-GPPAutologon.ps1%' or contextinfo like '%Get-GPPPassword.ps1%' or contextinfo like '%Get-IndexedItem.ps1%' or contextinfo like '%Get-Keystrokes.ps1%' or contextinfo like '%Get-LSASecret.ps1%' or contextinfo like '%Get-MicrophoneAudio.ps1%' or contextinfo like '%Get-PassHashes.ps1%' or contextinfo like '%Get-PassHints.ps1%' or contextinfo like '%Get-RegAlwaysInstallElevated.ps1%' or contextinfo like '%Get-RegAutoLogon.ps1%' or contextinfo like '%Get-RickAstley.ps1%' or contextinfo like '%Get-Screenshot.ps1%' or contextinfo like '%Get-SecurityPackages.ps1%' or contextinfo like '%Get-ServiceFilePermission.ps1%' or contextinfo like '%Get-ServicePermission.ps1%' or contextinfo like '%Get-ServiceUnquoted.ps1%' or contextinfo like '%Get-SiteListPassword.ps1%' or contextinfo like '%Get-System.ps1%' or contextinfo like '%Get-TimedScreenshot.ps1%' or contextinfo like '%Get-UnattendedInstallFile.ps1%' or contextinfo like '%Get-Unconstrained.ps1%' or contextinfo like '%Get-USBKeystrokes.ps1%' or contextinfo like '%Get-VaultCredential.ps1%' or contextinfo like '%Get-VulnAutoRun.ps1%' or contextinfo like '%Get-VulnSchTask.ps1%' or contextinfo like '%Get-WebConfig.ps1%' or contextinfo like '%Get-WebCredentials.ps1%' or contextinfo like '%Get-WLAN-Keys.ps1%' or contextinfo like '%Gupt-Backdoor.ps1%' or contextinfo like '%HTTP-Backdoor.ps1%' or contextinfo like '%HTTP-Login.ps1%' or contextinfo like '%Install-ServiceBinary.ps1%' or contextinfo like '%Install-SSP.ps1%' or contextinfo like '%Invoke-ACLScanner.ps1%' or contextinfo like '%Invoke-ADSBackdoor.ps1%' or contextinfo like '%Invoke-AmsiBypass.ps1%' or contextinfo like '%Invoke-ARPScan.ps1%' or contextinfo like '%Invoke-BackdoorLNK.ps1%' or contextinfo like '%Invoke-BadPotato.ps1%' or contextinfo like '%Invoke-BetterSafetyKatz.ps1%' or contextinfo like '%Invoke-BruteForce.ps1%' or contextinfo like '%Invoke-BypassUAC.ps1%' or contextinfo like '%Invoke-Carbuncle.ps1%' or contextinfo like '%Invoke-Certify.ps1%' or contextinfo like '%Invoke-ConPtyShell.ps1%' or contextinfo like '%Invoke-CredentialInjection.ps1%' or contextinfo like '%Invoke-CredentialsPhish.ps1%' or contextinfo like '%Invoke-DAFT.ps1%' or contextinfo like '%Invoke-DCSync.ps1%' or contextinfo like '%Invoke-Decode.ps1%' or contextinfo like '%Invoke-DinvokeKatz.ps1%' or contextinfo like '%Invoke-DllInjection.ps1%' or contextinfo like '%Invoke-DowngradeAccount.ps1%' or contextinfo like '%Invoke-EgressCheck.ps1%' or contextinfo like '%Invoke-Encode.ps1%' or contextinfo like '%Invoke-EventViewer.ps1%' or contextinfo like '%Invoke-Eyewitness.ps1%' or contextinfo like '%Invoke-FakeLogonScreen.ps1%' or contextinfo like '%Invoke-Farmer.ps1%' or contextinfo like '%Invoke-Get-RBCD-Threaded.ps1%' or contextinfo like '%Invoke-Gopher.ps1%' or contextinfo like '%Invoke-Grouper2.ps1%' or contextinfo like '%Invoke-Grouper3.ps1%' or contextinfo like '%Invoke-HandleKatz.ps1%' or contextinfo like '%Invoke-Interceptor.ps1%' or contextinfo like '%Invoke-Internalmonologue.ps1%' or contextinfo like '%Invoke-Inveigh.ps1%' or contextinfo like '%Invoke-InveighRelay.ps1%' or contextinfo like '%Invoke-JSRatRegsvr.ps1%' or contextinfo like '%Invoke-JSRatRundll.ps1%' or contextinfo like '%Invoke-KrbRelay.ps1%' or contextinfo like '%Invoke-KrbRelayUp.ps1%' or contextinfo like '%Invoke-LdapSignCheck.ps1%' or contextinfo like '%Invoke-Lockless.ps1%' or contextinfo like '%Invoke-MalSCCM.ps1%' or contextinfo like '%Invoke-Mimikatz.ps1%' or contextinfo like '%Invoke-MimikatzWDigestDowngrade.ps1%' or contextinfo like '%Invoke-Mimikittenz.ps1%' or contextinfo like '%Invoke-MITM6.ps1%' or contextinfo like '%Invoke-NanoDump.ps1%' or contextinfo like '%Invoke-NetRipper.ps1%' or contextinfo like '%Invoke-NetworkRelay.ps1%' or contextinfo like '%Invoke-NinjaCopy.ps1%' or contextinfo like '%Invoke-OxidResolver.ps1%' or contextinfo like '%Invoke-P0wnedshell.ps1%' or contextinfo like '%Invoke-P0wnedshellx86.ps1%' or contextinfo like '%Invoke-Paranoia.ps1%' or contextinfo like '%Invoke-PortScan.ps1%' or contextinfo like '%Invoke-PoshRatHttp.ps1%' or contextinfo like '%Invoke-PoshRatHttps.ps1%' or contextinfo like '%Invoke-PostExfil.ps1%' or contextinfo like '%Invoke-PowerDump.ps1%' or contextinfo like '%Invoke-PowerShellIcmp.ps1%' or contextinfo like '%Invoke-PowerShellTCP.ps1%' or contextinfo like '%Invoke-PowerShellTcpOneLine.ps1%' or contextinfo like '%Invoke-PowerShellTcpOneLineBind.ps1%' or contextinfo like '%Invoke-PowerShellUdp.ps1%' or contextinfo like '%Invoke-PowerShellUdpOneLine.ps1%' or contextinfo like '%Invoke-PowerShellWMI.ps1%' or contextinfo like '%Invoke-PowerThIEf.ps1%' or contextinfo like '%Invoke-PPLDump.ps1%' or contextinfo like '%Invoke-Prasadhak.ps1%' or contextinfo like '%Invoke-PsExec.ps1%' or contextinfo like '%Invoke-PsGcat.ps1%' or contextinfo like '%Invoke-PsGcatAgent.ps1%' or contextinfo like '%Invoke-PSInject.ps1%' or contextinfo like '%Invoke-PsUaCme.ps1%' or contextinfo like '%Invoke-ReflectivePEInjection.ps1%' or contextinfo like '%Invoke-ReverseDNSLookup.ps1%' or contextinfo like '%Invoke-Rubeus.ps1%' or contextinfo like '%Invoke-RunAs.ps1%' or contextinfo like '%Invoke-SafetyKatz.ps1%' or contextinfo like '%Invoke-SauronEye.ps1%' or contextinfo like '%Invoke-SCShell.ps1%' or contextinfo like '%Invoke-Seatbelt.ps1%' or contextinfo like '%Invoke-ServiceAbuse.ps1%' or contextinfo like '%Invoke-SessionGopher.ps1%' or contextinfo like '%Invoke-ShellCode.ps1%' or contextinfo like '%Invoke-SMBScanner.ps1%' or contextinfo like '%Invoke-Snaffler.ps1%' or contextinfo like '%Invoke-Spoolsample.ps1%' or contextinfo like '%Invoke-SSHCommand.ps1%' or contextinfo like '%Invoke-SSIDExfil.ps1%' or contextinfo like '%Invoke-StandIn.ps1%' or contextinfo like '%Invoke-StickyNotesExtract.ps1%' or contextinfo like '%Invoke-Tater.ps1%' or contextinfo like '%Invoke-Thunderfox.ps1%' or contextinfo like '%Invoke-ThunderStruck.ps1%' or contextinfo like '%Invoke-TokenManipulation.ps1%' or contextinfo like '%Invoke-Tokenvator.ps1%' or contextinfo like '%Invoke-TotalExec.ps1%' or contextinfo like '%Invoke-UrbanBishop.ps1%' or contextinfo like '%Invoke-UserHunter.ps1%' or contextinfo like '%Invoke-VoiceTroll.ps1%' or contextinfo like '%Invoke-Whisker.ps1%' or contextinfo like '%Invoke-WinEnum.ps1%' or contextinfo like '%Invoke-winPEAS.ps1%' or contextinfo like '%Invoke-WireTap.ps1%' or contextinfo like '%Invoke-WmiCommand.ps1%' or contextinfo like '%Invoke-WScriptBypassUAC.ps1%' or contextinfo like '%Invoke-Zerologon.ps1%' or contextinfo like '%Keylogger.ps1%' or contextinfo like '%MailRaider.ps1%' or contextinfo like '%New-HoneyHash.ps1%' or contextinfo like '%OfficeMemScraper.ps1%' or contextinfo like '%Offline_Winpwn.ps1%' or contextinfo like '%Out-CHM.ps1%' or contextinfo like '%Out-DnsTxt.ps1%' or contextinfo like '%Out-Excel.ps1%' or contextinfo like '%Out-HTA.ps1%' or contextinfo like '%Out-Java.ps1%' or contextinfo like '%Out-JS.ps1%' or contextinfo like '%Out-Minidump.ps1%' or contextinfo like '%Out-RundllCommand.ps1%' or contextinfo like '%Out-SCF.ps1%' or contextinfo like '%Out-SCT.ps1%' or contextinfo like '%Out-Shortcut.ps1%' or contextinfo like '%Out-WebQuery.ps1%' or contextinfo like '%Out-Word.ps1%' or contextinfo like '%Parse_Keys.ps1%' or contextinfo like '%Port-Scan.ps1%' or contextinfo like '%PowerBreach.ps1%' or contextinfo like '%powercat.ps1%' or contextinfo like '%PowerRunAsSystem.psm1%' or contextinfo like '%PowerSharpPack.ps1%' or contextinfo like '%PowerUp.ps1%' or contextinfo like '%PowerUpSQL.ps1%' or contextinfo like '%PowerView.ps1%' or contextinfo like '%PSAsyncShell.ps1%' or contextinfo like '%RemoteHashRetrieval.ps1%' or contextinfo like '%Remove-Persistence.ps1%' or contextinfo like '%Remove-PoshRat.ps1%' or contextinfo like '%Remove-Update.ps1%' or contextinfo like '%Run-EXEonRemote.ps1%' or contextinfo like '%Schtasks-Backdoor.ps1%' or contextinfo like '%Set-DCShadowPermissions.ps1%' or contextinfo like '%Set-MacAttribute.ps1%' or contextinfo like '%Set-RemotePSRemoting.ps1%' or contextinfo like '%Set-RemoteWMI.ps1%' or contextinfo like '%Set-Wallpaper.ps1%' or contextinfo like '%Show-TargetScreen.ps1%' or contextinfo like '%Speak.ps1%' or contextinfo like '%Start-CaptureServer.ps1%' or contextinfo like '%Start-WebcamRecorder.ps1%' or contextinfo like '%StringToBase64.ps1%' or contextinfo like '%TexttoExe.ps1%' or contextinfo like '%VolumeShadowCopyTools.ps1%' or contextinfo like '%WinPwn.ps1%' or contextinfo like '%WSUSpendu.ps1%') or (contextinfo like '%Invoke-Sharp%' and contextinfo like '%.ps1%'))",
  "Tags": [
    "attack.execution",
    "attack.t1059.001"
  ],
  "Version": "0.1"
}