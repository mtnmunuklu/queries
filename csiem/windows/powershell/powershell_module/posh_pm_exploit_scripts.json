{
  "Description": "Detects the execution of known offensive powershell scripts used for exploitation or reconnaissance\n\nAuthor: frack113, Nasreddine Bencherchali (Nextron Systems)\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "41025fd7-0466-4650-a813-574aaacbe7f4",
  "InsertDate": "2025-01-21T09:27:58Z",
  "LastUpdateDate": "2025-01-21T09:27:58Z",
  "Level": "high",
  "Name": "Malicious PowerShell Scripts - PoshModule",
  "Query": "sourcetype like 'windows-%' eql select * from _source_ where ((contextinfo like '%invoke-sharp%' and contextinfo like '%.ps1%') or (contextinfo like '%add-constraineddelegationbackdoor.ps1%' or contextinfo like '%add-exfiltration.ps1%' or contextinfo like '%add-persistence.ps1%' or contextinfo like '%add-regbackdoor.ps1%' or contextinfo like '%add-remoteregbackdoor.ps1%' or contextinfo like '%add-scrnsavebackdoor.ps1%' or contextinfo like '%check-vm.ps1%' or contextinfo like '%convertto-rot13.ps1%' or contextinfo like '%copy-vss.ps1%' or contextinfo like '%create-multiplesessions.ps1%' or contextinfo like '%dns_txt_pwnage.ps1%' or contextinfo like '%dnscat2.ps1%' or contextinfo like '%do-exfiltration.ps1%' or contextinfo like '%domainpasswordspray.ps1%' or contextinfo like '%download_execute.ps1%' or contextinfo like '%download-execute-ps.ps1%' or contextinfo like '%enabled-duplicatetoken.ps1%' or contextinfo like '%enable-duplicatetoken.ps1%' or contextinfo like '%execute-command-mssql.ps1%' or contextinfo like '%execute-dnstxt-code.ps1%' or contextinfo like '%execute-ontime.ps1%' or contextinfo like '%exetotext.ps1%' or contextinfo like '%exploit-jboss.ps1%' or contextinfo like '%find-avsignature.ps1%' or contextinfo like '%find-fruit.ps1%' or contextinfo like '%find-gpolocation.ps1%' or contextinfo like '%find-trusteddocuments.ps1%' or contextinfo like '%firebuster.ps1%' or contextinfo like '%firelistener.ps1%' or contextinfo like '%get-applicationhost.ps1%' or contextinfo like '%get-chromedump.ps1%' or contextinfo like '%get-clipboardcontents.ps1%' or contextinfo like '%get-computerdetail.ps1%' or contextinfo like '%get-foxdump.ps1%' or contextinfo like '%get-gppautologon.ps1%' or contextinfo like '%get-gpppassword.ps1%' or contextinfo like '%get-indexeditem.ps1%' or contextinfo like '%get-keystrokes.ps1%' or contextinfo like '%get-lsasecret.ps1%' or contextinfo like '%get-microphoneaudio.ps1%' or contextinfo like '%get-passhashes.ps1%' or contextinfo like '%get-passhints.ps1%' or contextinfo like '%get-regalwaysinstallelevated.ps1%' or contextinfo like '%get-regautologon.ps1%' or contextinfo like '%get-rickastley.ps1%' or contextinfo like '%get-screenshot.ps1%' or contextinfo like '%get-securitypackages.ps1%' or contextinfo like '%get-servicefilepermission.ps1%' or contextinfo like '%get-servicepermission.ps1%' or contextinfo like '%get-serviceunquoted.ps1%' or contextinfo like '%get-sitelistpassword.ps1%' or contextinfo like '%get-system.ps1%' or contextinfo like '%get-timedscreenshot.ps1%' or contextinfo like '%get-unattendedinstallfile.ps1%' or contextinfo like '%get-unconstrained.ps1%' or contextinfo like '%get-usbkeystrokes.ps1%' or contextinfo like '%get-vaultcredential.ps1%' or contextinfo like '%get-vulnautorun.ps1%' or contextinfo like '%get-vulnschtask.ps1%' or contextinfo like '%get-webconfig.ps1%' or contextinfo like '%get-webcredentials.ps1%' or contextinfo like '%get-wlan-keys.ps1%' or contextinfo like '%gupt-backdoor.ps1%' or contextinfo like '%http-backdoor.ps1%' or contextinfo like '%http-login.ps1%' or contextinfo like '%install-servicebinary.ps1%' or contextinfo like '%install-ssp.ps1%' or contextinfo like '%invoke-aclscanner.ps1%' or contextinfo like '%invoke-adsbackdoor.ps1%' or contextinfo like '%invoke-amsibypass.ps1%' or contextinfo like '%invoke-arpscan.ps1%' or contextinfo like '%invoke-backdoorlnk.ps1%' or contextinfo like '%invoke-badpotato.ps1%' or contextinfo like '%invoke-bettersafetykatz.ps1%' or contextinfo like '%invoke-bruteforce.ps1%' or contextinfo like '%invoke-bypassuac.ps1%' or contextinfo like '%invoke-carbuncle.ps1%' or contextinfo like '%invoke-certify.ps1%' or contextinfo like '%invoke-conptyshell.ps1%' or contextinfo like '%invoke-credentialinjection.ps1%' or contextinfo like '%invoke-credentialsphish.ps1%' or contextinfo like '%invoke-daft.ps1%' or contextinfo like '%invoke-dcsync.ps1%' or contextinfo like '%invoke-decode.ps1%' or contextinfo like '%invoke-dinvokekatz.ps1%' or contextinfo like '%invoke-dllinjection.ps1%' or contextinfo like '%invoke-downgradeaccount.ps1%' or contextinfo like '%invoke-egresscheck.ps1%' or contextinfo like '%invoke-encode.ps1%' or contextinfo like '%invoke-eventviewer.ps1%' or contextinfo like '%invoke-eyewitness.ps1%' or contextinfo like '%invoke-fakelogonscreen.ps1%' or contextinfo like '%invoke-farmer.ps1%' or contextinfo like '%invoke-get-rbcd-threaded.ps1%' or contextinfo like '%invoke-gopher.ps1%' or contextinfo like '%invoke-grouper2.ps1%' or contextinfo like '%invoke-grouper3.ps1%' or contextinfo like '%invoke-handlekatz.ps1%' or contextinfo like '%invoke-interceptor.ps1%' or contextinfo like '%invoke-internalmonologue.ps1%' or contextinfo like '%invoke-inveigh.ps1%' or contextinfo like '%invoke-inveighrelay.ps1%' or contextinfo like '%invoke-jsratregsvr.ps1%' or contextinfo like '%invoke-jsratrundll.ps1%' or contextinfo like '%invoke-krbrelay.ps1%' or contextinfo like '%invoke-krbrelayup.ps1%' or contextinfo like '%invoke-ldapsigncheck.ps1%' or contextinfo like '%invoke-lockless.ps1%' or contextinfo like '%invoke-malsccm.ps1%' or contextinfo like '%invoke-mimikatz.ps1%' or contextinfo like '%invoke-mimikatzwdigestdowngrade.ps1%' or contextinfo like '%invoke-mimikittenz.ps1%' or contextinfo like '%invoke-mitm6.ps1%' or contextinfo like '%invoke-nanodump.ps1%' or contextinfo like '%invoke-netripper.ps1%' or contextinfo like '%invoke-networkrelay.ps1%' or contextinfo like '%invoke-ninjacopy.ps1%' or contextinfo like '%invoke-oxidresolver.ps1%' or contextinfo like '%invoke-p0wnedshell.ps1%' or contextinfo like '%invoke-p0wnedshellx86.ps1%' or contextinfo like '%invoke-paranoia.ps1%' or contextinfo like '%invoke-portscan.ps1%' or contextinfo like '%invoke-poshrathttp.ps1%' or contextinfo like '%invoke-poshrathttps.ps1%' or contextinfo like '%invoke-postexfil.ps1%' or contextinfo like '%invoke-powerdump.ps1%' or contextinfo like '%invoke-powershellicmp.ps1%' or contextinfo like '%invoke-powershelltcp.ps1%' or contextinfo like '%invoke-powershelltcponeline.ps1%' or contextinfo like '%invoke-powershelltcponelinebind.ps1%' or contextinfo like '%invoke-powershelludp.ps1%' or contextinfo like '%invoke-powershelludponeline.ps1%' or contextinfo like '%invoke-powershellwmi.ps1%' or contextinfo like '%invoke-powerthief.ps1%' or contextinfo like '%invoke-ppldump.ps1%' or contextinfo like '%invoke-prasadhak.ps1%' or contextinfo like '%invoke-psexec.ps1%' or contextinfo like '%invoke-psgcat.ps1%' or contextinfo like '%invoke-psgcatagent.ps1%' or contextinfo like '%invoke-psinject.ps1%' or contextinfo like '%invoke-psuacme.ps1%' or contextinfo like '%invoke-reflectivepeinjection.ps1%' or contextinfo like '%invoke-reversednslookup.ps1%' or contextinfo like '%invoke-rubeus.ps1%' or contextinfo like '%invoke-runas.ps1%' or contextinfo like '%invoke-safetykatz.ps1%' or contextinfo like '%invoke-sauroneye.ps1%' or contextinfo like '%invoke-scshell.ps1%' or contextinfo like '%invoke-seatbelt.ps1%' or contextinfo like '%invoke-serviceabuse.ps1%' or contextinfo like '%invoke-sessiongopher.ps1%' or contextinfo like '%invoke-shellcode.ps1%' or contextinfo like '%invoke-smbscanner.ps1%' or contextinfo like '%invoke-snaffler.ps1%' or contextinfo like '%invoke-spoolsample.ps1%' or contextinfo like '%invoke-sshcommand.ps1%' or contextinfo like '%invoke-ssidexfil.ps1%' or contextinfo like '%invoke-standin.ps1%' or contextinfo like '%invoke-stickynotesextract.ps1%' or contextinfo like '%invoke-tater.ps1%' or contextinfo like '%invoke-thunderfox.ps1%' or contextinfo like '%invoke-thunderstruck.ps1%' or contextinfo like '%invoke-tokenmanipulation.ps1%' or contextinfo like '%invoke-tokenvator.ps1%' or contextinfo like '%invoke-totalexec.ps1%' or contextinfo like '%invoke-urbanbishop.ps1%' or contextinfo like '%invoke-userhunter.ps1%' or contextinfo like '%invoke-voicetroll.ps1%' or contextinfo like '%invoke-whisker.ps1%' or contextinfo like '%invoke-winenum.ps1%' or contextinfo like '%invoke-winpeas.ps1%' or contextinfo like '%invoke-wiretap.ps1%' or contextinfo like '%invoke-wmicommand.ps1%' or contextinfo like '%invoke-wscriptbypassuac.ps1%' or contextinfo like '%invoke-zerologon.ps1%' or contextinfo like '%keylogger.ps1%' or contextinfo like '%mailraider.ps1%' or contextinfo like '%new-honeyhash.ps1%' or contextinfo like '%officememscraper.ps1%' or contextinfo like '%offline_winpwn.ps1%' or contextinfo like '%out-chm.ps1%' or contextinfo like '%out-dnstxt.ps1%' or contextinfo like '%out-excel.ps1%' or contextinfo like '%out-hta.ps1%' or contextinfo like '%out-java.ps1%' or contextinfo like '%out-js.ps1%' or contextinfo like '%out-minidump.ps1%' or contextinfo like '%out-rundllcommand.ps1%' or contextinfo like '%out-scf.ps1%' or contextinfo like '%out-sct.ps1%' or contextinfo like '%out-shortcut.ps1%' or contextinfo like '%out-webquery.ps1%' or contextinfo like '%out-word.ps1%' or contextinfo like '%parse_keys.ps1%' or contextinfo like '%port-scan.ps1%' or contextinfo like '%powerbreach.ps1%' or contextinfo like '%powercat.ps1%' or contextinfo like '%powerrunassystem.psm1%' or contextinfo like '%powersharppack.ps1%' or contextinfo like '%powerup.ps1%' or contextinfo like '%powerupsql.ps1%' or contextinfo like '%powerview.ps1%' or contextinfo like '%psasyncshell.ps1%' or contextinfo like '%remotehashretrieval.ps1%' or contextinfo like '%remove-persistence.ps1%' or contextinfo like '%remove-poshrat.ps1%' or contextinfo like '%remove-update.ps1%' or contextinfo like '%run-exeonremote.ps1%' or contextinfo like '%schtasks-backdoor.ps1%' or contextinfo like '%set-dcshadowpermissions.ps1%' or contextinfo like '%set-macattribute.ps1%' or contextinfo like '%set-remotepsremoting.ps1%' or contextinfo like '%set-remotewmi.ps1%' or contextinfo like '%set-wallpaper.ps1%' or contextinfo like '%show-targetscreen.ps1%' or contextinfo like '%speak.ps1%' or contextinfo like '%start-captureserver.ps1%' or contextinfo like '%start-webcamrecorder.ps1%' or contextinfo like '%stringtobase64.ps1%' or contextinfo like '%texttoexe.ps1%' or contextinfo like '%volumeshadowcopytools.ps1%' or contextinfo like '%winpwn.ps1%' or contextinfo like '%wsuspendu.ps1%'))",
  "Tags": [
    "attack.execution",
    "attack.t1059.001"
  ],
  "Version": "0.1"
}