{
  "Description": "Detects Commandlet names from well-known PowerShell exploitation frameworks\n\nAuthor: Sean Metcalf, Florian Roth, Bartlomiej Czyz @bczyz1, oscd.community, Nasreddine Bencherchali, Tim Shelton, Mustafa Kaan Demir, Georg Lauenstein, Max Altgelt, Tobias Michalski, Austin Songer\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "89819aa4-bbd6-46bc-88ec-c7f7fe30efa6",
  "InsertDate": "2025-01-25T21:21:26Z",
  "LastUpdateDate": "2025-01-25T21:21:26Z",
  "Level": "high",
  "Name": "Malicious PowerShell Commandlets - ScriptBlock",
  "Query": "sourcetype like 'windows-%' eql select * from _source_ where ((scriptblocktext like '%Add-Exfiltration%' or scriptblocktext like '%Add-Persistence%' or scriptblocktext like '%Add-RegBackdoor%' or scriptblocktext like '%Add-RemoteRegBackdoor%' or scriptblocktext like '%Add-ScrnSaveBackdoor%' or scriptblocktext like '%ConvertTo-Rc4ByteStream%' or scriptblocktext like '%Decrypt-Hash%' or scriptblocktext like '%Disable-ADIDNSNode%' or scriptblocktext like '%Do-Exfiltration%' or scriptblocktext like '%Enable-ADIDNSNode%' or scriptblocktext like '%Enabled-DuplicateToken%' or scriptblocktext like '%Exploit-Jboss%' or scriptblocktext like '%Export-ADRCSV%' or scriptblocktext like '%Export-ADRExcel%' or scriptblocktext like '%Export-ADRHTML%' or scriptblocktext like '%Export-ADRJSON%' or scriptblocktext like '%Export-ADRXML%' or scriptblocktext like '%Find-Fruit%' or scriptblocktext like '%Find-GPOLocation%' or scriptblocktext like '%Find-TrustedDocuments%' or scriptblocktext like '%Get-ADIDNSNodeAttribute%' or scriptblocktext like '%Get-ADIDNSNodeOwner%' or scriptblocktext like '%Get-ADIDNSNodeTombstoned%' or scriptblocktext like '%Get-ADIDNSPermission%' or scriptblocktext like '%Get-ADIDNSZone%' or scriptblocktext like '%Get-ChromeDump%' or scriptblocktext like '%Get-ClipboardContents%' or scriptblocktext like '%Get-FoxDump%' or scriptblocktext like '%Get-GPPPassword%' or scriptblocktext like '%Get-IndexedItem%' or scriptblocktext like '%Get-KerberosAESKey%' or scriptblocktext like '%Get-Keystrokes%' or scriptblocktext like '%Get-LSASecret%' or scriptblocktext like '%Get-PassHashes%' or scriptblocktext like '%Get-RegAlwaysInstallElevated%' or scriptblocktext like '%Get-RegAutoLogon%' or scriptblocktext like '%Get-RemoteBootKey%' or scriptblocktext like '%Get-RemoteCachedCredential%' or scriptblocktext like '%Get-RemoteLocalAccountHash%' or scriptblocktext like '%Get-RemoteLSAKey%' or scriptblocktext like '%Get-RemoteMachineAccountHash%' or scriptblocktext like '%Get-RemoteNLKMKey%' or scriptblocktext like '%Get-RickAstley%' or scriptblocktext like '%Get-SecurityPackages%' or scriptblocktext like '%Get-ServiceFilePermission%' or scriptblocktext like '%Get-ServicePermission%' or scriptblocktext like '%Get-ServiceUnquoted%' or scriptblocktext like '%Get-SiteListPassword%' or scriptblocktext like '%Get-System%' or scriptblocktext like '%Get-TimedScreenshot%' or scriptblocktext like '%Get-UnattendedInstallFile%' or scriptblocktext like '%Get-Unconstrained%' or scriptblocktext like '%Get-USBKeystrokes%' or scriptblocktext like '%Get-VaultCredential%' or scriptblocktext like '%Get-VulnAutoRun%' or scriptblocktext like '%Get-VulnSchTask%' or scriptblocktext like '%Grant-ADIDNSPermission%' or scriptblocktext like '%Gupt-Backdoor%' or scriptblocktext like '%Invoke-ACLScanner%' or scriptblocktext like '%Invoke-ADRecon%' or scriptblocktext like '%Invoke-ADSBackdoor%' or scriptblocktext like '%Invoke-AgentSmith%' or scriptblocktext like '%Invoke-AllChecks%' or scriptblocktext like '%Invoke-ARPScan%' or scriptblocktext like '%Invoke-AzureHound%' or scriptblocktext like '%Invoke-BackdoorLNK%' or scriptblocktext like '%Invoke-BadPotato%' or scriptblocktext like '%Invoke-BetterSafetyKatz%' or scriptblocktext like '%Invoke-BypassUAC%' or scriptblocktext like '%Invoke-Carbuncle%' or scriptblocktext like '%Invoke-Certify%' or scriptblocktext like '%Invoke-ConPtyShell%' or scriptblocktext like '%Invoke-CredentialInjection%' or scriptblocktext like '%Invoke-DAFT%' or scriptblocktext like '%Invoke-DCSync%' or scriptblocktext like '%Invoke-DinvokeKatz%' or scriptblocktext like '%Invoke-DllInjection%' or scriptblocktext like '%Invoke-DNSUpdate%' or scriptblocktext like '%Invoke-DomainPasswordSpray%' or scriptblocktext like '%Invoke-DowngradeAccount%' or scriptblocktext like '%Invoke-EgressCheck%' or scriptblocktext like '%Invoke-Eyewitness%' or scriptblocktext like '%Invoke-FakeLogonScreen%' or scriptblocktext like '%Invoke-Farmer%' or scriptblocktext like '%Invoke-Get-RBCD-Threaded%' or scriptblocktext like '%Invoke-Gopher%' or scriptblocktext like '%Invoke-Grouper%' or scriptblocktext like '%Invoke-HandleKatz%' or scriptblocktext like '%Invoke-ImpersonatedProcess%' or scriptblocktext like '%Invoke-ImpersonateSystem%' or scriptblocktext like '%Invoke-InteractiveSystemPowerShell%' or scriptblocktext like '%Invoke-Internalmonologue%' or scriptblocktext like '%Invoke-Inveigh%' or scriptblocktext like '%Invoke-InveighRelay%' or scriptblocktext like '%Invoke-KrbRelay%' or scriptblocktext like '%Invoke-LdapSignCheck%' or scriptblocktext like '%Invoke-Lockless%' or scriptblocktext like '%Invoke-MalSCCM%' or scriptblocktext like '%Invoke-Mimikatz%' or scriptblocktext like '%Invoke-Mimikittenz%' or scriptblocktext like '%Invoke-MITM6%' or scriptblocktext like '%Invoke-NanoDump%' or scriptblocktext like '%Invoke-NetRipper%' or scriptblocktext like '%Invoke-Nightmare%' or scriptblocktext like '%Invoke-NinjaCopy%' or scriptblocktext like '%Invoke-OfficeScrape%' or scriptblocktext like '%Invoke-OxidResolver%' or scriptblocktext like '%Invoke-P0wnedshell%' or scriptblocktext like '%Invoke-Paranoia%' or scriptblocktext like '%Invoke-PortScan%' or scriptblocktext like '%Invoke-PoshRatHttp%' or scriptblocktext like '%Invoke-PostExfil%' or scriptblocktext like '%Invoke-PowerDump%' or scriptblocktext like '%Invoke-PowerShellTCP%' or scriptblocktext like '%Invoke-PowerShellWMI%' or scriptblocktext like '%Invoke-PPLDump%' or scriptblocktext like '%Invoke-PsExec%' or scriptblocktext like '%Invoke-PSInject%' or scriptblocktext like '%Invoke-PsUaCme%' or scriptblocktext like '%Invoke-ReflectivePEInjection%' or scriptblocktext like '%Invoke-ReverseDNSLookup%' or scriptblocktext like '%Invoke-Rubeus%' or scriptblocktext like '%Invoke-RunAs%' or scriptblocktext like '%Invoke-SafetyKatz%' or scriptblocktext like '%Invoke-SauronEye%' or scriptblocktext like '%Invoke-SCShell%' or scriptblocktext like '%Invoke-Seatbelt%' or scriptblocktext like '%Invoke-ServiceAbuse%' or scriptblocktext like '%Invoke-ShadowSpray%' or scriptblocktext like '%Invoke-Sharp%' or scriptblocktext like '%Invoke-Shellcode%' or scriptblocktext like '%Invoke-SMBScanner%' or scriptblocktext like '%Invoke-Snaffler%' or scriptblocktext like '%Invoke-Spoolsample%' or scriptblocktext like '%Invoke-SpraySinglePassword%' or scriptblocktext like '%Invoke-SSHCommand%' or scriptblocktext like '%Invoke-StandIn%' or scriptblocktext like '%Invoke-StickyNotesExtract%' or scriptblocktext like '%Invoke-SystemCommand%' or scriptblocktext like '%Invoke-Tasksbackdoor%' or scriptblocktext like '%Invoke-Tater%' or scriptblocktext like '%Invoke-Thunderfox%' or scriptblocktext like '%Invoke-ThunderStruck%' or scriptblocktext like '%Invoke-TokenManipulation%' or scriptblocktext like '%Invoke-Tokenvator%' or scriptblocktext like '%Invoke-TotalExec%' or scriptblocktext like '%Invoke-UrbanBishop%' or scriptblocktext like '%Invoke-UserHunter%' or scriptblocktext like '%Invoke-VoiceTroll%' or scriptblocktext like '%Invoke-Whisker%' or scriptblocktext like '%Invoke-WinEnum%' or scriptblocktext like '%Invoke-winPEAS%' or scriptblocktext like '%Invoke-WireTap%' or scriptblocktext like '%Invoke-WmiCommand%' or scriptblocktext like '%Invoke-WMIExec%' or scriptblocktext like '%Invoke-WScriptBypassUAC%' or scriptblocktext like '%Invoke-Zerologon%' or scriptblocktext like '%MailRaider%' or scriptblocktext like '%New-ADIDNSNode%' or scriptblocktext like '%New-HoneyHash%' or scriptblocktext like '%New-InMemoryModule%' or scriptblocktext like '%New-SOASerialNumberArray%' or scriptblocktext like '%Out-Minidump%' or scriptblocktext like '%PowerBreach%' or scriptblocktext like '%powercat %' or scriptblocktext like '%PowerUp%' or scriptblocktext like '%PowerView%' or scriptblocktext like '%Remove-ADIDNSNode%' or scriptblocktext like '%Remove-Update%' or scriptblocktext like '%Rename-ADIDNSNode%' or scriptblocktext like '%Revoke-ADIDNSPermission%' or scriptblocktext like '%Set-ADIDNSNode%' or scriptblocktext like '%Show-TargetScreen%' or scriptblocktext like '%Start-CaptureServer%' or scriptblocktext like '%Start-Dnscat2%' or scriptblocktext like '%Start-WebcamRecorder%' or scriptblocktext like '%VolumeShadowCopyTools%') and  not (scriptblocktext like '%Get-SystemDriveInfo%' or scriptblocktext like '%C:\\ProgramData\\Amazon\\EC2-Windows\\Launch\\Module\\%'))",
  "Tags": [
    "attack.execution",
    "attack.discovery",
    "attack.t1482",
    "attack.t1087",
    "attack.t1087.001",
    "attack.t1087.002",
    "attack.t1069.001",
    "attack.t1069.002",
    "attack.t1069",
    "attack.t1059.001"
  ],
  "Version": "0.1"
}