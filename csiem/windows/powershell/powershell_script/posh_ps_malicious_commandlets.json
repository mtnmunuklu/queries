{
  "Description": "Detects Commandlet names from well-known PowerShell exploitation frameworks\n\nAuthor: Sean Metcalf, Florian Roth, Bartlomiej Czyz @bczyz1, oscd.community, Nasreddine Bencherchali, Tim Shelton, Mustafa Kaan Demir, Georg Lauenstein, Max Altgelt, Tobias Michalski, Austin Songer\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "89819aa4-bbd6-46bc-88ec-c7f7fe30efa6",
  "InsertDate": "2025-01-19T11:34:20Z",
  "LastUpdateDate": "2025-01-19T11:34:20Z",
  "Level": "high",
  "Name": "Malicious PowerShell Commandlets - ScriptBlock",
  "Query": "sourcetype like 'windows-%' eql select * from _source_ where ((scriptblocktext like '%add-exfiltration%' or scriptblocktext like '%add-persistence%' or scriptblocktext like '%add-regbackdoor%' or scriptblocktext like '%add-remoteregbackdoor%' or scriptblocktext like '%add-scrnsavebackdoor%' or scriptblocktext like '%convertto-rc4bytestream%' or scriptblocktext like '%decrypt-hash%' or scriptblocktext like '%disable-adidnsnode%' or scriptblocktext like '%do-exfiltration%' or scriptblocktext like '%enable-adidnsnode%' or scriptblocktext like '%enabled-duplicatetoken%' or scriptblocktext like '%exploit-jboss%' or scriptblocktext like '%export-adrcsv%' or scriptblocktext like '%export-adrexcel%' or scriptblocktext like '%export-adrhtml%' or scriptblocktext like '%export-adrjson%' or scriptblocktext like '%export-adrxml%' or scriptblocktext like '%find-fruit%' or scriptblocktext like '%find-gpolocation%' or scriptblocktext like '%find-trusteddocuments%' or scriptblocktext like '%get-adidnsnodeattribute%' or scriptblocktext like '%get-adidnsnodeowner%' or scriptblocktext like '%get-adidnsnodetombstoned%' or scriptblocktext like '%get-adidnspermission%' or scriptblocktext like '%get-adidnszone%' or scriptblocktext like '%get-chromedump%' or scriptblocktext like '%get-clipboardcontents%' or scriptblocktext like '%get-foxdump%' or scriptblocktext like '%get-gpppassword%' or scriptblocktext like '%get-indexeditem%' or scriptblocktext like '%get-kerberosaeskey%' or scriptblocktext like '%get-keystrokes%' or scriptblocktext like '%get-lsasecret%' or scriptblocktext like '%get-passhashes%' or scriptblocktext like '%get-regalwaysinstallelevated%' or scriptblocktext like '%get-regautologon%' or scriptblocktext like '%get-remotebootkey%' or scriptblocktext like '%get-remotecachedcredential%' or scriptblocktext like '%get-remotelocalaccounthash%' or scriptblocktext like '%get-remotelsakey%' or scriptblocktext like '%get-remotemachineaccounthash%' or scriptblocktext like '%get-remotenlkmkey%' or scriptblocktext like '%get-rickastley%' or scriptblocktext like '%get-securitypackages%' or scriptblocktext like '%get-servicefilepermission%' or scriptblocktext like '%get-servicepermission%' or scriptblocktext like '%get-serviceunquoted%' or scriptblocktext like '%get-sitelistpassword%' or scriptblocktext like '%get-system%' or scriptblocktext like '%get-timedscreenshot%' or scriptblocktext like '%get-unattendedinstallfile%' or scriptblocktext like '%get-unconstrained%' or scriptblocktext like '%get-usbkeystrokes%' or scriptblocktext like '%get-vaultcredential%' or scriptblocktext like '%get-vulnautorun%' or scriptblocktext like '%get-vulnschtask%' or scriptblocktext like '%grant-adidnspermission%' or scriptblocktext like '%gupt-backdoor%' or scriptblocktext like '%invoke-aclscanner%' or scriptblocktext like '%invoke-adrecon%' or scriptblocktext like '%invoke-adsbackdoor%' or scriptblocktext like '%invoke-agentsmith%' or scriptblocktext like '%invoke-allchecks%' or scriptblocktext like '%invoke-arpscan%' or scriptblocktext like '%invoke-azurehound%' or scriptblocktext like '%invoke-backdoorlnk%' or scriptblocktext like '%invoke-badpotato%' or scriptblocktext like '%invoke-bettersafetykatz%' or scriptblocktext like '%invoke-bypassuac%' or scriptblocktext like '%invoke-carbuncle%' or scriptblocktext like '%invoke-certify%' or scriptblocktext like '%invoke-conptyshell%' or scriptblocktext like '%invoke-credentialinjection%' or scriptblocktext like '%invoke-daft%' or scriptblocktext like '%invoke-dcsync%' or scriptblocktext like '%invoke-dinvokekatz%' or scriptblocktext like '%invoke-dllinjection%' or scriptblocktext like '%invoke-dnsupdate%' or scriptblocktext like '%invoke-domainpasswordspray%' or scriptblocktext like '%invoke-downgradeaccount%' or scriptblocktext like '%invoke-egresscheck%' or scriptblocktext like '%invoke-eyewitness%' or scriptblocktext like '%invoke-fakelogonscreen%' or scriptblocktext like '%invoke-farmer%' or scriptblocktext like '%invoke-get-rbcd-threaded%' or scriptblocktext like '%invoke-gopher%' or scriptblocktext like '%invoke-grouper%' or scriptblocktext like '%invoke-handlekatz%' or scriptblocktext like '%invoke-impersonatedprocess%' or scriptblocktext like '%invoke-impersonatesystem%' or scriptblocktext like '%invoke-interactivesystempowershell%' or scriptblocktext like '%invoke-internalmonologue%' or scriptblocktext like '%invoke-inveigh%' or scriptblocktext like '%invoke-inveighrelay%' or scriptblocktext like '%invoke-krbrelay%' or scriptblocktext like '%invoke-ldapsigncheck%' or scriptblocktext like '%invoke-lockless%' or scriptblocktext like '%invoke-malsccm%' or scriptblocktext like '%invoke-mimikatz%' or scriptblocktext like '%invoke-mimikittenz%' or scriptblocktext like '%invoke-mitm6%' or scriptblocktext like '%invoke-nanodump%' or scriptblocktext like '%invoke-netripper%' or scriptblocktext like '%invoke-nightmare%' or scriptblocktext like '%invoke-ninjacopy%' or scriptblocktext like '%invoke-officescrape%' or scriptblocktext like '%invoke-oxidresolver%' or scriptblocktext like '%invoke-p0wnedshell%' or scriptblocktext like '%invoke-paranoia%' or scriptblocktext like '%invoke-portscan%' or scriptblocktext like '%invoke-poshrathttp%' or scriptblocktext like '%invoke-postexfil%' or scriptblocktext like '%invoke-powerdump%' or scriptblocktext like '%invoke-powershelltcp%' or scriptblocktext like '%invoke-powershellwmi%' or scriptblocktext like '%invoke-ppldump%' or scriptblocktext like '%invoke-psexec%' or scriptblocktext like '%invoke-psinject%' or scriptblocktext like '%invoke-psuacme%' or scriptblocktext like '%invoke-reflectivepeinjection%' or scriptblocktext like '%invoke-reversednslookup%' or scriptblocktext like '%invoke-rubeus%' or scriptblocktext like '%invoke-runas%' or scriptblocktext like '%invoke-safetykatz%' or scriptblocktext like '%invoke-sauroneye%' or scriptblocktext like '%invoke-scshell%' or scriptblocktext like '%invoke-seatbelt%' or scriptblocktext like '%invoke-serviceabuse%' or scriptblocktext like '%invoke-shadowspray%' or scriptblocktext like '%invoke-sharp%' or scriptblocktext like '%invoke-shellcode%' or scriptblocktext like '%invoke-smbscanner%' or scriptblocktext like '%invoke-snaffler%' or scriptblocktext like '%invoke-spoolsample%' or scriptblocktext like '%invoke-spraysinglepassword%' or scriptblocktext like '%invoke-sshcommand%' or scriptblocktext like '%invoke-standin%' or scriptblocktext like '%invoke-stickynotesextract%' or scriptblocktext like '%invoke-systemcommand%' or scriptblocktext like '%invoke-tasksbackdoor%' or scriptblocktext like '%invoke-tater%' or scriptblocktext like '%invoke-thunderfox%' or scriptblocktext like '%invoke-thunderstruck%' or scriptblocktext like '%invoke-tokenmanipulation%' or scriptblocktext like '%invoke-tokenvator%' or scriptblocktext like '%invoke-totalexec%' or scriptblocktext like '%invoke-urbanbishop%' or scriptblocktext like '%invoke-userhunter%' or scriptblocktext like '%invoke-voicetroll%' or scriptblocktext like '%invoke-whisker%' or scriptblocktext like '%invoke-winenum%' or scriptblocktext like '%invoke-winpeas%' or scriptblocktext like '%invoke-wiretap%' or scriptblocktext like '%invoke-wmicommand%' or scriptblocktext like '%invoke-wmiexec%' or scriptblocktext like '%invoke-wscriptbypassuac%' or scriptblocktext like '%invoke-zerologon%' or scriptblocktext like '%mailraider%' or scriptblocktext like '%new-adidnsnode%' or scriptblocktext like '%new-honeyhash%' or scriptblocktext like '%new-inmemorymodule%' or scriptblocktext like '%new-soaserialnumberarray%' or scriptblocktext like '%out-minidump%' or scriptblocktext like '%powerbreach%' or scriptblocktext like '%powercat %' or scriptblocktext like '%powerup%' or scriptblocktext like '%powerview%' or scriptblocktext like '%remove-adidnsnode%' or scriptblocktext like '%remove-update%' or scriptblocktext like '%rename-adidnsnode%' or scriptblocktext like '%revoke-adidnspermission%' or scriptblocktext like '%set-adidnsnode%' or scriptblocktext like '%show-targetscreen%' or scriptblocktext like '%start-captureserver%' or scriptblocktext like '%start-dnscat2%' or scriptblocktext like '%start-webcamrecorder%' or scriptblocktext like '%volumeshadowcopytools%') and  not (scriptblocktext like '%get-systemdriveinfo%' or scriptblocktext like '%c:\\programdata\\amazon\\ec2-windows\\launch\\module\\%'))",
  "Tags": [
    "attack.execution",
    "attack.discovery",
    "attack.t1482",
    "attack.t1087",
    "attack.t1087.001",
    "attack.t1087.002",
    "attack.t1069.001",
    "attack.t1069.002",
    "attack.t1069",
    "attack.t1059.001"
  ],
  "Version": "0.1"
}