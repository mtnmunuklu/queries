{
  "Description": "Detects Cmdlet names from PowerView of the PowerSploit exploitation framework.\n\nAuthor: Bhabesh Raj\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "dcd74b95-3f36-4ed9-9598-0490951643aa",
  "InsertDate": "2025-01-21T09:28:06Z",
  "LastUpdateDate": "2025-01-21T09:28:06Z",
  "Level": "high",
  "Name": "PowerView PowerShell Cmdlets - ScriptBlock",
  "Query": "sourcetype like 'windows-%' eql select * from _source_ where (scriptblocktext like '%export-powerviewcsv%' or scriptblocktext like '%find-domainlocalgroupmember%' or scriptblocktext like '%find-domainobjectpropertyoutlier%' or scriptblocktext like '%find-domainprocess%' or scriptblocktext like '%find-domainshare%' or scriptblocktext like '%find-domainuserevent%' or scriptblocktext like '%find-domainuserlocation%' or scriptblocktext like '%find-foreigngroup%' or scriptblocktext like '%find-foreignuser%' or scriptblocktext like '%find-gpocomputeradmin%' or scriptblocktext like '%find-gpolocation%' or scriptblocktext like '%find-interestingdomain%' or scriptblocktext like '%find-interestingfile%' or scriptblocktext like '%find-localadminaccess%' or scriptblocktext like '%find-managedsecuritygroups%' or scriptblocktext like '%get-cachedrdpconnection%' or scriptblocktext like '%get-dfsshare%' or scriptblocktext like '%get-domaindfsshare%' or scriptblocktext like '%get-domaindnsrecord%' or scriptblocktext like '%get-domaindnszone%' or scriptblocktext like '%get-domainfileserver%' or scriptblocktext like '%get-domaingpocomputerlocalgroupmapping%' or scriptblocktext like '%get-domaingpolocalgroup%' or scriptblocktext like '%get-domaingpouserlocalgroupmapping%' or scriptblocktext like '%get-lastloggedon%' or scriptblocktext like '%get-loggedonlocal%' or scriptblocktext like '%get-netfileserver%' or scriptblocktext like '%get-netforest%' or scriptblocktext like '%get-netgpogroup%' or scriptblocktext like '%get-netprocess%' or scriptblocktext like '%get-netrdpsession%' or scriptblocktext like '%get-registrymounteddrive%' or scriptblocktext like '%get-regloggedon%' or scriptblocktext like '%get-wmiregcachedrdpconnection%' or scriptblocktext like '%get-wmireglastloggedon%' or scriptblocktext like '%get-wmiregmounteddrive%' or scriptblocktext like '%get-wmiregproxy%' or scriptblocktext like '%invoke-aclscanner%' or scriptblocktext like '%invoke-checklocaladminaccess%' or scriptblocktext like '%invoke-enumeratelocaladmin%' or scriptblocktext like '%invoke-eventhunter%' or scriptblocktext like '%invoke-filefinder%' or scriptblocktext like '%invoke-kerberoast%' or scriptblocktext like '%invoke-mapdomaintrust%' or scriptblocktext like '%invoke-processhunter%' or scriptblocktext like '%invoke-reverttoself%' or scriptblocktext like '%invoke-sharefinder%' or scriptblocktext like '%invoke-userhunter%' or scriptblocktext like '%invoke-userimpersonation%' or scriptblocktext like '%remove-remoteconnection%' or scriptblocktext like '%request-spnticket%' or scriptblocktext like '%resolve-ipaddress%')",
  "Tags": [
    "attack.execution",
    "attack.t1059.001"
  ],
  "Version": "0.1"
}