{
  "Description": "Detects Cmdlet names from PowerView of the PowerSploit exploitation framework.\n\nAuthor: Bhabesh Raj\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "dcd74b95-3f36-4ed9-9598-0490951643aa",
  "InsertDate": "2025-01-25T21:21:27Z",
  "LastUpdateDate": "2025-01-25T21:21:27Z",
  "Level": "high",
  "Name": "PowerView PowerShell Cmdlets - ScriptBlock",
  "Query": "sourcetype like 'windows-%' eql select * from _source_ where (scriptblocktext like '%Export-PowerViewCSV%' or scriptblocktext like '%Find-DomainLocalGroupMember%' or scriptblocktext like '%Find-DomainObjectPropertyOutlier%' or scriptblocktext like '%Find-DomainProcess%' or scriptblocktext like '%Find-DomainShare%' or scriptblocktext like '%Find-DomainUserEvent%' or scriptblocktext like '%Find-DomainUserLocation%' or scriptblocktext like '%Find-ForeignGroup%' or scriptblocktext like '%Find-ForeignUser%' or scriptblocktext like '%Find-GPOComputerAdmin%' or scriptblocktext like '%Find-GPOLocation%' or scriptblocktext like '%Find-InterestingDomain%' or scriptblocktext like '%Find-InterestingFile%' or scriptblocktext like '%Find-LocalAdminAccess%' or scriptblocktext like '%Find-ManagedSecurityGroups%' or scriptblocktext like '%Get-CachedRDPConnection%' or scriptblocktext like '%Get-DFSshare%' or scriptblocktext like '%Get-DomainDFSShare%' or scriptblocktext like '%Get-DomainDNSRecord%' or scriptblocktext like '%Get-DomainDNSZone%' or scriptblocktext like '%Get-DomainFileServer%' or scriptblocktext like '%Get-DomainGPOComputerLocalGroupMapping%' or scriptblocktext like '%Get-DomainGPOLocalGroup%' or scriptblocktext like '%Get-DomainGPOUserLocalGroupMapping%' or scriptblocktext like '%Get-LastLoggedOn%' or scriptblocktext like '%Get-LoggedOnLocal%' or scriptblocktext like '%Get-NetFileServer%' or scriptblocktext like '%Get-NetForest%' or scriptblocktext like '%Get-NetGPOGroup%' or scriptblocktext like '%Get-NetProcess%' or scriptblocktext like '%Get-NetRDPSession%' or scriptblocktext like '%Get-RegistryMountedDrive%' or scriptblocktext like '%Get-RegLoggedOn%' or scriptblocktext like '%Get-WMIRegCachedRDPConnection%' or scriptblocktext like '%Get-WMIRegLastLoggedOn%' or scriptblocktext like '%Get-WMIRegMountedDrive%' or scriptblocktext like '%Get-WMIRegProxy%' or scriptblocktext like '%Invoke-ACLScanner%' or scriptblocktext like '%Invoke-CheckLocalAdminAccess%' or scriptblocktext like '%Invoke-EnumerateLocalAdmin%' or scriptblocktext like '%Invoke-EventHunter%' or scriptblocktext like '%Invoke-FileFinder%' or scriptblocktext like '%Invoke-Kerberoast%' or scriptblocktext like '%Invoke-MapDomainTrust%' or scriptblocktext like '%Invoke-ProcessHunter%' or scriptblocktext like '%Invoke-RevertToSelf%' or scriptblocktext like '%Invoke-ShareFinder%' or scriptblocktext like '%Invoke-UserHunter%' or scriptblocktext like '%Invoke-UserImpersonation%' or scriptblocktext like '%Remove-RemoteConnection%' or scriptblocktext like '%Request-SPNTicket%' or scriptblocktext like '%Resolve-IPAddress%')",
  "Tags": [
    "attack.execution",
    "attack.t1059.001"
  ],
  "Version": "0.1"
}