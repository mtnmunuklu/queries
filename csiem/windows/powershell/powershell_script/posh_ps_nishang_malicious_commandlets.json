{
  "Description": "Detects Commandlet names and arguments from the Nishang exploitation framework\n\nAuthor: Alec Costello\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "f772cee9-b7c2-4cb2-8f07-49870adc02e0",
  "InsertDate": "2025-01-25T21:21:26Z",
  "LastUpdateDate": "2025-01-25T21:21:26Z",
  "Level": "high",
  "Name": "Malicious Nishang PowerShell Commandlets",
  "Query": "sourcetype like 'windows-%' eql select * from _source_ where (scriptblocktext like '%Add-ConstrainedDelegationBackdoor%' or scriptblocktext like '%Copy-VSS%' or scriptblocktext like '%Create-MultipleSessions%' or scriptblocktext like '%DataToEncode%' or scriptblocktext like '%DNS_TXT_Pwnage%' or scriptblocktext like '%Do-Exfiltration-Dns%' or scriptblocktext like '%Download_Execute%' or scriptblocktext like '%Download-Execute-PS%' or scriptblocktext like '%DownloadAndExtractFromRemoteRegistry%' or scriptblocktext like '%DumpCerts%' or scriptblocktext like '%DumpCreds%' or scriptblocktext like '%DumpHashes%' or scriptblocktext like '%Enable-DuplicateToken%' or scriptblocktext like '%Enable-Duplication%' or scriptblocktext like '%Execute-Command-MSSQL%' or scriptblocktext like '%Execute-DNSTXT-Code%' or scriptblocktext like '%Execute-OnTime%' or scriptblocktext like '%ExetoText%' or scriptblocktext like '%exfill%' or scriptblocktext like '%ExfilOption%' or scriptblocktext like '%FakeDC%' or scriptblocktext like '%FireBuster%' or scriptblocktext like '%FireListener%' or scriptblocktext like '%Get-Information %' or scriptblocktext like '%Get-PassHints%' or scriptblocktext like '%Get-Web-Credentials%' or scriptblocktext like '%Get-WebCredentials%' or scriptblocktext like '%Get-WLAN-Keys%' or scriptblocktext like '%HTTP-Backdoor%' or scriptblocktext like '%Invoke-AmsiBypass%' or scriptblocktext like '%Invoke-BruteForce%' or scriptblocktext like '%Invoke-CredentialsPhish%' or scriptblocktext like '%Invoke-Decode%' or scriptblocktext like '%Invoke-Encode%' or scriptblocktext like '%Invoke-Interceptor%' or scriptblocktext like '%Invoke-JSRatRegsvr%' or scriptblocktext like '%Invoke-JSRatRundll%' or scriptblocktext like '%Invoke-MimikatzWDigestDowngrade%' or scriptblocktext like '%Invoke-NetworkRelay%' or scriptblocktext like '%Invoke-PowerShellIcmp%' or scriptblocktext like '%Invoke-PowerShellUdp%' or scriptblocktext like '%Invoke-Prasadhak%' or scriptblocktext like '%Invoke-PSGcat%' or scriptblocktext like '%Invoke-PsGcatAgent%' or scriptblocktext like '%Invoke-SessionGopher%' or scriptblocktext like '%Invoke-SSIDExfil%' or scriptblocktext like '%LoggedKeys%' or scriptblocktext like '%Nishang%' or scriptblocktext like '%NotAllNameSpaces%' or scriptblocktext like '%Out-CHM%' or scriptblocktext like '%OUT-DNSTXT%' or scriptblocktext like '%Out-HTA%' or scriptblocktext like '%Out-RundllCommand%' or scriptblocktext like '%Out-SCF%' or scriptblocktext like '%Out-SCT%' or scriptblocktext like '%Out-Shortcut%' or scriptblocktext like '%Out-WebQuery%' or scriptblocktext like '%Out-Word%' or scriptblocktext like '%Parse_Keys%' or scriptblocktext like '%Password-List%' or scriptblocktext like '%Powerpreter%' or scriptblocktext like '%Remove-Persistence%' or scriptblocktext like '%Remove-PoshRat%' or scriptblocktext like '%Remove-Update%' or scriptblocktext like '%Run-EXEonRemote%' or scriptblocktext like '%Set-DCShadowPermissions%' or scriptblocktext like '%Set-RemotePSRemoting%' or scriptblocktext like '%Set-RemoteWMI%' or scriptblocktext like '%Shellcode32%' or scriptblocktext like '%Shellcode64%' or scriptblocktext like '%StringtoBase64%' or scriptblocktext like '%TexttoExe%')",
  "Tags": [
    "attack.execution",
    "attack.t1059.001"
  ],
  "Version": "0.1"
}