{
  "Description": "Detects Commandlet names and arguments from the Nishang exploitation framework\n\nAuthor: Alec Costello\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "f772cee9-b7c2-4cb2-8f07-49870adc02e0",
  "InsertDate": "2025-01-21T09:28:06Z",
  "LastUpdateDate": "2025-01-21T09:28:06Z",
  "Level": "high",
  "Name": "Malicious Nishang PowerShell Commandlets",
  "Query": "sourcetype like 'windows-%' eql select * from _source_ where (scriptblocktext like '%add-constraineddelegationbackdoor%' or scriptblocktext like '%copy-vss%' or scriptblocktext like '%create-multiplesessions%' or scriptblocktext like '%datatoencode%' or scriptblocktext like '%dns_txt_pwnage%' or scriptblocktext like '%do-exfiltration-dns%' or scriptblocktext like '%download_execute%' or scriptblocktext like '%download-execute-ps%' or scriptblocktext like '%downloadandextractfromremoteregistry%' or scriptblocktext like '%dumpcerts%' or scriptblocktext like '%dumpcreds%' or scriptblocktext like '%dumphashes%' or scriptblocktext like '%enable-duplicatetoken%' or scriptblocktext like '%enable-duplication%' or scriptblocktext like '%execute-command-mssql%' or scriptblocktext like '%execute-dnstxt-code%' or scriptblocktext like '%execute-ontime%' or scriptblocktext like '%exetotext%' or scriptblocktext like '%exfill%' or scriptblocktext like '%exfiloption%' or scriptblocktext like '%fakedc%' or scriptblocktext like '%firebuster%' or scriptblocktext like '%firelistener%' or scriptblocktext like '%get-information %' or scriptblocktext like '%get-passhints%' or scriptblocktext like '%get-web-credentials%' or scriptblocktext like '%get-webcredentials%' or scriptblocktext like '%get-wlan-keys%' or scriptblocktext like '%http-backdoor%' or scriptblocktext like '%invoke-amsibypass%' or scriptblocktext like '%invoke-bruteforce%' or scriptblocktext like '%invoke-credentialsphish%' or scriptblocktext like '%invoke-decode%' or scriptblocktext like '%invoke-encode%' or scriptblocktext like '%invoke-interceptor%' or scriptblocktext like '%invoke-jsratregsvr%' or scriptblocktext like '%invoke-jsratrundll%' or scriptblocktext like '%invoke-mimikatzwdigestdowngrade%' or scriptblocktext like '%invoke-networkrelay%' or scriptblocktext like '%invoke-powershellicmp%' or scriptblocktext like '%invoke-powershelludp%' or scriptblocktext like '%invoke-prasadhak%' or scriptblocktext like '%invoke-psgcat%' or scriptblocktext like '%invoke-psgcatagent%' or scriptblocktext like '%invoke-sessiongopher%' or scriptblocktext like '%invoke-ssidexfil%' or scriptblocktext like '%loggedkeys%' or scriptblocktext like '%nishang%' or scriptblocktext like '%notallnamespaces%' or scriptblocktext like '%out-chm%' or scriptblocktext like '%out-dnstxt%' or scriptblocktext like '%out-hta%' or scriptblocktext like '%out-rundllcommand%' or scriptblocktext like '%out-scf%' or scriptblocktext like '%out-sct%' or scriptblocktext like '%out-shortcut%' or scriptblocktext like '%out-webquery%' or scriptblocktext like '%out-word%' or scriptblocktext like '%parse_keys%' or scriptblocktext like '%password-list%' or scriptblocktext like '%powerpreter%' or scriptblocktext like '%remove-persistence%' or scriptblocktext like '%remove-poshrat%' or scriptblocktext like '%remove-update%' or scriptblocktext like '%run-exeonremote%' or scriptblocktext like '%set-dcshadowpermissions%' or scriptblocktext like '%set-remotepsremoting%' or scriptblocktext like '%set-remotewmi%' or scriptblocktext like '%shellcode32%' or scriptblocktext like '%shellcode64%' or scriptblocktext like '%stringtobase64%' or scriptblocktext like '%texttoexe%')",
  "Tags": [
    "attack.execution",
    "attack.t1059.001"
  ],
  "Version": "0.1"
}