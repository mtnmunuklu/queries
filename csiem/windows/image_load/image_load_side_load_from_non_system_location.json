{
  "Description": "Detects DLL sideloading of DLLs usually located in system locations (System32, SysWOW64, etc.).\n\nAuthor: Nasreddine Bencherchali (Nextron Systems)\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "4fc0deee-0057-4998-ab31-d24e46e0aba4",
  "InsertDate": "2025-01-21T09:27:51Z",
  "LastUpdateDate": "2025-01-21T09:27:51Z",
  "Level": "high",
  "Name": "Potential System DLL Sideloading From Non System Locations",
  "Query": "sourcetype='windows-sysmon' eql select * from _source_ where ((image_loaded like '%\\aclui.dll' or image_loaded like '%\\activeds.dll' or image_loaded like '%\\adsldpc.dll' or image_loaded like '%\\aepic.dll' or image_loaded like '%\\apphelp.dll' or image_loaded like '%\\applicationframe.dll' or image_loaded like '%\\appvpolicy.dll' or image_loaded like '%\\appxalluserstore.dll' or image_loaded like '%\\appxdeploymentclient.dll' or image_loaded like '%\\archiveint.dll' or image_loaded like '%\\atl.dll' or image_loaded like '%\\audioses.dll' or image_loaded like '%\\auditpolcore.dll' or image_loaded like '%\\authfwcfg.dll' or image_loaded like '%\\authz.dll' or image_loaded like '%\\avrt.dll' or image_loaded like '%\\batmeter.dll' or image_loaded like '%\\bcd.dll' or image_loaded like '%\\bcp47langs.dll' or image_loaded like '%\\bcp47mrm.dll' or image_loaded like '%\\bcrypt.dll' or image_loaded like '%\\bderepair.dll' or image_loaded like '%\\bootmenuux.dll' or image_loaded like '%\\bootux.dll' or image_loaded like '%\\cabinet.dll' or image_loaded like '%\\cabview.dll' or image_loaded like '%\\certcli.dll' or image_loaded like '%\\certenroll.dll' or image_loaded like '%\\cfgmgr32.dll' or image_loaded like '%\\cldapi.dll' or image_loaded like '%\\clipc.dll' or image_loaded like '%\\clusapi.dll' or image_loaded like '%\\cmpbk32.dll' or image_loaded like '%\\cmutil.dll' or image_loaded like '%\\coloradapterclient.dll' or image_loaded like '%\\colorui.dll' or image_loaded like '%\\comdlg32.dll' or image_loaded like '%\\configmanager2.dll' or image_loaded like '%\\connect.dll' or image_loaded like '%\\coredplus.dll' or image_loaded like '%\\coremessaging.dll' or image_loaded like '%\\coreuicomponents.dll' or image_loaded like '%\\credui.dll' or image_loaded like '%\\cryptbase.dll' or image_loaded like '%\\cryptdll.dll' or image_loaded like '%\\cryptsp.dll' or image_loaded like '%\\cryptui.dll' or image_loaded like '%\\cryptxml.dll' or image_loaded like '%\\cscapi.dll' or image_loaded like '%\\cscobj.dll' or image_loaded like '%\\cscui.dll' or image_loaded like '%\\d2d1.dll' or image_loaded like '%\\d3d10_1.dll' or image_loaded like '%\\d3d10_1core.dll' or image_loaded like '%\\d3d10.dll' or image_loaded like '%\\d3d10core.dll' or image_loaded like '%\\d3d10warp.dll' or image_loaded like '%\\d3d11.dll' or image_loaded like '%\\d3d12.dll' or image_loaded like '%\\d3d9.dll' or image_loaded like '%\\d3dx9_43.dll' or image_loaded like '%\\dataexchange.dll' or image_loaded like '%\\davclnt.dll' or image_loaded like '%\\dcntel.dll' or image_loaded like '%\\dcomp.dll' or image_loaded like '%\\defragproxy.dll' or image_loaded like '%\\desktopshellext.dll' or image_loaded like '%\\deviceassociation.dll' or image_loaded like '%\\devicecredential.dll' or image_loaded like '%\\devicepairing.dll' or image_loaded like '%\\devobj.dll' or image_loaded like '%\\devrtl.dll' or image_loaded like '%\\dhcpcmonitor.dll' or image_loaded like '%\\dhcpcsvc.dll' or image_loaded like '%\\dhcpcsvc6.dll' or image_loaded like '%\\directmanipulation.dll' or image_loaded like '%\\dismapi.dll' or image_loaded like '%\\dismcore.dll' or image_loaded like '%\\dmcfgutils.dll' or image_loaded like '%\\dmcmnutils.dll' or image_loaded like '%\\dmcommandlineutils.dll' or image_loaded like '%\\dmenrollengine.dll' or image_loaded like '%\\dmenterprisediagnostics.dll' or image_loaded like '%\\dmiso8601utils.dll' or image_loaded like '%\\dmoleaututils.dll' or image_loaded like '%\\dmprocessxmlfiltered.dll' or image_loaded like '%\\dmpushproxy.dll' or image_loaded like '%\\dmxmlhelputils.dll' or image_loaded like '%\\dnsapi.dll' or image_loaded like '%\\dot3api.dll' or image_loaded like '%\\dot3cfg.dll' or image_loaded like '%\\dpx.dll' or image_loaded like '%\\drprov.dll' or image_loaded like '%\\drvstore.dll' or image_loaded like '%\\dsclient.dll' or image_loaded like '%\\dsparse.dll' or image_loaded like '%\\dsprop.dll' or image_loaded like '%\\dsreg.dll' or image_loaded like '%\\dsrole.dll' or image_loaded like '%\\dui70.dll' or image_loaded like '%\\duser.dll' or image_loaded like '%\\dusmapi.dll' or image_loaded like '%\\dwmapi.dll' or image_loaded like '%\\dwmcore.dll' or image_loaded like '%\\dwrite.dll' or image_loaded like '%\\dxcore.dll' or image_loaded like '%\\dxgi.dll' or image_loaded like '%\\dxva2.dll' or image_loaded like '%\\dynamoapi.dll' or image_loaded like '%\\eappcfg.dll' or image_loaded like '%\\eappprxy.dll' or image_loaded like '%\\edgeiso.dll' or image_loaded like '%\\edputil.dll' or image_loaded like '%\\efsadu.dll' or image_loaded like '%\\efsutil.dll' or image_loaded like '%\\esent.dll' or image_loaded like '%\\execmodelproxy.dll' or image_loaded like '%\\explorerframe.dll' or image_loaded like '%\\fastprox.dll' or image_loaded like '%\\faultrep.dll' or image_loaded like '%\\fddevquery.dll' or image_loaded like '%\\feclient.dll' or image_loaded like '%\\fhcfg.dll' or image_loaded like '%\\fhsvcctl.dll' or image_loaded like '%\\firewallapi.dll' or image_loaded like '%\\flightsettings.dll' or image_loaded like '%\\fltlib.dll' or image_loaded like '%\\framedynos.dll' or image_loaded like '%\\fveapi.dll' or image_loaded like '%\\fveskybackup.dll' or image_loaded like '%\\fvewiz.dll' or image_loaded like '%\\fwbase.dll' or image_loaded like '%\\fwcfg.dll' or image_loaded like '%\\fwpolicyiomgr.dll' or image_loaded like '%\\fwpuclnt.dll' or image_loaded like '%\\fxsapi.dll' or image_loaded like '%\\fxsst.dll' or image_loaded like '%\\fxstiff.dll' or image_loaded like '%\\getuname.dll' or image_loaded like '%\\gpapi.dll' or image_loaded like '%\\hid.dll' or image_loaded like '%\\hnetmon.dll' or image_loaded like '%\\httpapi.dll' or image_loaded like '%\\icmp.dll' or image_loaded like '%\\idstore.dll' or image_loaded like '%\\ieadvpack.dll' or image_loaded like '%\\iedkcs32.dll' or image_loaded like '%\\iernonce.dll' or image_loaded like '%\\iertutil.dll' or image_loaded like '%\\ifmon.dll' or image_loaded like '%\\ifsutil.dll' or image_loaded like '%\\inproclogger.dll' or image_loaded like '%\\iphlpapi.dll' or image_loaded like '%\\iri.dll' or image_loaded like '%\\iscsidsc.dll' or image_loaded like '%\\iscsium.dll' or image_loaded like '%\\isv.exe_rsaenh.dll' or image_loaded like '%\\iumbase.dll' or image_loaded like '%\\iumsdk.dll' or image_loaded like '%\\joinutil.dll' or image_loaded like '%\\kdstub.dll' or image_loaded like '%\\ksuser.dll' or image_loaded like '%\\ktmw32.dll' or image_loaded like '%\\licensemanagerapi.dll' or image_loaded like '%\\licensingdiagspp.dll' or image_loaded like '%\\linkinfo.dll' or image_loaded like '%\\loadperf.dll' or image_loaded like '%\\lockhostingframework.dll' or image_loaded like '%\\logoncli.dll' or image_loaded like '%\\logoncontroller.dll' or image_loaded like '%\\lpksetupproxyserv.dll' or image_loaded like '%\\lrwizdll.dll' or image_loaded like '%\\magnification.dll' or image_loaded like '%\\maintenanceui.dll' or image_loaded like '%\\mapistub.dll' or image_loaded like '%\\mbaexmlparser.dll' or image_loaded like '%\\mdmdiagnostics.dll' or image_loaded like '%\\mfc42u.dll' or image_loaded like '%\\mfcore.dll' or image_loaded like '%\\mfplat.dll' or image_loaded like '%\\mi.dll' or image_loaded like '%\\midimap.dll' or image_loaded like '%\\mintdh.dll' or image_loaded like '%\\miutils.dll' or image_loaded like '%\\mlang.dll' or image_loaded like '%\\mmdevapi.dll' or image_loaded like '%\\mobilenetworking.dll' or image_loaded like '%\\mpr.dll' or image_loaded like '%\\mprapi.dll' or image_loaded like '%\\mrmcorer.dll' or image_loaded like '%\\msacm32.dll' or image_loaded like '%\\mscms.dll' or image_loaded like '%\\mscoree.dll' or image_loaded like '%\\msctf.dll' or image_loaded like '%\\msctfmonitor.dll' or image_loaded like '%\\msdrm.dll' or image_loaded like '%\\msdtctm.dll' or image_loaded like '%\\msftedit.dll' or image_loaded like '%\\msi.dll' or image_loaded like '%\\msiso.dll' or image_loaded like '%\\msutb.dll' or image_loaded like '%\\msvcp110_win.dll' or image_loaded like '%\\mswb7.dll' or image_loaded like '%\\mswsock.dll' or image_loaded like '%\\msxml3.dll' or image_loaded like '%\\mtxclu.dll' or image_loaded like '%\\napinsp.dll' or image_loaded like '%\\ncrypt.dll' or image_loaded like '%\\ndfapi.dll' or image_loaded like '%\\netapi32.dll' or image_loaded like '%\\netid.dll' or image_loaded like '%\\netiohlp.dll' or image_loaded like '%\\netjoin.dll' or image_loaded like '%\\netplwiz.dll' or image_loaded like '%\\netprofm.dll' or image_loaded like '%\\netprovfw.dll' or image_loaded like '%\\netsetupapi.dll' or image_loaded like '%\\netshell.dll' or image_loaded like '%\\nettrace.dll' or image_loaded like '%\\netutils.dll' or image_loaded like '%\\networkexplorer.dll' or image_loaded like '%\\newdev.dll' or image_loaded like '%\\ninput.dll' or image_loaded like '%\\nlaapi.dll' or image_loaded like '%\\nlansp_c.dll' or image_loaded like '%\\npmproxy.dll' or image_loaded like '%\\nshhttp.dll' or image_loaded like '%\\nshipsec.dll' or image_loaded like '%\\nshwfp.dll' or image_loaded like '%\\ntdsapi.dll' or image_loaded like '%\\ntlanman.dll' or image_loaded like '%\\ntlmshared.dll' or image_loaded like '%\\ntmarta.dll' or image_loaded like '%\\ntshrui.dll' or image_loaded like '%\\oleacc.dll' or image_loaded like '%\\omadmapi.dll' or image_loaded like '%\\onex.dll' or image_loaded like '%\\opcservices.dll' or image_loaded like '%\\osbaseln.dll' or image_loaded like '%\\osksupport.dll' or image_loaded like '%\\osuninst.dll' or image_loaded like '%\\p2p.dll' or image_loaded like '%\\p2pnetsh.dll' or image_loaded like '%\\p9np.dll' or image_loaded like '%\\pcaui.dll' or image_loaded like '%\\pdh.dll' or image_loaded like '%\\peerdistsh.dll' or image_loaded like '%\\pkeyhelper.dll' or image_loaded like '%\\pla.dll' or image_loaded like '%\\playsndsrv.dll' or image_loaded like '%\\pnrpnsp.dll' or image_loaded like '%\\policymanager.dll' or image_loaded like '%\\polstore.dll' or image_loaded like '%\\powrprof.dll' or image_loaded like '%\\printui.dll' or image_loaded like '%\\prntvpt.dll' or image_loaded like '%\\profapi.dll' or image_loaded like '%\\propsys.dll' or image_loaded like '%\\proximitycommon.dll' or image_loaded like '%\\proximityservicepal.dll' or image_loaded like '%\\prvdmofcomp.dll' or image_loaded like '%\\puiapi.dll' or image_loaded like '%\\radcui.dll' or image_loaded like '%\\rasapi32.dll' or image_loaded like '%\\rasdlg.dll' or image_loaded like '%\\rasgcw.dll' or image_loaded like '%\\rasman.dll' or image_loaded like '%\\rasmontr.dll' or image_loaded like '%\\reagent.dll' or image_loaded like '%\\regapi.dll' or image_loaded like '%\\reseteng.dll' or image_loaded like '%\\resetengine.dll' or image_loaded like '%\\resutils.dll' or image_loaded like '%\\rmclient.dll' or image_loaded like '%\\rpcnsh.dll' or image_loaded like '%\\rsaenh.dll' or image_loaded like '%\\rtutils.dll' or image_loaded like '%\\rtworkq.dll' or image_loaded like '%\\samcli.dll' or image_loaded like '%\\samlib.dll' or image_loaded like '%\\sapi_onecore.dll' or image_loaded like '%\\sas.dll' or image_loaded like '%\\scansetting.dll' or image_loaded like '%\\scecli.dll' or image_loaded like '%\\schedcli.dll' or image_loaded like '%\\secur32.dll' or image_loaded like '%\\security.dll' or image_loaded like '%\\sensapi.dll' or image_loaded like '%\\shell32.dll' or image_loaded like '%\\shfolder.dll' or image_loaded like '%\\slc.dll' or image_loaded like '%\\snmpapi.dll' or image_loaded like '%\\spectrumsyncclient.dll' or image_loaded like '%\\spp.dll' or image_loaded like '%\\sppc.dll' or image_loaded like '%\\sppcext.dll' or image_loaded like '%\\srclient.dll' or image_loaded like '%\\srcore.dll' or image_loaded like '%\\srmtrace.dll' or image_loaded like '%\\srpapi.dll' or image_loaded like '%\\srvcli.dll' or image_loaded like '%\\ssp_isv.exe_rsaenh.dll' or image_loaded like '%\\ssp.exe_rsaenh.dll' or image_loaded like '%\\sspicli.dll' or image_loaded like '%\\ssshim.dll' or image_loaded like '%\\staterepository.core.dll' or image_loaded like '%\\structuredquery.dll' or image_loaded like '%\\sxshared.dll' or image_loaded like '%\\systemsettingsthresholdadminflowui.dll' or image_loaded like '%\\tapi32.dll' or image_loaded like '%\\tbs.dll' or image_loaded like '%\\tdh.dll' or image_loaded like '%\\textshaping.dll' or image_loaded like '%\\timesync.dll' or image_loaded like '%\\tpmcoreprovisioning.dll' or image_loaded like '%\\tquery.dll' or image_loaded like '%\\tsworkspace.dll' or image_loaded like '%\\ttdrecord.dll' or image_loaded like '%\\twext.dll' or image_loaded like '%\\twinapi.dll' or image_loaded like '%\\twinui.appcore.dll' or image_loaded like '%\\uianimation.dll' or image_loaded like '%\\uiautomationcore.dll' or image_loaded like '%\\uireng.dll' or image_loaded like '%\\uiribbon.dll' or image_loaded like '%\\umpdc.dll' or image_loaded like '%\\unattend.dll' or image_loaded like '%\\updatepolicy.dll' or image_loaded like '%\\upshared.dll' or image_loaded like '%\\urlmon.dll' or image_loaded like '%\\userenv.dll' or image_loaded like '%\\utildll.dll' or image_loaded like '%\\uxinit.dll' or image_loaded like '%\\uxtheme.dll' or image_loaded like '%\\vaultcli.dll' or image_loaded like '%\\vdsutil.dll' or image_loaded like '%\\version.dll' or image_loaded like '%\\virtdisk.dll' or image_loaded like '%\\vssapi.dll' or image_loaded like '%\\vsstrace.dll' or image_loaded like '%\\wbemprox.dll' or image_loaded like '%\\wbemsvc.dll' or image_loaded like '%\\wcmapi.dll' or image_loaded like '%\\wcnnetsh.dll' or image_loaded like '%\\wdi.dll' or image_loaded like '%\\wdscore.dll' or image_loaded like '%\\webservices.dll' or image_loaded like '%\\wecapi.dll' or image_loaded like '%\\wer.dll' or image_loaded like '%\\wevtapi.dll' or image_loaded like '%\\whhelper.dll' or image_loaded like '%\\wimgapi.dll' or image_loaded like '%\\winbio.dll' or image_loaded like '%\\winbrand.dll' or image_loaded like '%\\windows.storage.dll' or image_loaded like '%\\windows.storage.search.dll' or image_loaded like '%\\windows.ui.immersive.dll' or image_loaded like '%\\windowscodecs.dll' or image_loaded like '%\\windowscodecsext.dll' or image_loaded like '%\\windowsudk.shellcommon.dll' or image_loaded like '%\\winhttp.dll' or image_loaded like '%\\wininet.dll' or image_loaded like '%\\winipsec.dll' or image_loaded like '%\\winmde.dll' or image_loaded like '%\\winmm.dll' or image_loaded like '%\\winnsi.dll' or image_loaded like '%\\winrnr.dll' or image_loaded like '%\\winscard.dll' or image_loaded like '%\\winsqlite3.dll' or image_loaded like '%\\winsta.dll' or image_loaded like '%\\winsync.dll' or image_loaded like '%\\wkscli.dll' or image_loaded like '%\\wlanapi.dll' or image_loaded like '%\\wlancfg.dll' or image_loaded like '%\\wldp.dll' or image_loaded like '%\\wlidprov.dll' or image_loaded like '%\\wmiclnt.dll' or image_loaded like '%\\wmidcom.dll' or image_loaded like '%\\wmiutils.dll' or image_loaded like '%\\wmpdui.dll' or image_loaded like '%\\wmsgapi.dll' or image_loaded like '%\\wofutil.dll' or image_loaded like '%\\wpdshext.dll' or image_loaded like '%\\wscapi.dll' or image_loaded like '%\\wsdapi.dll' or image_loaded like '%\\wshbth.dll' or image_loaded like '%\\wshelper.dll' or image_loaded like '%\\wsmsvc.dll' or image_loaded like '%\\wtsapi32.dll' or image_loaded like '%\\wwancfg.dll' or image_loaded like '%\\wwapi.dll' or image_loaded like '%\\xmllite.dll' or image_loaded like '%\\xolehlp.dll' or image_loaded like '%\\xpsservices.dll' or image_loaded like '%\\xwizards.dll' or image_loaded like '%\\xwtpw32.dll' or image_loaded like '%\\amsi.dll' or image_loaded like '%\\appraiser.dll' or image_loaded like '%\\comres.dll' or image_loaded like '%\\cryptnet.dll' or image_loaded like '%\\dispbroker.dll' or image_loaded like '%\\dsound.dll' or image_loaded like '%\\dxilconv.dll' or image_loaded like '%\\fxscompose.dll' or image_loaded like '%\\fxsresm.dll' or image_loaded like '%\\msdtcvsp1res.dll' or image_loaded like '%\\printisolationproxy.dll' or image_loaded like '%\\rdpendp.dll' or image_loaded like '%\\rpchttp.dll' or image_loaded like '%\\storageusage.dll' or image_loaded like '%\\utcutil.dll' or image_loaded like '%\\wfsr.dll' or image_loaded like '%\\igd10iumd64.dll' or image_loaded like '%\\igd12umd64.dll' or image_loaded like '%\\igdumdim64.dll' or image_loaded like '%\\igdusc64.dll' or image_loaded like '%\\tsmsisrv.dll' or image_loaded like '%\\tsvipsrv.dll' or image_loaded like '%\\wbemcomn.dll' or image_loaded like '%\\wlbsctrl.dll' or image_loaded like '%\\wow64log.dll' or image_loaded like '%\\wptsextensions.dll') and  not ((image_loaded like 'c:\\windows\\microsoft.net\\%' and image_loaded like '%\\cscui.dll') or (image_loaded like 'c:\\programdata\\microsoft\\windows defender\\platform\\%' and image_loaded like '%\\version.dll') or (image_loaded like '%c:\\$windows.~bt\\%' or image_loaded like '%c:\\$winreagent\\%' or image_loaded like '%c:\\windows\\softwaredistribution\\%' or image_loaded like '%c:\\windows\\system32\\%' or image_loaded like '%c:\\windows\\systemtemp\\%' or image_loaded like '%c:\\windows\\syswow64\\%' or image_loaded like '%c:\\windows\\winsxs\\%') or (image_loaded like 'c:\\program files\\windowsapps\\microsoft.directxruntime_%' and image_loaded like '%\\d3dx9_43.dll')) and  not ((image_loaded like 'c:\\program files\\arsenal-image-mounter-%' and (image_loaded like '%\\mi.dll' or image_loaded like '%\\miutils.dl')) or image_loaded like 'c:\\packages\\plugins\\microsoft.guestconfiguration.configurationforwindows\\%' or ((process_path like '%c:\\program files\\windowsapps\\dellinc.dellsupportassistforpcs%' or process_path like '%c:\\windows\\system32\\backgroundtaskhost.exe%') and image_loaded like 'c:\\program files\\windowsapps\\dellinc.dellsupportassistforpcs%') or (image_loaded like 'c:\\program files\\microsoft\\exchange server\\%' and image_loaded like '%\\mswb7.dll') or (process_path = 'c:\\program files\\common files\\microsoft shared\\clicktorun\\officeclicktorun.exe' and image_loaded = 'c:\\program files\\common files\\microsoft shared\\clicktorun\\appvpolicy.dll') or (process_path like 'c:\\program files\\windowsapps\\dellinc.dellsupportassistforpcs%' and process_path like '%\\wldp.dll') or ((process_path like 'c:\\program files\\checkpoint\\%' or process_path like 'c:\\program files (x86)\\checkpoint\\%') and process_path like '%\\smartconsole.exe' and (image_loaded like 'c:\\program files\\checkpoint\\%' or image_loaded like 'c:\\program files (x86)\\checkpoint\\%') and image_loaded like '%\\policymanager.dll')))",
  "Tags": [
    "attack.defense-evasion",
    "attack.persistence",
    "attack.privilege-escalation",
    "attack.t1574.001",
    "attack.t1574.002"
  ],
  "Version": "0.1"
}