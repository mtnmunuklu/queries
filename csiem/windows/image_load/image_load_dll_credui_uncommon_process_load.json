{
  "Description": "Detects loading of \"credui.dll\" and related DLLs by an uncommon process. Attackers might leverage this DLL for potential use of \"CredUIPromptForCredentials\" or \"CredUnPackAuthenticationBufferW\".\n\nAuthor: Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "9ae01559-cf7e-4f8e-8e14-4c290a1b4784",
  "InsertDate": "2025-01-21T09:27:49Z",
  "LastUpdateDate": "2025-01-21T09:27:49Z",
  "Level": "medium",
  "Name": "CredUI.DLL Loaded By Uncommon Process",
  "Query": "sourcetype='windows-sysmon' eql select * from _source_ where (((image_loaded like '%\\credui.dll' or image_loaded like '%\\wincredui.dll') and (original_file_name = 'credui.dll' or original_file_name = 'wincredui.dll')) and  not ((process_path like 'c:\\program files (x86)\\%' or process_path like 'c:\\program files\\%' or process_path like 'c:\\windows\\system32\\%' or process_path like 'c:\\windows\\syswow64\\%') or (process_path = 'c:\\windows\\explorer.exe' or process_path = 'c:\\windows\\immersivecontrolpanel\\systemsettings.exe' or process_path = 'c:\\windows\\regedit.exe')) and  not (process_path like '%\\opera_autoupdate.exe' or (process_path like '%\\procexp64.exe' or process_path like '%\\procexp.exe') or (process_path like 'c:\\users\\%' and process_path like '%\\appdata\\local\\microsoft\\teams\\%' and process_path like '%\\teams.exe') or (process_path like 'c:\\users\\%' and process_path like '%\\appdata\\local\\microsoft\\onedrive\\%')))",
  "Tags": [
    "attack.credential-access",
    "attack.collection",
    "attack.t1056.002"
  ],
  "Version": "0.1"
}