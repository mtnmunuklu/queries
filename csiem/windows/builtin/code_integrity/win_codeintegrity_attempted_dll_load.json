{
  "Description": "Detects attempted file load events that did not meet the signing level requirements. It often means the file's signature is revoked or a signature with the Lifetime Signing EKU has expired.\nThis event is best correlated with EID 3089 to determine the error of the validation.\n\n\nAuthor: Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "f8931561-97f5-4c46-907f-0a4a592e47a7",
  "InsertDate": "2025-01-25T21:20:05Z",
  "LastUpdateDate": "2025-01-25T21:20:05Z",
  "Level": "low",
  "Name": "CodeIntegrity - Unmet Signing Level Requirements By File Under Validation",
  "Query": "sourcetype='windows-codeintegrity-operational' eql select * from _source_ where ((eventid = '3033' or eventid = '3034') and  not (filenamebuffer like '%\\Windows\\assembly\\GAC\\%' and processnamebuffer like '%\\mscorsvw.exe' and processnamebuffer like '%\\Windows\\Microsoft.NET\\%' and requestedpolicy = '8') and  not ((filenamebuffer like '%\\Windows\\System32\\nvspcap64.dll' and processnamebuffer like '%\\AppData\\Local\\slack\\app-%' and processnamebuffer like '%\\slack.exe' and requestedpolicy = '8') or ((filenamebuffer like '%\\Mozilla Firefox\\mozavcodec.dll' or filenamebuffer like '%\\Mozilla Firefox\\mozavutil.dll') and processnamebuffer like '%\\Mozilla Firefox\\firefox.exe' and requestedpolicy = '8') or (filenamebuffer like '%\\Trend Micro\\Client Server Security Agent\\perficrcperfmonmgr.dll' and requestedpolicy = '8') or (filenamebuffer like '%\\Program Files\\SentinelOne\\Sentinel Agent%' and processnamebuffer like '%\\Program Files\\SentinelOne\\Sentinel Agent%') or (filenamebuffer like '%\\Windows\\System32\\nvspcap64.dll' and (processnamebuffer like '%\\AppData\\Local\\Keybase\\Gui\\Keybase.exe' or processnamebuffer like '%\\Microsoft\\Teams\\stage\\Teams.exe') and requestedpolicy = '8') or (filenamebuffer like '%\\Program Files\\Bonjour\\mdnsNSP.dll' and (processnamebuffer like '%\\Windows\\System32\\svchost.exe' or processnamebuffer like '%\\Windows\\System32\\SIHClient.exe') and (requestedpolicy = '8' or requestedpolicy = '12')) or (filenamebuffer like '%\\Program Files\\Google\\Drive File Stream\\%' and filenamebuffer like '%\\crashpad_handler.exe' and processnamebuffer like '%\\Windows\\ImmersiveControlPanel\\SystemSettings.exe' and requestedpolicy = '8') or (filenamebuffer like '%\\Program Files\\McAfee\\Endpoint Security\\Threat Prevention\\MfeAmsiProvider.dll' or filenamebuffer like '%\\Program Files\\McAfee\\MfeAV\\AMSIExt.dll') or filenamebuffer like '%\\Program Files\\ESET\\ESET Security\\eamsi.dll' or filenamebuffer like '%\\Program Files\\comodo\\comodo internet security\\amsiprovider_x64.dll' or filenamebuffer like '%\\National Instruments\\Shared\\mDNS Responder\\%' or (filenamebuffer like '%\\Microsoft Office\\root\\vfs\\ProgramFilesCommonX64\\Microsoft Shared\\OFFICE%' and filenamebuffer like '%\\MSOXMLMF.DLL' and requestedpolicy = '7') or ((filenamebuffer like '%\\Program Files\\Avast Software\\Avast\\aswAMSI.dll' or filenamebuffer like '%\\Program Files (x86)\\Avast Software\\Avast\\aswAMSI.dll') and (requestedpolicy = '8' or requestedpolicy = '12')) or (filenamebuffer like '%\\Windows\\System32\\DriverStore\\FileRepository\\%' and filenamebuffer like '%\\igd10iumd64.dll' and requestedpolicy = '7') or (filenamebuffer like '%\\Program Files\\DTrace\\dtrace.dll' and processnamebuffer like '%\\Windows\\System32\\svchost.exe' and requestedpolicy = '12') or filenamebuffer like '%\\Program Files\\National Instruments\\Shared\\mDNS Responder\\nimdnsNSP.dll ' or ((processnamebuffer like '%\\Kaspersky Lab\\%' and processnamebuffer like '%\\avp.exe%') and (filenamebuffer like '%\\Kaspersky Lab\\%' and filenamebuffer like '%\\antimalware_provider.dll%'))))",
  "Tags": [
    "attack.execution"
  ],
  "Version": "0.1"
}