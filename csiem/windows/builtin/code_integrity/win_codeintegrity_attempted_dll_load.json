{
  "Description": "Detects attempted file load events that did not meet the signing level requirements. It often means the file's signature is revoked or a signature with the Lifetime Signing EKU has expired.\nThis event is best correlated with EID 3089 to determine the error of the validation.\n\n\nAuthor: Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "f8931561-97f5-4c46-907f-0a4a592e47a7",
  "InsertDate": "2025-01-19T11:33:44Z",
  "LastUpdateDate": "2025-01-19T11:33:44Z",
  "Level": "low",
  "Name": "CodeIntegrity - Unmet Signing Level Requirements By File Under Validation",
  "Query": "sourcetype='windows-codeintegrity-operational' eql select * from _source_ where ((eventid = '3033' or eventid = '3034') and  not (filenamebuffer like '%\\windows\\assembly\\gac\\%' and processnamebuffer like '%\\mscorsvw.exe' and processnamebuffer like '%\\windows\\microsoft.net\\%' and requestedpolicy = '8') and  not ((filenamebuffer like '%\\windows\\system32\\driverstore\\filerepository\\%' and filenamebuffer like '%\\igd10iumd64.dll' and requestedpolicy = '7') or (filenamebuffer like '%\\microsoft office\\root\\vfs\\programfilescommonx64\\microsoft shared\\office%' and filenamebuffer like '%\\msoxmlmf.dll' and requestedpolicy = '7') or filenamebuffer like '%\\program files\\national instruments\\shared\\mdns responder\\nimdnsnsp.dll ' or (filenamebuffer like '%\\program files\\mcafee\\endpoint security\\threat prevention\\mfeamsiprovider.dll' or filenamebuffer like '%\\program files\\mcafee\\mfeav\\amsiext.dll') or filenamebuffer like '%\\program files\\comodo\\comodo internet security\\amsiprovider_x64.dll' or (filenamebuffer like '%\\program files\\dtrace\\dtrace.dll' and processnamebuffer like '%\\windows\\system32\\svchost.exe' and requestedpolicy = '12') or (filenamebuffer like '%\\windows\\system32\\nvspcap64.dll' and (processnamebuffer like '%\\appdata\\local\\keybase\\gui\\keybase.exe' or processnamebuffer like '%\\microsoft\\teams\\stage\\teams.exe') and requestedpolicy = '8') or (filenamebuffer like '%\\program files\\bonjour\\mdnsnsp.dll' and (processnamebuffer like '%\\windows\\system32\\svchost.exe' or processnamebuffer like '%\\windows\\system32\\sihclient.exe') and (requestedpolicy = '8' or requestedpolicy = '12')) or (filenamebuffer like '%\\windows\\system32\\nvspcap64.dll' and processnamebuffer like '%\\appdata\\local\\slack\\app-%' and processnamebuffer like '%\\slack.exe' and requestedpolicy = '8') or (filenamebuffer like '%\\program files\\sentinelone\\sentinel agent%' and processnamebuffer like '%\\program files\\sentinelone\\sentinel agent%') or ((filenamebuffer like '%\\mozilla firefox\\mozavcodec.dll' or filenamebuffer like '%\\mozilla firefox\\mozavutil.dll') and processnamebuffer like '%\\mozilla firefox\\firefox.exe' and requestedpolicy = '8') or filenamebuffer like '%\\program files\\eset\\eset security\\eamsi.dll' or ((filenamebuffer like '%\\program files\\avast software\\avast\\aswamsi.dll' or filenamebuffer like '%\\program files (x86)\\avast software\\avast\\aswamsi.dll') and (requestedpolicy = '8' or requestedpolicy = '12')) or (filenamebuffer like '%\\program files\\google\\drive file stream\\%' and filenamebuffer like '%\\crashpad_handler.exe' and processnamebuffer like '%\\windows\\immersivecontrolpanel\\systemsettings.exe' and requestedpolicy = '8') or (filenamebuffer like '%\\trend micro\\client server security agent\\perficrcperfmonmgr.dll' and requestedpolicy = '8') or filenamebuffer like '%\\national instruments\\shared\\mdns responder\\%' or ((processnamebuffer like '%\\kaspersky lab\\%' and processnamebuffer like '%\\avp.exe%') and (filenamebuffer like '%\\kaspersky lab\\%' and filenamebuffer like '%\\antimalware_provider.dll%'))))",
  "Tags": [
    "attack.execution"
  ],
  "Version": "0.1"
}