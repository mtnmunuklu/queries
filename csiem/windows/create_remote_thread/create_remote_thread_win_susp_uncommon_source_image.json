{
  "Description": "Detects uncommon processes creating remote threads.\n\nAuthor: Perez Diego (@darkquassar), oscd.community\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "66d31e5f-52d6-40a4-9615-002d3789a119",
  "InsertDate": "2025-01-21T09:27:39Z",
  "LastUpdateDate": "2025-01-21T09:27:39Z",
  "Level": "medium",
  "Name": "Remote Thread Creation By Uncommon Source Image",
  "Query": "sourcetype like 'windows-%' eql select * from _source_ where ((process_path like '%\\explorer.exe' or process_path like '%\\iexplore.exe' or process_path like '%\\msiexec.exe' or process_path like '%\\powerpnt.exe' or process_path like '%\\schtasks.exe' or process_path like '%\\winlogon.exe') and  not (dst_process_path = '' or ((process_path = 'c:\\windows\\system32\\schtasks.exe' or process_path = 'c:\\windows\\syswow64\\schtasks.exe') and dst_process_path = 'c:\\windows\\system32\\conhost.exe') or dst_process_path = 'system' or dst_process_path = 'null' or (process_path = 'c:\\windows\\system32\\winlogon.exe' and (dst_process_path = 'c:\\windows\\system32\\services.exe' or dst_process_path = 'c:\\windows\\system32\\wininit.exe' or dst_process_path = 'c:\\windows\\system32\\csrss.exe' or dst_process_path = 'c:\\windows\\system32\\logonui.exe')) or (process_path = 'c:\\windows\\system32\\winlogon.exe' and targetparentprocessid = '4') or (process_path = 'c:\\windows\\explorer.exe' and (dst_process_path like 'c:\\program files (x86)\\%' or dst_process_path like 'c:\\program files\\%' or dst_process_path like 'c:\\windows\\system32\\%' or dst_process_path like 'c:\\windows\\syswow64\\%')) or (process_path like '%\\msiexec.exe' and (dst_process_path like '%\\appdata\\local\\%' or dst_process_path like '%c:\\program files (x86)\\%' or dst_process_path like '%c:\\program files\\%'))) and  not ((process_path = 'c:\\program files\\internet explorer\\iexplore.exe' and (sourcecommandline like '%https://%' and sourcecommandline like '%.checkpoint.com/documents/%' and sourcecommandline like '%smartconsole_olh/%' and sourcecommandline like '%default.htm#cshid=%')) or (process_path = 'c:\\program files\\internet explorer\\iexplore.exe' and (sourceparentimage like 'c:\\program files\\%' or sourceparentimage like 'c:\\program files (x86)\\%') and (sourceparentimage like '%\\checkpoint\\smartconsole\\%' and sourceparentimage like '%\\smartconsole.exe%')) or (process_path like '%\\microsoft office\\%' and process_path like '%\\powerpnt.exe' and dst_process_path = 'c:\\windows\\system32\\csrss.exe')))",
  "Tags": [
    "attack.privilege-escalation",
    "attack.defense-evasion",
    "attack.t1055"
  ],
  "Version": "0.1"
}