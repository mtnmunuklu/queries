{
  "Description": "Detects suspicious execution of rundll32, with specific calls to some DLLs with known LOLBIN functionalities\n\nAuthor: juju4, Jonhnathan Ribeiro, oscd.community, Nasreddine Bencherchali (Nextron Systems)\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "e593cf51-88db-4ee1-b920-37e89012a3c9",
  "InsertDate": "2025-01-25T21:22:21Z",
  "LastUpdateDate": "2025-01-25T21:22:21Z",
  "Level": "medium",
  "Name": "Potentially Suspicious Rundll32 Activity",
  "Query": "sourcetype='windows-sysmon' eql select * from _source_ where (((command like '%javascript:%' and command like '%.RegisterXLL%') and (command like '%url.dll%' and command like '%OpenURL%') and (command like '%url.dll%' and command like '%OpenURLA%') and (command like '%url.dll%' and command like '%FileProtocolHandler%') and (command like '%zipfldr.dll%' and command like '%RouteTheCall%') and (command like '%shell32.dll%' and command like '%Control_RunDLL%') and (command like '%shell32.dll%' and command like '%ShellExec_RunDLL%') and (command like '%mshtml.dll%' and command like '%PrintHTML%') and (command like '%advpack.dll%' and command like '%LaunchINFSection%') and (command like '%advpack.dll%' and command like '%RegisterOCX%') and (command like '%ieadvpack.dll%' and command like '%LaunchINFSection%') and (command like '%ieadvpack.dll%' and command like '%RegisterOCX%') and (command like '%ieframe.dll%' and command like '%OpenURL%') and (command like '%shdocvw.dll%' and command like '%OpenURL%') and (command like '%syssetup.dll%' and command like '%SetupInfObjectInstallAction%') and (command like '%setupapi.dll%' and command like '%InstallHinfSection%') and (command like '%pcwutl.dll%' and command like '%LaunchApplication%') and (command like '%dfshim.dll%' and command like '%ShOpenVerbApplication%') and (command like '%dfshim.dll%' and command like '%ShOpenVerbShortcut%') and (command like '%scrobj.dll%' and command like '%GenerateTypeLib%' and command like '%http%') and (command like '%shimgvw.dll%' and command like '%ImageView_Fullscreen%' and command like '%http%') and (command like '%comsvcs.dll%' and command like '%MiniDump%')) and  not (command like '%shell32.dll,Control_RunDLL desk.cpl,screensaver,@screensaver%' or (parent_process_path = 'C:\\Windows\\System32\\control.exe' and parent_command_line like '%.cpl%' and (command like '%Shell32.dll%' and command like '%Control_RunDLL%' and command like '%.cpl%')) or (parent_process_path = 'C:\\Windows\\System32\\control.exe' and command like '\"C:\\Windows\\system32\\rundll32.exe\" Shell32.dll,Control_RunDLL \"C:\\Windows\\System32\\%' and command like '%.cpl\",')))",
  "Tags": [
    "attack.defense-evasion",
    "attack.t1218.011"
  ],
  "Version": "0.1"
}