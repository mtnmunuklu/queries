{
  "Description": "Detects base64 encoded strings used in hidden malicious PowerShell command lines\n\nAuthor: John Lambert (rule)\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "f26c6093-6f14-4b12-800f-0fcb46f5ffd0",
  "InsertDate": "2025-01-25T21:22:05Z",
  "LastUpdateDate": "2025-01-25T21:22:05Z",
  "Level": "high",
  "Name": "Malicious Base64 Encoded PowerShell Keywords in Command Lines",
  "Query": "sourcetype='windows-sysmon' eql select * from _source_ where (((process_path like '%\\powershell.exe' or process_path like '%\\pwsh.exe') and (original_file_name = 'PowerShell.EXE' or original_file_name = 'pwsh.dll')) and command like '% hidden %' and (command like '%AGkAdABzAGEAZABtAGkAbgAgAC8AdAByAGEAbgBzAGYAZQByA%' or command like '%aXRzYWRtaW4gL3RyYW5zZmVy%' or command like '%IAaQB0AHMAYQBkAG0AaQBuACAALwB0AHIAYQBuAHMAZgBlAHIA%' or command like '%JpdHNhZG1pbiAvdHJhbnNmZX%' or command like '%YgBpAHQAcwBhAGQAbQBpAG4AIAAvAHQAcgBhAG4AcwBmAGUAcg%' or command like '%Yml0c2FkbWluIC90cmFuc2Zlc%' or command like '%AGMAaAB1AG4AawBfAHMAaQB6AGUA%' or command like '%JABjAGgAdQBuAGsAXwBzAGkAegBlA%' or command like '%JGNodW5rX3Npem%' or command like '%QAYwBoAHUAbgBrAF8AcwBpAHoAZQ%' or command like '%RjaHVua19zaXpl%' or command like '%Y2h1bmtfc2l6Z%' or command like '%AE8ALgBDAG8AbQBwAHIAZQBzAHMAaQBvAG4A%' or command like '%kATwAuAEMAbwBtAHAAcgBlAHMAcwBpAG8Abg%' or command like '%lPLkNvbXByZXNzaW9u%' or command like '%SQBPAC4AQwBvAG0AcAByAGUAcwBzAGkAbwBuA%' or command like '%SU8uQ29tcHJlc3Npb2%' or command like '%Ty5Db21wcmVzc2lvb%' or command like '%AE8ALgBNAGUAbQBvAHIAeQBTAHQAcgBlAGEAbQ%' or command like '%kATwAuAE0AZQBtAG8AcgB5AFMAdAByAGUAYQBtA%' or command like '%lPLk1lbW9yeVN0cmVhb%' or command like '%SQBPAC4ATQBlAG0AbwByAHkAUwB0AHIAZQBhAG0A%' or command like '%SU8uTWVtb3J5U3RyZWFt%' or command like '%Ty5NZW1vcnlTdHJlYW%' or command like '%4ARwBlAHQAQwBoAHUAbgBrA%' or command like '%5HZXRDaHVua%' or command like '%AEcAZQB0AEMAaAB1AG4Aaw%' or command like '%LgBHAGUAdABDAGgAdQBuAGsA%' or command like '%LkdldENodW5r%' or command like '%R2V0Q2h1bm%' or command like '%AEgAUgBFAEEARABfAEkATgBGAE8ANgA0A%' or command like '%QASABSAEUAQQBEAF8ASQBOAEYATwA2ADQA%' or command like '%RIUkVBRF9JTkZPNj%' or command like '%SFJFQURfSU5GTzY0%' or command like '%VABIAFIARQBBAEQAXwBJAE4ARgBPADYANA%' or command like '%VEhSRUFEX0lORk82N%' or command like '%AHIAZQBhAHQAZQBSAGUAbQBvAHQAZQBUAGgAcgBlAGEAZA%' or command like '%cmVhdGVSZW1vdGVUaHJlYW%' or command like '%MAcgBlAGEAdABlAFIAZQBtAG8AdABlAFQAaAByAGUAYQBkA%' or command like '%NyZWF0ZVJlbW90ZVRocmVhZ%' or command like '%Q3JlYXRlUmVtb3RlVGhyZWFk%' or command like '%QwByAGUAYQB0AGUAUgBlAG0AbwB0AGUAVABoAHIAZQBhAGQA%' or command like '%0AZQBtAG0AbwB2AGUA%' or command like '%1lbW1vdm%' or command like '%AGUAbQBtAG8AdgBlA%' or command like '%bQBlAG0AbQBvAHYAZQ%' or command like '%bWVtbW92Z%' or command like '%ZW1tb3Zl%'))",
  "Tags": [
    "attack.execution",
    "attack.t1059.001"
  ],
  "Version": "0.1"
}