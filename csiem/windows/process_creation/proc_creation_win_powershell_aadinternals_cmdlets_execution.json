{
  "Description": "Detects ADDInternals Cmdlet execution. A tool for administering Azure AD and Office 365. Which can be abused by threat actors to attack Azure AD or Office 365.\n\nAuthor: Austin Songer (@austinsonger), Nasreddine Bencherchali (Nextron Systems)\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "c86500e9-a645-4680-98d7-f882c70c1ea3",
  "InsertDate": "2025-01-19T11:34:58Z",
  "LastUpdateDate": "2025-01-19T11:34:58Z",
  "Level": "high",
  "Name": "AADInternals PowerShell Cmdlets Execution - ProccessCreation",
  "Query": "sourcetype='windows-sysmon' eql select * from _source_ where (((process_path like '%\\powershell.exe' or process_path like '%\\pwsh.exe') and (original_file_name = 'powershell.exe' or original_file_name = 'pwsh.dll')) and (command like '%add-aadint%' or command like '%convertto-aadint%' or command like '%disable-aadint%' or command like '%enable-aadint%' or command like '%export-aadint%' or command like '%get-aadint%' or command like '%grant-aadint%' or command like '%install-aadint%' or command like '%invoke-aadint%' or command like '%join-aadint%' or command like '%new-aadint%' or command like '%open-aadint%' or command like '%read-aadint%' or command like '%register-aadint%' or command like '%remove-aadint%' or command like '%restore-aadint%' or command like '%search-aadint%' or command like '%send-aadint%' or command like '%set-aadint%' or command like '%start-aadint%' or command like '%update-aadint%'))",
  "Tags": [
    "attack.execution",
    "attack.reconnaissance",
    "attack.discovery",
    "attack.credential-access",
    "attack.impact"
  ],
  "Version": "0.1"
}