{
  "Description": "Detects certain command line parameters often used during reconnaissance activity via web shells\n\nAuthor: Florian Roth (Nextron Systems), Jonhnathan Ribeiro, Anton Kutepov, oscd.community, Chad Hudson, Matt Anderson\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "bed2a484-9348-4143-8a8a-b801c979301c",
  "InsertDate": "2025-01-25T21:22:36Z",
  "LastUpdateDate": "2025-01-25T21:22:36Z",
  "Level": "high",
  "Name": "Webshell Detection With Command Line Keywords",
  "Query": "sourcetype='windows-sysmon' eql select * from _source_ where (((parent_process_path like '%\\w3wp.exe' or parent_process_path like '%\\php-cgi.exe' or parent_process_path like '%\\nginx.exe' or parent_process_path like '%\\httpd.exe' or parent_process_path like '%\\caddy.exe' or parent_process_path like '%\\ws_tomcatservice.exe') or ((parent_process_path like '%\\java.exe' or parent_process_path like '%\\javaw.exe') and (command like '%catalina.jar%' or command like '%CATALINA_HOME%')) or ((parent_process_path like '%\\java.exe' or parent_process_path like '%\\javaw.exe') and (parent_process_path like '%-tomcat-%' or parent_process_path like '%\\tomcat%'))) and (((original_file_name = 'net.exe' or original_file_name = 'net1.exe') and (command like '% user %' or command like '% use %' or command like '% group %')) or (original_file_name = 'ping.exe' and command like '% -n %') or (original_file_name = 'wmic.exe' and command like '% /node:%') or ((process_path like '%\\cmd.exe' or process_path like '%\\powershell.exe' or process_path like '%\\pwsh.exe') and (command like '% -enc %' or command like '% -EncodedCommand %' or command like '% -w hidden %' or command like '% -windowstyle hidden%' or command like '%.WebClient).Download%')) or ((process_path like '%\\dsquery.exe' or process_path like '%\\find.exe' or process_path like '%\\findstr.exe' or process_path like '%\\ipconfig.exe' or process_path like '%\\netstat.exe' or process_path like '%\\nslookup.exe' or process_path like '%\\pathping.exe' or process_path like '%\\quser.exe' or process_path like '%\\schtasks.exe' or process_path like '%\\systeminfo.exe' or process_path like '%\\tasklist.exe' or process_path like '%\\tracert.exe' or process_path like '%\\ver.exe' or process_path like '%\\wevtutil.exe' or process_path like '%\\whoami.exe') and (original_file_name = 'dsquery.exe' or original_file_name = 'find.exe' or original_file_name = 'findstr.exe' or original_file_name = 'ipconfig.exe' or original_file_name = 'netstat.exe' or original_file_name = 'nslookup.exe' or original_file_name = 'pathping.exe' or original_file_name = 'quser.exe' or original_file_name = 'schtasks.exe' or original_file_name = 'sysinfo.exe' or original_file_name = 'tasklist.exe' or original_file_name = 'tracert.exe' or original_file_name = 'ver.exe' or original_file_name = 'VSSADMIN.EXE' or original_file_name = 'wevtutil.exe' or original_file_name = 'whoami.exe')) or (command like '%\u0026cd\u0026echo%' or command like '%cd /d %') or (command like '% Test-NetConnection %' or command like '%dir \\%')))",
  "Tags": [
    "attack.persistence",
    "attack.t1505.003",
    "attack.t1018",
    "attack.t1033",
    "attack.t1087"
  ],
  "Version": "0.1"
}