{
  "Description": "Detects the execution of a Windows system binary that is usually located in the system folder from an uncommon location.\n\n\nAuthor: Florian Roth (Nextron Systems), Patrick Bareiss, Anton Kutepov, oscd.community, Nasreddine Bencherchali (Nextron Systems)\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "e4a6b256-3e47-40fc-89d2-7a477edd6915",
  "InsertDate": "2025-01-21T09:30:32Z",
  "LastUpdateDate": "2025-01-21T09:30:32Z",
  "Level": "high",
  "Name": "System File Execution Location Anomaly",
  "Query": "sourcetype='windows-sysmon' eql select * from _source_ where ((process_path like '%\\atbroker.exe' or process_path like '%\\audiodg.exe' or process_path like '%\\bcdedit.exe' or process_path like '%\\bitsadmin.exe' or process_path like '%\\certreq.exe' or process_path like '%\\certutil.exe' or process_path like '%\\cmstp.exe' or process_path like '%\\conhost.exe' or process_path like '%\\consent.exe' or process_path like '%\\cscript.exe' or process_path like '%\\csrss.exe' or process_path like '%\\dashost.exe' or process_path like '%\\defrag.exe' or process_path like '%\\dfrgui.exe' or process_path like '%\\dism.exe' or process_path like '%\\dllhost.exe' or process_path like '%\\dllhst3g.exe' or process_path like '%\\dwm.exe' or process_path like '%\\eventvwr.exe' or process_path like '%\\logonui.exe' or process_path like '%\\lsaiso.exe' or process_path like '%\\lsass.exe' or process_path like '%\\lsm.exe' or process_path like '%\\msiexec.exe' or process_path like '%\\ntoskrnl.exe' or process_path like '%\\powershell_ise.exe' or process_path like '%\\powershell.exe' or process_path like '%\\pwsh.exe' or process_path like '%\\regsvr32.exe' or process_path like '%\\rundll32.exe' or process_path like '%\\runonce.exe' or process_path like '%\\runtimebroker.exe' or process_path like '%\\schtasks.exe' or process_path like '%\\services.exe' or process_path like '%\\sihost.exe' or process_path like '%\\smartscreen.exe' or process_path like '%\\smss.exe' or process_path like '%\\spoolsv.exe' or process_path like '%\\svchost.exe' or process_path like '%\\taskhost.exe' or process_path like '%\\taskmgr.exe' or process_path like '%\\userinit.exe' or process_path like '%\\wininit.exe' or process_path like '%\\winlogon.exe' or process_path like '%\\winver.exe' or process_path like '%\\wlanext.exe' or process_path like '%\\wscript.exe' or process_path like '%\\wsl.exe' or process_path like '%\\wsmprovhost.exe') and  not ((process_path like 'c:\\program files\\windowsapps\\microsoftcorporationii.windowssubsystemforlinux%' and process_path like '%\\wsl.exe') or (process_path like 'c:\\$windows.~bt\\%' or process_path like 'c:\\$winreagent\\%' or process_path like 'c:\\windows\\softwaredistribution\\%' or process_path like 'c:\\windows\\system32\\%' or process_path like 'c:\\windows\\systemtemp\\%' or process_path like 'c:\\windows\\syswow64\\%' or process_path like 'c:\\windows\\uus\\%' or process_path like 'c:\\windows\\winsxs\\%') or (process_path = 'c:\\program files\\powershell\\7\\pwsh.exe' or process_path = 'c:\\program files\\powershell\\7-preview\\pwsh.exe')) and  not process_path like '%\\systemroot\\system32\\%')",
  "Tags": [
    "attack.defense-evasion",
    "attack.t1036"
  ],
  "Version": "0.1"
}