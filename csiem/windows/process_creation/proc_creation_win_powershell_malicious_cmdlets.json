{
  "Description": "Detects Commandlet names from well-known PowerShell exploitation frameworks\n\nAuthor: Nasreddine Bencherchali (Nextron Systems)\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "02030f2f-6199-49ec-b258-ea71b07e03dc",
  "InsertDate": "2025-01-25T21:22:09Z",
  "LastUpdateDate": "2025-01-25T21:22:09Z",
  "Level": "high",
  "Name": "Malicious PowerShell Commandlets - ProcessCreation",
  "Query": "sourcetype='windows-sysmon' eql select * from _source_ where (command like '%Add-Exfiltration%' or command like '%Add-Persistence%' or command like '%Add-RegBackdoor%' or command like '%Add-RemoteRegBackdoor%' or command like '%Add-ScrnSaveBackdoor%' or command like '%Check-VM%' or command like '%ConvertTo-Rc4ByteStream%' or command like '%Decrypt-Hash%' or command like '%Disable-ADIDNSNode%' or command like '%Disable-MachineAccount%' or command like '%Do-Exfiltration%' or command like '%Enable-ADIDNSNode%' or command like '%Enable-MachineAccount%' or command like '%Enabled-DuplicateToken%' or command like '%Exploit-Jboss%' or command like '%Export-ADR%' or command like '%Export-ADRCSV%' or command like '%Export-ADRExcel%' or command like '%Export-ADRHTML%' or command like '%Export-ADRJSON%' or command like '%Export-ADRXML%' or command like '%Find-Fruit%' or command like '%Find-GPOLocation%' or command like '%Find-TrustedDocuments%' or command like '%Get-ADIDNS%' or command like '%Get-ApplicationHost%' or command like '%Get-ChromeDump%' or command like '%Get-ClipboardContents%' or command like '%Get-FoxDump%' or command like '%Get-GPPPassword%' or command like '%Get-IndexedItem%' or command like '%Get-KerberosAESKey%' or command like '%Get-Keystrokes%' or command like '%Get-LSASecret%' or command like '%Get-MachineAccountAttribute%' or command like '%Get-MachineAccountCreator%' or command like '%Get-PassHashes%' or command like '%Get-RegAlwaysInstallElevated%' or command like '%Get-RegAutoLogon%' or command like '%Get-RemoteBootKey%' or command like '%Get-RemoteCachedCredential%' or command like '%Get-RemoteLocalAccountHash%' or command like '%Get-RemoteLSAKey%' or command like '%Get-RemoteMachineAccountHash%' or command like '%Get-RemoteNLKMKey%' or command like '%Get-RickAstley%' or command like '%Get-Screenshot%' or command like '%Get-SecurityPackages%' or command like '%Get-ServiceFilePermission%' or command like '%Get-ServicePermission%' or command like '%Get-ServiceUnquoted%' or command like '%Get-SiteListPassword%' or command like '%Get-System%' or command like '%Get-TimedScreenshot%' or command like '%Get-UnattendedInstallFile%' or command like '%Get-Unconstrained%' or command like '%Get-USBKeystrokes%' or command like '%Get-VaultCredential%' or command like '%Get-VulnAutoRun%' or command like '%Get-VulnSchTask%' or command like '%Grant-ADIDNSPermission%' or command like '%Gupt-Backdoor%' or command like '%HTTP-Login%' or command like '%Install-ServiceBinary%' or command like '%Install-SSP%' or command like '%Invoke-ACLScanner%' or command like '%Invoke-ADRecon%' or command like '%Invoke-ADSBackdoor%' or command like '%Invoke-AgentSmith%' or command like '%Invoke-AllChecks%' or command like '%Invoke-ARPScan%' or command like '%Invoke-AzureHound%' or command like '%Invoke-BackdoorLNK%' or command like '%Invoke-BadPotato%' or command like '%Invoke-BetterSafetyKatz%' or command like '%Invoke-BypassUAC%' or command like '%Invoke-Carbuncle%' or command like '%Invoke-Certify%' or command like '%Invoke-ConPtyShell%' or command like '%Invoke-CredentialInjection%' or command like '%Invoke-DAFT%' or command like '%Invoke-DCSync%' or command like '%Invoke-DinvokeKatz%' or command like '%Invoke-DllInjection%' or command like '%Invoke-DNSUpdate%' or command like '%Invoke-DomainPasswordSpray%' or command like '%Invoke-DowngradeAccount%' or command like '%Invoke-EgressCheck%' or command like '%Invoke-Eyewitness%' or command like '%Invoke-FakeLogonScreen%' or command like '%Invoke-Farmer%' or command like '%Invoke-Get-RBCD-Threaded%' or command like '%Invoke-Gopher%' or command like '%Invoke-Grouper%' or command like '%Invoke-HandleKatz%' or command like '%Invoke-ImpersonatedProcess%' or command like '%Invoke-ImpersonateSystem%' or command like '%Invoke-InteractiveSystemPowerShell%' or command like '%Invoke-Internalmonologue%' or command like '%Invoke-Inveigh%' or command like '%Invoke-InveighRelay%' or command like '%Invoke-KrbRelay%' or command like '%Invoke-LdapSignCheck%' or command like '%Invoke-Lockless%' or command like '%Invoke-MalSCCM%' or command like '%Invoke-Mimikatz%' or command like '%Invoke-Mimikittenz%' or command like '%Invoke-MITM6%' or command like '%Invoke-NanoDump%' or command like '%Invoke-NetRipper%' or command like '%Invoke-Nightmare%' or command like '%Invoke-NinjaCopy%' or command like '%Invoke-OfficeScrape%' or command like '%Invoke-OxidResolver%' or command like '%Invoke-P0wnedshell%' or command like '%Invoke-Paranoia%' or command like '%Invoke-PortScan%' or command like '%Invoke-PoshRatHttp%' or command like '%Invoke-PostExfil%' or command like '%Invoke-PowerDump%' or command like '%Invoke-PowerShellTCP%' or command like '%Invoke-PowerShellWMI%' or command like '%Invoke-PPLDump%' or command like '%Invoke-PsExec%' or command like '%Invoke-PSInject%' or command like '%Invoke-PsUaCme%' or command like '%Invoke-ReflectivePEInjection%' or command like '%Invoke-ReverseDNSLookup%' or command like '%Invoke-Rubeus%' or command like '%Invoke-RunAs%' or command like '%Invoke-SafetyKatz%' or command like '%Invoke-SauronEye%' or command like '%Invoke-SCShell%' or command like '%Invoke-Seatbelt%' or command like '%Invoke-ServiceAbuse%' or command like '%Invoke-ShadowSpray%' or command like '%Invoke-Sharp%' or command like '%Invoke-Shellcode%' or command like '%Invoke-SMBScanner%' or command like '%Invoke-Snaffler%' or command like '%Invoke-Spoolsample%' or command like '%Invoke-SpraySinglePassword%' or command like '%Invoke-SSHCommand%' or command like '%Invoke-StandIn%' or command like '%Invoke-StickyNotesExtract%' or command like '%Invoke-SystemCommand%' or command like '%Invoke-Tasksbackdoor%' or command like '%Invoke-Tater%' or command like '%Invoke-Thunderfox%' or command like '%Invoke-ThunderStruck%' or command like '%Invoke-TokenManipulation%' or command like '%Invoke-Tokenvator%' or command like '%Invoke-TotalExec%' or command like '%Invoke-UrbanBishop%' or command like '%Invoke-UserHunter%' or command like '%Invoke-VoiceTroll%' or command like '%Invoke-Whisker%' or command like '%Invoke-WinEnum%' or command like '%Invoke-winPEAS%' or command like '%Invoke-WireTap%' or command like '%Invoke-WmiCommand%' or command like '%Invoke-WMIExec%' or command like '%Invoke-WScriptBypassUAC%' or command like '%Invoke-Zerologon%' or command like '%MailRaider%' or command like '%New-ADIDNSNode%' or command like '%New-DNSRecordArray%' or command like '%New-HoneyHash%' or command like '%New-InMemoryModule%' or command like '%New-MachineAccount%' or command like '%New-SOASerialNumberArray%' or command like '%Out-Minidump%' or command like '%Port-Scan%' or command like '%PowerBreach%' or command like '%powercat %' or command like '%PowerUp%' or command like '%PowerView%' or command like '%Remove-ADIDNSNode%' or command like '%Remove-MachineAccount%' or command like '%Remove-Update%' or command like '%Rename-ADIDNSNode%' or command like '%Revoke-ADIDNSPermission%' or command like '%Set-ADIDNSNode%' or command like '%Set-MacAttribute%' or command like '%Set-MachineAccountAttribute%' or command like '%Set-Wallpaper%' or command like '%Show-TargetScreen%' or command like '%Start-CaptureServer%' or command like '%Start-Dnscat2%' or command like '%Start-WebcamRecorder%' or command like '%VolumeShadowCopyTools%')",
  "Tags": [
    "attack.execution",
    "attack.discovery",
    "attack.t1482",
    "attack.t1087",
    "attack.t1087.001",
    "attack.t1087.002",
    "attack.t1069.001",
    "attack.t1069.002",
    "attack.t1069",
    "attack.t1059.001"
  ],
  "Version": "0.1"
}