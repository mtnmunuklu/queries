{
  "Description": "Detects Commandlet names from well-known PowerShell exploitation frameworks\n\nAuthor: Nasreddine Bencherchali (Nextron Systems)\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "02030f2f-6199-49ec-b258-ea71b07e03dc",
  "InsertDate": "2025-01-21T09:28:59Z",
  "LastUpdateDate": "2025-01-21T09:28:59Z",
  "Level": "high",
  "Name": "Malicious PowerShell Commandlets - ProcessCreation",
  "Query": "sourcetype='windows-sysmon' eql select * from _source_ where (command like '%add-exfiltration%' or command like '%add-persistence%' or command like '%add-regbackdoor%' or command like '%add-remoteregbackdoor%' or command like '%add-scrnsavebackdoor%' or command like '%check-vm%' or command like '%convertto-rc4bytestream%' or command like '%decrypt-hash%' or command like '%disable-adidnsnode%' or command like '%disable-machineaccount%' or command like '%do-exfiltration%' or command like '%enable-adidnsnode%' or command like '%enable-machineaccount%' or command like '%enabled-duplicatetoken%' or command like '%exploit-jboss%' or command like '%export-adr%' or command like '%export-adrcsv%' or command like '%export-adrexcel%' or command like '%export-adrhtml%' or command like '%export-adrjson%' or command like '%export-adrxml%' or command like '%find-fruit%' or command like '%find-gpolocation%' or command like '%find-trusteddocuments%' or command like '%get-adidns%' or command like '%get-applicationhost%' or command like '%get-chromedump%' or command like '%get-clipboardcontents%' or command like '%get-foxdump%' or command like '%get-gpppassword%' or command like '%get-indexeditem%' or command like '%get-kerberosaeskey%' or command like '%get-keystrokes%' or command like '%get-lsasecret%' or command like '%get-machineaccountattribute%' or command like '%get-machineaccountcreator%' or command like '%get-passhashes%' or command like '%get-regalwaysinstallelevated%' or command like '%get-regautologon%' or command like '%get-remotebootkey%' or command like '%get-remotecachedcredential%' or command like '%get-remotelocalaccounthash%' or command like '%get-remotelsakey%' or command like '%get-remotemachineaccounthash%' or command like '%get-remotenlkmkey%' or command like '%get-rickastley%' or command like '%get-screenshot%' or command like '%get-securitypackages%' or command like '%get-servicefilepermission%' or command like '%get-servicepermission%' or command like '%get-serviceunquoted%' or command like '%get-sitelistpassword%' or command like '%get-system%' or command like '%get-timedscreenshot%' or command like '%get-unattendedinstallfile%' or command like '%get-unconstrained%' or command like '%get-usbkeystrokes%' or command like '%get-vaultcredential%' or command like '%get-vulnautorun%' or command like '%get-vulnschtask%' or command like '%grant-adidnspermission%' or command like '%gupt-backdoor%' or command like '%http-login%' or command like '%install-servicebinary%' or command like '%install-ssp%' or command like '%invoke-aclscanner%' or command like '%invoke-adrecon%' or command like '%invoke-adsbackdoor%' or command like '%invoke-agentsmith%' or command like '%invoke-allchecks%' or command like '%invoke-arpscan%' or command like '%invoke-azurehound%' or command like '%invoke-backdoorlnk%' or command like '%invoke-badpotato%' or command like '%invoke-bettersafetykatz%' or command like '%invoke-bypassuac%' or command like '%invoke-carbuncle%' or command like '%invoke-certify%' or command like '%invoke-conptyshell%' or command like '%invoke-credentialinjection%' or command like '%invoke-daft%' or command like '%invoke-dcsync%' or command like '%invoke-dinvokekatz%' or command like '%invoke-dllinjection%' or command like '%invoke-dnsupdate%' or command like '%invoke-domainpasswordspray%' or command like '%invoke-downgradeaccount%' or command like '%invoke-egresscheck%' or command like '%invoke-eyewitness%' or command like '%invoke-fakelogonscreen%' or command like '%invoke-farmer%' or command like '%invoke-get-rbcd-threaded%' or command like '%invoke-gopher%' or command like '%invoke-grouper%' or command like '%invoke-handlekatz%' or command like '%invoke-impersonatedprocess%' or command like '%invoke-impersonatesystem%' or command like '%invoke-interactivesystempowershell%' or command like '%invoke-internalmonologue%' or command like '%invoke-inveigh%' or command like '%invoke-inveighrelay%' or command like '%invoke-krbrelay%' or command like '%invoke-ldapsigncheck%' or command like '%invoke-lockless%' or command like '%invoke-malsccm%' or command like '%invoke-mimikatz%' or command like '%invoke-mimikittenz%' or command like '%invoke-mitm6%' or command like '%invoke-nanodump%' or command like '%invoke-netripper%' or command like '%invoke-nightmare%' or command like '%invoke-ninjacopy%' or command like '%invoke-officescrape%' or command like '%invoke-oxidresolver%' or command like '%invoke-p0wnedshell%' or command like '%invoke-paranoia%' or command like '%invoke-portscan%' or command like '%invoke-poshrathttp%' or command like '%invoke-postexfil%' or command like '%invoke-powerdump%' or command like '%invoke-powershelltcp%' or command like '%invoke-powershellwmi%' or command like '%invoke-ppldump%' or command like '%invoke-psexec%' or command like '%invoke-psinject%' or command like '%invoke-psuacme%' or command like '%invoke-reflectivepeinjection%' or command like '%invoke-reversednslookup%' or command like '%invoke-rubeus%' or command like '%invoke-runas%' or command like '%invoke-safetykatz%' or command like '%invoke-sauroneye%' or command like '%invoke-scshell%' or command like '%invoke-seatbelt%' or command like '%invoke-serviceabuse%' or command like '%invoke-shadowspray%' or command like '%invoke-sharp%' or command like '%invoke-shellcode%' or command like '%invoke-smbscanner%' or command like '%invoke-snaffler%' or command like '%invoke-spoolsample%' or command like '%invoke-spraysinglepassword%' or command like '%invoke-sshcommand%' or command like '%invoke-standin%' or command like '%invoke-stickynotesextract%' or command like '%invoke-systemcommand%' or command like '%invoke-tasksbackdoor%' or command like '%invoke-tater%' or command like '%invoke-thunderfox%' or command like '%invoke-thunderstruck%' or command like '%invoke-tokenmanipulation%' or command like '%invoke-tokenvator%' or command like '%invoke-totalexec%' or command like '%invoke-urbanbishop%' or command like '%invoke-userhunter%' or command like '%invoke-voicetroll%' or command like '%invoke-whisker%' or command like '%invoke-winenum%' or command like '%invoke-winpeas%' or command like '%invoke-wiretap%' or command like '%invoke-wmicommand%' or command like '%invoke-wmiexec%' or command like '%invoke-wscriptbypassuac%' or command like '%invoke-zerologon%' or command like '%mailraider%' or command like '%new-adidnsnode%' or command like '%new-dnsrecordarray%' or command like '%new-honeyhash%' or command like '%new-inmemorymodule%' or command like '%new-machineaccount%' or command like '%new-soaserialnumberarray%' or command like '%out-minidump%' or command like '%port-scan%' or command like '%powerbreach%' or command like '%powercat %' or command like '%powerup%' or command like '%powerview%' or command like '%remove-adidnsnode%' or command like '%remove-machineaccount%' or command like '%remove-update%' or command like '%rename-adidnsnode%' or command like '%revoke-adidnspermission%' or command like '%set-adidnsnode%' or command like '%set-macattribute%' or command like '%set-machineaccountattribute%' or command like '%set-wallpaper%' or command like '%show-targetscreen%' or command like '%start-captureserver%' or command like '%start-dnscat2%' or command like '%start-webcamrecorder%' or command like '%volumeshadowcopytools%')",
  "Tags": [
    "attack.execution",
    "attack.discovery",
    "attack.t1482",
    "attack.t1087",
    "attack.t1087.001",
    "attack.t1087.002",
    "attack.t1069.001",
    "attack.t1069.002",
    "attack.t1069",
    "attack.t1059.001"
  ],
  "Version": "0.1"
}