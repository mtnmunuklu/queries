{
  "Description": "Detects suspicious child processes of the Microsoft OneNote application. This may indicate an attempt to execute malicious embedded objects from a .one file.\n\nAuthor: Tim Rauch (Nextron Systems), Nasreddine Bencherchali (Nextron Systems), Elastic (idea)\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "c27515df-97a9-4162-8a60-dc0eeb51b775",
  "InsertDate": "2025-01-25T21:22:04Z",
  "LastUpdateDate": "2025-01-25T21:22:04Z",
  "Level": "high",
  "Name": "Suspicious Microsoft OneNote Child Process",
  "Query": "sourcetype='windows-sysmon' eql select * from _source_ where (parent_process_path like '%\\onenote.exe' and (((original_file_name = 'bitsadmin.exe' or original_file_name = 'CertOC.exe' or original_file_name = 'CertUtil.exe' or original_file_name = 'Cmd.Exe' or original_file_name = 'CMSTP.EXE' or original_file_name = 'cscript.exe' or original_file_name = 'curl.exe' or original_file_name = 'HH.exe' or original_file_name = 'IEExec.exe' or original_file_name = 'InstallUtil.exe' or original_file_name = 'javaw.exe' or original_file_name = 'Microsoft.Workflow.Compiler.exe' or original_file_name = 'msdt.exe' or original_file_name = 'MSHTA.EXE' or original_file_name = 'msiexec.exe' or original_file_name = 'Msxsl.exe' or original_file_name = 'odbcconf.exe' or original_file_name = 'pcalua.exe' or original_file_name = 'PowerShell.EXE' or original_file_name = 'RegAsm.exe' or original_file_name = 'RegSvcs.exe' or original_file_name = 'REGSVR32.exe' or original_file_name = 'RUNDLL32.exe' or original_file_name = 'schtasks.exe' or original_file_name = 'ScriptRunner.exe' or original_file_name = 'wmic.exe' or original_file_name = 'WorkFolders.exe' or original_file_name = 'wscript.exe') and (process_path like '%\\AppVLP.exe' or process_path like '%\\bash.exe' or process_path like '%\\bitsadmin.exe' or process_path like '%\\certoc.exe' or process_path like '%\\certutil.exe' or process_path like '%\\cmd.exe' or process_path like '%\\cmstp.exe' or process_path like '%\\control.exe' or process_path like '%\\cscript.exe' or process_path like '%\\curl.exe' or process_path like '%\\forfiles.exe' or process_path like '%\\hh.exe' or process_path like '%\\ieexec.exe' or process_path like '%\\installutil.exe' or process_path like '%\\javaw.exe' or process_path like '%\\mftrace.exe' or process_path like '%\\Microsoft.Workflow.Compiler.exe' or process_path like '%\\msbuild.exe' or process_path like '%\\msdt.exe' or process_path like '%\\mshta.exe' or process_path like '%\\msidb.exe' or process_path like '%\\msiexec.exe' or process_path like '%\\msxsl.exe' or process_path like '%\\odbcconf.exe' or process_path like '%\\pcalua.exe' or process_path like '%\\powershell.exe' or process_path like '%\\pwsh.exe' or process_path like '%\\regasm.exe' or process_path like '%\\regsvcs.exe' or process_path like '%\\regsvr32.exe' or process_path like '%\\rundll32.exe' or process_path like '%\\schtasks.exe' or process_path like '%\\scrcons.exe' or process_path like '%\\scriptrunner.exe' or process_path like '%\\sh.exe' or process_path like '%\\svchost.exe' or process_path like '%\\verclsid.exe' or process_path like '%\\wmic.exe' or process_path like '%\\workfolders.exe' or process_path like '%\\wscript.exe')) or (process_path like '%\\explorer.exe' and (command like '%.hta%' or command like '%.vb%' or command like '%.wsh%' or command like '%.js%' or command like '%.ps%' or command like '%.scr%' or command like '%.pif%' or command like '%.bat%' or command like '%.cmd%')) or (process_path like '%\\AppData\\%' or process_path like '%\\Users\\Public\\%' or process_path like '%\\ProgramData\\%' or process_path like '%\\Windows\\Tasks\\%' or process_path like '%\\Windows\\Temp\\%' or process_path like '%\\Windows\\System32\\Tasks\\%')) and  not ((process_path like '%\\AppData\\Local\\Microsoft\\Teams\\current\\Teams.exe' and command like '%-Embedding') or (process_path like '%\\AppData\\Local\\Microsoft\\OneDrive\\%' and process_path like '%\\FileCoAuth.exe' and command like '%-Embedding')))",
  "Tags": [
    "attack.t1566",
    "attack.t1566.001",
    "attack.initial-access"
  ],
  "Version": "0.1"
}