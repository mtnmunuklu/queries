{
  "Description": "Detects modification of autostart extensibility point (ASEP) in registry.\n\nAuthor: Victor Sergeev, Daniil Yugoslavskiy, Gleb Sukhodolskiy, Timur Zinniatullin, oscd.community, Tim Shelton, frack113 (split)\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "cbf93e5d-ca6c-4722-8bea-e9119007c248",
  "InsertDate": "2025-01-19T11:36:06Z",
  "LastUpdateDate": "2025-01-19T11:36:06Z",
  "Level": "medium",
  "Name": "CurrentVersion NT Autorun Keys Modification",
  "Query": "sourcetype like 'windows-%' eql select * from _source_ where (target_object like '%\\software\\microsoft\\windows nt\\currentversion%' and (target_object like '%\\winlogon\\vmapplet%' or target_object like '%\\winlogon\\userinit%' or target_object like '%\\winlogon\\taskman%' or target_object like '%\\winlogon\\shell%' or target_object like '%\\winlogon\\gpextensions%' or target_object like '%\\winlogon\\appsetup%' or target_object like '%\\winlogon\\alternateshells\\availableshells%' or target_object like '%\\windows\\iconservicelib%' or target_object like '%\\windows\\appinit_dlls%' or target_object like '%\\image file execution options%' or target_object like '%\\font drivers%' or target_object like '%\\drivers32%' or target_object like '%\\windows\\run%' or target_object like '%\\windows\\load%') and  not (((process_path like 'c:\\program files\\common files\\microsoft shared\\clicktorun\\%' or process_path like 'c:\\program files\\common files\\microsoft shared\\clicktorun\\updates\\%') and process_path like '%\\officeclicktorun.exe') or (process_path = 'c:\\windows\\system32\\svchost.exe' and (target_object like '%\\winlogon\\gpextensions\\{827d319e-6eac-11d2-a4ea-00c04f79f83a}\\previouspolicyareas%' or target_object like '%\\winlogon\\gpextensions\\{827d319e-6eac-11d2-a4ea-00c04f79f83a}\\maxnogpolistchangesinterval%') and (details = 'dword (0x00000009)' or details = 'dword (0x000003c0)')) or details = '(empty)' or (process_path like 'c:\\program files (x86)\\microsoft\\temp\\%' and process_path like '%\\microsoftedgeupdate.exe') or (target_object like '%\\image file execution options\\%' and (target_object like '%\\disableexceptionchainvalidation' or target_object like '%\\mitigationoptions')) or ((target_object like '%\\clicktorunstore\\hklm\\software\\microsoft\\windows nt\\currentversion\\%' or target_object like '%\\clicktorun\\registry\\machine\\software\\microsoft\\windows nt\\currentversion\\%') and (process_path = 'c:\\program files\\microsoft office\\root\\integration\\integrator.exe' or process_path = 'c:\\program files (x86)\\microsoft office\\root\\integration\\integrator.exe')) or (process_path like 'c:\\windows\\microsoft.net\\framework%' and process_path like '%\\ngen.exe') or (process_path like '%\\appdata\\local\\microsoft\\onedrive\\standaloneupdater\\onedrivesetup.exe' and target_object like '%\\microsoft\\windows\\currentversion\\runonce\\delete cached update binary' and details like 'c:\\windows\\system32\\cmd.exe /q /c del /q \"c:\\users\\%' and details like '%\\appdata\\local\\microsoft\\onedrive\\update\\onedrivesetup.exe\"')))",
  "Tags": [
    "attack.persistence",
    "attack.t1547.001"
  ],
  "Version": "0.1"
}