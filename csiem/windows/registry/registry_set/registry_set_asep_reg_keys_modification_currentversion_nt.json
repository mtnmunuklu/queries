{
  "Description": "Detects modification of autostart extensibility point (ASEP) in registry.\n\nAuthor: Victor Sergeev, Daniil Yugoslavskiy, Gleb Sukhodolskiy, Timur Zinniatullin, oscd.community, Tim Shelton, frack113 (split)\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "cbf93e5d-ca6c-4722-8bea-e9119007c248",
  "InsertDate": "2025-01-25T21:22:43Z",
  "LastUpdateDate": "2025-01-25T21:22:43Z",
  "Level": "medium",
  "Name": "CurrentVersion NT Autorun Keys Modification",
  "Query": "sourcetype like 'windows-%' eql select * from _source_ where (target_object like '%\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion%' and (target_object like '%\\Winlogon\\VmApplet%' or target_object like '%\\Winlogon\\Userinit%' or target_object like '%\\Winlogon\\Taskman%' or target_object like '%\\Winlogon\\Shell%' or target_object like '%\\Winlogon\\GpExtensions%' or target_object like '%\\Winlogon\\AppSetup%' or target_object like '%\\Winlogon\\AlternateShells\\AvailableShells%' or target_object like '%\\Windows\\IconServiceLib%' or target_object like '%\\Windows\\Appinit_Dlls%' or target_object like '%\\Image File Execution Options%' or target_object like '%\\Font Drivers%' or target_object like '%\\Drivers32%' or target_object like '%\\Windows\\Run%' or target_object like '%\\Windows\\Load%') and  not ((target_object like '%\\Image File Execution Options\\%' and (target_object like '%\\DisableExceptionChainValidation' or target_object like '%\\MitigationOptions')) or (process_path like '%\\AppData\\Local\\Microsoft\\OneDrive\\StandaloneUpdater\\OneDriveSetup.exe' and target_object like '%\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\Delete Cached Update Binary' and details like 'C:\\Windows\\system32\\cmd.exe /q /c del /q \"C:\\Users\\%' and details like '%\\AppData\\Local\\Microsoft\\OneDrive\\Update\\OneDriveSetup.exe\"') or details = '(Empty)' or ((target_object like '%\\ClickToRunStore\\HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\%' or target_object like '%\\ClickToRun\\REGISTRY\\MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\%') and (process_path = 'C:\\Program Files\\Microsoft Office\\root\\integration\\integrator.exe' or process_path = 'C:\\Program Files (x86)\\Microsoft Office\\root\\integration\\integrator.exe')) or ((process_path like 'C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\%' or process_path like 'C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\Updates\\%') and process_path like '%\\OfficeClickToRun.exe') or (process_path = 'C:\\Windows\\system32\\svchost.exe' and (target_object like '%\\Winlogon\\GPExtensions\\{827D319E-6EAC-11D2-A4EA-00C04F79F83A}\\PreviousPolicyAreas%' or target_object like '%\\Winlogon\\GPExtensions\\{827D319E-6EAC-11D2-A4EA-00C04F79F83A}\\MaxNoGPOListChangesInterval%') and (details = 'DWORD (0x00000009)' or details = 'DWORD (0x000003c0)')) or (process_path like 'C:\\Windows\\Microsoft.NET\\Framework%' and process_path like '%\\ngen.exe') or (process_path like 'C:\\Program Files (x86)\\Microsoft\\Temp\\%' and process_path like '%\\MicrosoftEdgeUpdate.exe')))",
  "Tags": [
    "attack.persistence",
    "attack.t1547.001"
  ],
  "Version": "0.1"
}