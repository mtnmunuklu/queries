{
  "Description": "Detects modification of autostart extensibility point (ASEP) in registry.\n\nAuthor: Victor Sergeev, Daniil Yugoslavskiy, Gleb Sukhodolskiy, Timur Zinniatullin, oscd.community, Tim Shelton, frack113 (split)\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "f674e36a-4b91-431e-8aef-f8a96c2aca35",
  "InsertDate": "2025-01-21T09:31:21Z",
  "LastUpdateDate": "2025-01-21T09:31:21Z",
  "Level": "medium",
  "Name": "CurrentControlSet Autorun Keys Modification",
  "Query": "sourcetype like 'windows-%' eql select * from _source_ where ((target_object like '%\\system\\currentcontrolset\\control%' and (target_object like '%\\terminal server\\winstations\\rdp-tcp\\initialprogram%' or target_object like '%\\terminal server\\wds\\rdpwd\\startupprograms%' or target_object like '%\\securityproviders\\securityproviders%' or target_object like '%\\safeboot\\alternateshell%' or target_object like '%\\print\\providers%' or target_object like '%\\print\\monitors%' or target_object like '%\\networkprovider\\order%' or target_object like '%\\lsa\\notification packages%' or target_object like '%\\lsa\\authentication packages%' or target_object like '%\\bootverificationprogram\\imagepath%')) and  not ((process_path = 'c:\\windows\\system32\\poqexec.exe' and target_object like '%\\networkprovider\\order\\providerorder') or (process_path = 'c:\\windows\\system32\\spoolsv.exe' and target_object like '%\\print\\monitors\\monvnc\\driver' and details = 'vncpm.dll') or details = '(empty)' or (process_path = 'c:\\windows\\system32\\spoolsv.exe' and target_object like '%\\print\\monitors\\cutepdf writer monitor%' and (details = 'cpwmon64_v40.dll' or details = 'cutepdf writer')) or (process_path = 'c:\\windows\\system32\\spoolsv.exe' and target_object like '%print\\monitors\\appmon\\ports\\microsoft.office.onenote_%' and (username like '%authori%' or username like '%autori%'))))",
  "Tags": [
    "attack.persistence",
    "attack.t1547.001"
  ],
  "Version": "0.1"
}