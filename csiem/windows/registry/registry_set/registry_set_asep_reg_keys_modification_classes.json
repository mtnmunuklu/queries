{
  "Description": "Detects modification of autostart extensibility point (ASEP) in registry.\n\nAuthor: Victor Sergeev, Daniil Yugoslavskiy, Gleb Sukhodolskiy, Timur Zinniatullin, oscd.community, Tim Shelton, frack113 (split)\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "9df5f547-c86a-433e-b533-f2794357e242",
  "InsertDate": "2025-01-21T09:31:21Z",
  "LastUpdateDate": "2025-01-21T09:31:21Z",
  "Level": "medium",
  "Name": "Classes Autorun Keys Modification",
  "Query": "sourcetype like 'windows-%' eql select * from _source_ where ((target_object like '%\\software\\classes%' and (target_object like '%\\folder\\shellex\\extshellfolderviews%' or target_object like '%\\folder\\shellex\\dragdrophandlers%' or target_object like '%\\folder\\shellex\\columnhandlers%' or target_object like '%\\filter%' or target_object like '%\\exefile\\shell\\open\\command\\(default)%' or target_object like '%\\directory\\shellex\\dragdrophandlers%' or target_object like '%\\directory\\shellex\\copyhookhandlers%' or target_object like '%\\clsid\\{ac757296-3522-4e11-9862-c17be5a1767e}\\instance%' or target_object like '%\\clsid\\{abe3b9a4-257d-4b97-bd1a-294af496222e}\\instance%' or target_object like '%\\clsid\\{7ed96837-96f0-4812-b211-f13c24117ed3}\\instance%' or target_object like '%\\clsid\\{083863f1-70de-11d0-bd40-00a0c911ce86}\\instance%' or target_object like '%\\classes\\allfilesystemobjects\\shellex\\dragdrophandlers%' or target_object like '%\\.exe%' or target_object like '%\\.cmd%' or target_object like '%\\shellex\\propertysheethandlers%' or target_object like '%\\shellex\\contextmenuhandlers%')) and  not (details = '(empty)' or details = '{807583e5-5146-11d5-a672-00b0d022e945}' or process_path = 'c:\\windows\\system32\\drvinst.exe' or (process_path = 'c:\\windows\\system32\\svchost.exe' and target_object like '%\\lnkfile\\shellex\\contextmenuhandlers\\%')))",
  "Tags": [
    "attack.persistence",
    "attack.t1547.001"
  ],
  "Version": "0.1"
}