{
  "Description": "Detects modification of autostart extensibility point (ASEP) in registry.\n\nAuthor: Victor Sergeev, Daniil Yugoslavskiy, Gleb Sukhodolskiy, Timur Zinniatullin, oscd.community, Tim Shelton, frack113 (split)\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "baecf8fb-edbf-429f-9ade-31fc3f22b970",
  "InsertDate": "2025-01-21T09:31:22Z",
  "LastUpdateDate": "2025-01-21T09:31:22Z",
  "Level": "medium",
  "Name": "Office Autorun Keys Modification",
  "Query": "sourcetype like 'windows-%' eql select * from _source_ where ((target_object like '%\\software\\wow6432node\\microsoft\\office%' or target_object like '%\\software\\microsoft\\office%') and (target_object like '%\\word\\addins%' or target_object like '%\\powerpoint\\addins%' or target_object like '%\\outlook\\addins%' or target_object like '%\\onenote\\addins%' or target_object like '%\\excel\\addins%' or target_object like '%\\access\\addins%' or target_object like '%test\\special\\perf%') and  not (((process_path like 'c:\\program files\\microsoft office\\%' or process_path like 'c:\\program files (x86)\\microsoft office\\%' or process_path like 'c:\\windows\\system32\\msiexec.exe%' or process_path like 'c:\\windows\\system32\\regsvr32.exe%') and (target_object like '%\\excel\\addins\\adhocreportingexcelclientlib.adhocreportingexcelclientaddin.1\\%' or target_object like '%\\excel\\addins\\excelpluginshell.powermapconnect\\%' or target_object like '%\\excel\\addins\\nativeshim\\%' or target_object like '%\\excel\\addins\\nativeshim.inquireconnector.1\\%' or target_object like '%\\excel\\addins\\powerpivotexcelclientaddin.nativeentry.1\\%' or target_object like '%\\outlook\\addins\\accessaddin.dc\\%' or target_object like '%\\outlook\\addins\\colleagueimport.colleagueimportaddin\\%' or target_object like '%\\outlook\\addins\\evernotecc.evernotecontactconnector\\%' or target_object like '%\\outlook\\addins\\evernoteolrd.connect\\%' or target_object like '%\\outlook\\addins\\microsoft.vbaaddinforoutlook.1\\%' or target_object like '%\\outlook\\addins\\ocoffice.ocforms\\%' or target_object like '%\\outlook\\addins\\\\onenote.outlookaddin%' or target_object like '%\\outlook\\addins\\oscaddin.connect\\%' or target_object like '%\\outlook\\addins\\outlookchangenotifier.connect\\%' or target_object like '%\\outlook\\addins\\ucaddin.lyncaddin.1%' or target_object like '%\\outlook\\addins\\ucaddin.ucaddin.1%' or target_object like '%\\outlook\\addins\\umoutlookaddin.formregionaddin\\%')) or ((process_path like 'c:\\program files\\common files\\microsoft shared\\clicktorun\\%' or process_path like 'c:\\program files\\common files\\microsoft shared\\clicktorun\\updates\\%') and process_path like '%\\officeclicktorun.exe') or (process_path = 'c:\\program files\\avg\\antivirus\\regsvr.exe' and target_object like '%\\microsoft\\office\\outlook\\addins\\antivirus.asoutext\\%') or details = '(empty)'))",
  "Tags": [
    "attack.persistence",
    "attack.t1547.001"
  ],
  "Version": "0.1"
}