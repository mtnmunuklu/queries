{
  "Description": "Detects modification of autostart extensibility point (ASEP) in registry.\n\nAuthor: Victor Sergeev, Daniil Yugoslavskiy, Gleb Sukhodolskiy, Timur Zinniatullin, oscd.community, Tim Shelton, frack113 (split)\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "20f0ee37-5942-4e45-b7d5-c5b5db9df5cd",
  "InsertDate": "2025-01-19T11:36:06Z",
  "LastUpdateDate": "2025-01-19T11:36:06Z",
  "Level": "medium",
  "Name": "CurrentVersion Autorun Keys Modification",
  "Query": "sourcetype like 'windows-%' eql select * from _source_ where ((target_object like '%\\software\\microsoft\\windows\\currentversion%' and (target_object like '%\\shellserviceobjectdelayload%' or target_object like '%\\run\\%' or target_object like '%\\runonce\\%' or target_object like '%\\runonceex\\%' or target_object like '%\\runservices\\%' or target_object like '%\\runservicesonce\\%' or target_object like '%\\policies\\system\\shell%' or target_object like '%\\policies\\explorer\\run%' or target_object like '%\\group policy\\scripts\\startup%' or target_object like '%\\group policy\\scripts\\shutdown%' or target_object like '%\\group policy\\scripts\\logon%' or target_object like '%\\group policy\\scripts\\logoff%' or target_object like '%\\explorer\\shellserviceobjects%' or target_object like '%\\explorer\\shelliconoverlayidentifiers%' or target_object like '%\\explorer\\shellexecutehooks%' or target_object like '%\\explorer\\sharedtaskscheduler%' or target_object like '%\\explorer\\browser helper objects%' or target_object like '%\\authentication\\plap providers%' or target_object like '%\\authentication\\credential providers%' or target_object like '%\\authentication\\credential provider filters%')) and  not ((process_path = 'c:\\windows\\system32\\userinit.exe' and details = 'ctfmon.exe /n') or (process_path = 'c:\\windows\\system32\\regsvr32.exe' and target_object like '%dropboxext%' and details like '%a251-47b7-93e1-cdd82e34af8b}') or (target_object like '%\\software\\microsoft\\windows\\currentversion\\run\\greenshot' and details = 'c:\\program files\\greenshot\\greenshot.exe') or (target_object like '%googledrive%' and (details = '{cfe8b367-77a7-41d7-9c90-75d16d7dc6b6}' or details = '{a8e52322-8734-481d-a7e2-27b309ef8d56}' or details = '{c973da94-cbdf-4e77-81d1-e5b794fbd146}' or details = '{51ef1569-67ee-4ad6-9646-e726c3ffc8a2}')) or ((details like 'c:\\windows\\system32\\cmd.exe /q /c rmdir /s /q \"c:\\users\\%' or details like 'c:\\windows\\system32\\cmd.exe /q /c del /q \"c:\\users\\%') and details like '%\\appdata\\local\\microsoft\\onedrive\\%') or (target_object like '%\\microsoft\\windows\\currentversion\\runonce\\{%' and (details like '%\\appdata\\local\\package cache\\{%' and details like '%}\\python-%') and details like '%.exe\" /burn.runonce') or (process_path like '%\\microsoft\\teams\\current\\teams.exe' and details like '%\\microsoft\\teams\\update.exe --processstart %') or ((process_path like '%\\aurora-agent-64.exe' or process_path like '%\\aurora-agent.exe') and target_object like '%\\microsoft\\windows\\currentversion\\run\\aurora-dashboard' and details = 'c:\\program files\\aurora-agent\\tools\\aurora-dashboard.exe') or (target_object like '%\\microsoft\\windows\\currentversion\\run\\everything' and details like '%\\everything\\everything.exe\" -startup') or (process_path = 'c:\\windows\\system32\\logonui.exe' and (target_object like '%\\authentication\\credential providers\\{d6886603-9d2f-4eb2-b667-1971041fa96b}\\%' or target_object like '%\\authentication\\credential providers\\{bec09223-b018-416d-a0ac-523971b639f5}\\%' or target_object like '%\\authentication\\credential providers\\{8af662bf-65a0-4d0a-a540-a338a999d36f}\\%' or target_object like '%\\authentication\\credential providers\\{27fbdb57-b613-4af2-9d7e-4fa7a66c21ad}\\%')) or (target_object like '%\\software\\microsoft\\windows\\currentversion\\run\\opera browser assistant' and details = 'c:\\program files\\opera\\assistant\\browser_assistant.exe') or (target_object like '%\\software\\microsoft\\windows\\currentversion\\run\\googledrivefs' and details like 'c:\\program files\\google\\drive file stream\\%' and details like '%\\googledrivefs.exe%') or ((process_path like 'c:\\program files\\common files\\microsoft shared\\clicktorun\\%' or process_path like 'c:\\program files\\common files\\microsoft shared\\clicktorun\\updates\\%') and process_path like '%\\officeclicktorun.exe') or (process_path like 'c:\\program files\\avg\\antivirus\\setup\\%' and (details = '\"c:\\program files\\avg\\antivirus\\avlaunch.exe\" /gui' or details = '\"c:\\program files (x86)\\avg\\antivirus\\avlaunch.exe\" /gui' or details = '{472083b0-c522-11cf-8763-00608cc02f24}')) or (details = '(empty)' and target_object like '%\\ngcfirst\\consecutiveswitchcount' and (process_path like '%\\appdata\\local\\microsoft\\onedrive\\update\\onedrivesetup.exe' or process_path like '%\\appdata\\roaming\\spotify\\spotify.exe' or process_path like '%\\appdata\\local\\webex\\webexhost.exe') and (process_path = 'c:\\windows\\system32\\devicecensus.exe' or process_path = 'c:\\windows\\system32\\winsat.exe' or process_path = 'c:\\program files\\microsoft onedrive\\standaloneupdater\\onedrivesetup.exe' or process_path = 'c:\\program files\\microsoft onedrive\\update\\onedrivesetup.exe' or process_path = 'c:\\program files (x86)\\microsoft onedrive\\update\\onedrivesetup.exe' or process_path = 'c:\\program files\\keepass password safe 2\\shinstutil.exe' or process_path = 'c:\\program files\\everything\\everything.exe' or process_path = 'c:\\program files (x86)\\microsoft office\\root\\integration\\integrator.exe')) or (target_object like '%\\software\\microsoft\\windows\\currentversion\\run\\ituneshelper' and details = '\"c:\\program files\\itunes\\ituneshelper.exe\"') or (target_object like '%\\software\\microsoft\\windows\\currentversion\\runonce\\zoommsirepair' and details = '\"c:\\program files\\zoom\\bin\\installer.exe\" /repair') or process_path = 'c:\\program files\\windows defender\\msmpeng.exe' or (process_path like 'c:\\program files (x86)\\microsoft\\edgeupdate\\install\\%' or process_path like 'c:\\program files (x86)\\microsoft\\edgewebview\\%' or process_path like 'c:\\program files (x86)\\microsoft\\edge\\application\\msedge.exe%')))",
  "Tags": [
    "attack.persistence",
    "attack.t1547.001"
  ],
  "Version": "0.1"
}