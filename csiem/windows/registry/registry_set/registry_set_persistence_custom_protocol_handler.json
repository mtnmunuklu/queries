{
  "Description": "Detects potential persistence activity via the registering of a new custom protocole handlers. While legitimate applications register protocole handlers often times during installation. And attacker can abuse this by setting a custom handler to be used as a persistence mechanism.\n\nAuthor: Nasreddine Bencherchali (Nextron Systems)\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "fdbf0b9d-0182-4c43-893b-a1eaab92d085",
  "InsertDate": "2025-01-19T11:36:17Z",
  "LastUpdateDate": "2025-01-19T11:36:17Z",
  "Level": "medium",
  "Name": "Potential Persistence Via Custom Protocol Handler",
  "Query": "sourcetype like 'windows-%' eql select * from _source_ where ((target_object like 'hkcr\\%' and details like 'url:%') and  not ((process_path like 'c:\\program files (x86)%' or process_path like 'c:\\program files\\%' or process_path like 'c:\\windows\\system32\\%' or process_path like 'c:\\windows\\syswow64\\%') or details like 'url:ms-%'))",
  "Tags": [
    "attack.defense-evasion",
    "attack.t1112"
  ],
  "Version": "0.1"
}