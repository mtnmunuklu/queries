{
  "Description": "Detects modification of autostart extensibility point (ASEP) in registry.\n\nAuthor: Victor Sergeev, Daniil Yugoslavskiy, Gleb Sukhodolskiy, Timur Zinniatullin, oscd.community, Tim Shelton, frack113 (split)\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "b29aed60-ebd1-442b-9cb5-16a1d0324adb",
  "InsertDate": "2025-01-19T11:36:07Z",
  "LastUpdateDate": "2025-01-19T11:36:07Z",
  "Level": "medium",
  "Name": "Wow6432Node CurrentVersion Autorun Keys Modification",
  "Query": "sourcetype like 'windows-%' eql select * from _source_ where ((target_object like '%\\software\\wow6432node\\microsoft\\windows\\currentversion%' and (target_object like '%\\shellserviceobjectdelayload%' or target_object like '%\\run\\%' or target_object like '%\\runonce\\%' or target_object like '%\\runonceex\\%' or target_object like '%\\runservices\\%' or target_object like '%\\runservicesonce\\%' or target_object like '%\\explorer\\shellserviceobjects%' or target_object like '%\\explorer\\shelliconoverlayidentifiers%' or target_object like '%\\explorer\\shellexecutehooks%' or target_object like '%\\explorer\\sharedtaskscheduler%' or target_object like '%\\explorer\\browser helper objects%')) and  not ((process_path like '%\\windowsdesktop-runtime-%' and (target_object like '%\\wow6432node\\microsoft\\windows\\currentversion\\runonce\\{e2d1ae32-dd1d-4ad7-a298-10e42e7840fc}' or target_object like '%\\wow6432node\\microsoft\\windows\\currentversion\\runonce\\{7037b699-7382-448c-89a7-4765961d2537}') and details like '\"c:\\programdata\\package cache\\%' and details like '%.exe\" /burn.runonce') or ((process_path like 'c:\\program files\\common files\\microsoft shared\\clicktorun\\%' or process_path like 'c:\\program files\\common files\\microsoft shared\\clicktorun\\updates\\%') and process_path like '%\\officeclicktorun.exe') or (process_path = 'c:\\windows\\system32\\msiexec.exe' and target_object like '%\\software\\wow6432node\\microsoft\\windows\\currentversion\\run\\%') or details = '(empty)' or (process_path = 'c:\\program files\\common files\\microsoft shared\\clicktorun\\officeclicktorun.exe' and target_object like '%\\office\\clicktorun\\registry\\machine\\software\\wow6432node\\%') or ((process_path = 'c:\\program files\\microsoft office\\root\\integration\\integrator.exe' or process_path = 'c:\\program files (x86)\\microsoft office\\root\\integration\\integrator.exe') and target_object like '%\\explorer\\browser helper objects\\{31d09ba0-12f5-4cce-be8a-2923e76605da}\\%') or (details like '%-a251-47b7-93e1-cdd82e34af8b}' and details = 'grpconv -o' and (details like '%c:\\program files%' and details like '%\\dropbox\\client\\dropbox.exe%' and details like '% /systemstartup%')) or (process_path like '%\\vc_redist.x64.exe' and details like '%}\\vc_redist.x64.exe\" /burn.runonce') or target_object like '%\\explorer\\browser helper objects\\{92ef2ead-a7ce-4424-b0db-499cf856608e}\\noexplorer' or details like '\"c:\\programdata\\package cache\\{d21a4f20-968a-4b0c-bf04-a38da5f06e41}\\windowsdesktop-runtime-%' or ((process_path like 'c:\\programdata\\package cache%' or process_path like 'c:\\windows\\temp\\%') and (process_path like '%\\winsdksetup.exe%' or process_path like '%\\windowsdesktop-runtime-%' or process_path like '%\\aspnetcoresharedframeworkbundle-%') and details like '% /burn.runonce') or (process_path like '%c:\\program files (x86)\\microsoft\\edgeupdate\\install\\{%' and process_path like '%\\setup.exe%') or (process_path like 'c:\\windows\\installer\\msi%' and target_object like '%\\explorer\\browser helper objects%')))",
  "Tags": [
    "attack.persistence",
    "attack.t1547.001"
  ],
  "Version": "0.1"
}