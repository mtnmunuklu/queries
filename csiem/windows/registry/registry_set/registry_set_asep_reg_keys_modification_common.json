{
  "Description": "Detects modification of autostart extensibility point (ASEP) in registry.\n\nAuthor: Victor Sergeev, Daniil Yugoslavskiy, Gleb Sukhodolskiy, Timur Zinniatullin, oscd.community, Tim Shelton, frack113 (split), wagga (name)\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "f59c3faf-50f3-464b-9f4c-1b67ab512d99",
  "InsertDate": "2025-01-25T21:22:42Z",
  "LastUpdateDate": "2025-01-25T21:22:42Z",
  "Level": "medium",
  "Name": "Common Autorun Keys Modification",
  "Query": "sourcetype like 'windows-%' eql select * from _source_ where ((target_object like '%\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows CE Services\\AutoStart%' or target_object like '%\\Software\\Wow6432Node\\Microsoft\\Command Processor\\Autorun%' or target_object like '%\\SOFTWARE\\Wow6432Node\\Microsoft\\Active Setup\\Installed Components%' or target_object like '%\\SOFTWARE\\Microsoft\\Windows CE Services\\AutoStartOnDisconnect%' or target_object like '%\\SOFTWARE\\Microsoft\\Windows CE Services\\AutoStartOnConnect%' or target_object like '%\\SYSTEM\\Setup\\CmdLine%' or target_object like '%\\Software\\Microsoft\\Ctf\\LangBarAddin%' or target_object like '%\\Software\\Microsoft\\Command Processor\\Autorun%' or target_object like '%\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components%' or target_object like '%\\SOFTWARE\\Classes\\Protocols\\Handler%' or target_object like '%\\SOFTWARE\\Classes\\Protocols\\Filter%' or target_object like '%\\SOFTWARE\\Classes\\Htmlfile\\Shell\\Open\\Command\\(Default)%' or target_object like '%\\Environment\\UserInitMprLogonScript%' or target_object like '%\\SOFTWARE\\Policies\\Microsoft\\Windows\\Control Panel\\Desktop\\Scrnsave.exe%' or target_object like '%\\Software\\Microsoft\\Internet Explorer\\UrlSearchHooks%' or target_object like '%\\SOFTWARE\\Microsoft\\Internet Explorer\\Desktop\\Components%' or target_object like '%\\Software\\Classes\\Clsid\\{AB8902B4-09CA-4bb6-B78D-A8F59079A8D5}\\Inprocserver32%' or target_object like '%\\Control Panel\\Desktop\\Scrnsave.exe%') and  not (details = '(Empty)' or ((target_object like '%\\Office\\ClickToRun\\REGISTRY\\MACHINE\\Software\\Classes\\PROTOCOLS\\Handler\\%' or target_object like '%\\ClickToRunStore\\HKMU\\SOFTWARE\\Classes\\PROTOCOLS\\Handler\\%') and (details = '{314111c7-a502-11d2-bbca-00c04f8ec294}' or details = '{3459B272-CC19-4448-86C9-DDC3B4B2FAD3}' or details = '{42089D2D-912D-4018-9087-2B87803E93FB}' or details = '{5504BE45-A83B-4808-900A-3A5C36E7F77A}' or details = '{807583E5-5146-11D5-A672-00B0D022E945}')) or target_object like '%\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\{8A69D345-D564-463c-AFF1-A69D9E530F96}%' or target_object like '%\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\{9459C573-B17A-45AE-9F64-1857B5D58CEE}%' or target_object like '%\\Software\\Microsoft\\Active Setup\\Installed Components\\{89820200-ECBD-11cf-8B85-00AA005B4383}%' or (process_path = 'C:\\Windows\\System32\\poqexec.exe' or process_path = 'C:\\Program Files (x86)\\Microsoft Office\\root\\integration\\integrator.exe') or ((process_path like 'C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\%' or process_path like 'C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\Updates\\%') and process_path like '%\\OfficeClickToRun.exe')))",
  "Tags": [
    "attack.persistence",
    "attack.t1547.001"
  ],
  "Version": "0.1"
}