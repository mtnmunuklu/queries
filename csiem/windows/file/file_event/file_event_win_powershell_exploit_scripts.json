{
  "Description": "Detects the creation of known offensive powershell scripts used for exploitation\n\nAuthor: Markus Neis, Nasreddine Bencherchali (Nextron Systems), Mustafa Kaan Demir, Georg Lauenstein\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "f331aa1f-8c53-4fc3-b083-cc159bc971cb",
  "InsertDate": "2025-01-25T21:21:00Z",
  "LastUpdateDate": "2025-01-25T21:21:00Z",
  "Level": "high",
  "Name": "Malicious PowerShell Scripts - FileCreation",
  "Query": "sourcetype='windows-sysmon' eql select * from _source_ where ((filepath like '%\\Add-ConstrainedDelegationBackdoor.ps1' or filepath like '%\\Add-Exfiltration.ps1' or filepath like '%\\Add-Persistence.ps1' or filepath like '%\\Add-RegBackdoor.ps1' or filepath like '%\\Add-RemoteRegBackdoor.ps1' or filepath like '%\\Add-ScrnSaveBackdoor.ps1' or filepath like '%\\ADRecon.ps1' or filepath like '%\\AzureADRecon.ps1' or filepath like '%\\Check-VM.ps1' or filepath like '%\\ConvertTo-ROT13.ps1' or filepath like '%\\Copy-VSS.ps1' or filepath like '%\\Create-MultipleSessions.ps1' or filepath like '%\\DNS_TXT_Pwnage.ps1' or filepath like '%\\dnscat2.ps1' or filepath like '%\\Do-Exfiltration.ps1' or filepath like '%\\DomainPasswordSpray.ps1' or filepath like '%\\Download_Execute.ps1' or filepath like '%\\Download-Execute-PS.ps1' or filepath like '%\\Enable-DuplicateToken.ps1' or filepath like '%\\Enabled-DuplicateToken.ps1' or filepath like '%\\Execute-Command-MSSQL.ps1' or filepath like '%\\Execute-DNSTXT-Code.ps1' or filepath like '%\\Execute-OnTime.ps1' or filepath like '%\\ExetoText.ps1' or filepath like '%\\Exploit-Jboss.ps1' or filepath like '%\\Find-AVSignature.ps1' or filepath like '%\\Find-Fruit.ps1' or filepath like '%\\Find-GPOLocation.ps1' or filepath like '%\\Find-TrustedDocuments.ps1' or filepath like '%\\FireBuster.ps1' or filepath like '%\\FireListener.ps1' or filepath like '%\\Get-ApplicationHost.ps1' or filepath like '%\\Get-ChromeDump.ps1' or filepath like '%\\Get-ClipboardContents.ps1' or filepath like '%\\Get-ComputerDetail.ps1' or filepath like '%\\Get-FoxDump.ps1' or filepath like '%\\Get-GPPAutologon.ps1' or filepath like '%\\Get-GPPPassword.ps1' or filepath like '%\\Get-IndexedItem.ps1' or filepath like '%\\Get-Keystrokes.ps1' or filepath like '%\\Get-LSASecret.ps1' or filepath like '%\\Get-MicrophoneAudio.ps1' or filepath like '%\\Get-PassHashes.ps1' or filepath like '%\\Get-PassHints.ps1' or filepath like '%\\Get-RegAlwaysInstallElevated.ps1' or filepath like '%\\Get-RegAutoLogon.ps1' or filepath like '%\\Get-RickAstley.ps1' or filepath like '%\\Get-Screenshot.ps1' or filepath like '%\\Get-SecurityPackages.ps1' or filepath like '%\\Get-ServiceFilePermission.ps1' or filepath like '%\\Get-ServicePermission.ps1' or filepath like '%\\Get-ServiceUnquoted.ps1' or filepath like '%\\Get-SiteListPassword.ps1' or filepath like '%\\Get-System.ps1' or filepath like '%\\Get-TimedScreenshot.ps1' or filepath like '%\\Get-UnattendedInstallFile.ps1' or filepath like '%\\Get-Unconstrained.ps1' or filepath like '%\\Get-USBKeystrokes.ps1' or filepath like '%\\Get-VaultCredential.ps1' or filepath like '%\\Get-VulnAutoRun.ps1' or filepath like '%\\Get-VulnSchTask.ps1' or filepath like '%\\Get-WebConfig.ps1' or filepath like '%\\Get-WebCredentials.ps1' or filepath like '%\\Get-WLAN-Keys.ps1' or filepath like '%\\Gupt-Backdoor.ps1' or filepath like '%\\HTTP-Backdoor.ps1' or filepath like '%\\HTTP-Login.ps1' or filepath like '%\\Install-ServiceBinary.ps1' or filepath like '%\\Install-SSP.ps1' or filepath like '%\\Invoke-ACLScanner.ps1' or filepath like '%\\Invoke-ADSBackdoor.ps1' or filepath like '%\\Invoke-AmsiBypass.ps1' or filepath like '%\\Invoke-ARPScan.ps1' or filepath like '%\\Invoke-BackdoorLNK.ps1' or filepath like '%\\Invoke-BadPotato.ps1' or filepath like '%\\Invoke-BetterSafetyKatz.ps1' or filepath like '%\\Invoke-BruteForce.ps1' or filepath like '%\\Invoke-BypassUAC.ps1' or filepath like '%\\Invoke-Carbuncle.ps1' or filepath like '%\\Invoke-Certify.ps1' or filepath like '%\\Invoke-ConPtyShell.ps1' or filepath like '%\\Invoke-CredentialInjection.ps1' or filepath like '%\\Invoke-CredentialsPhish.ps1' or filepath like '%\\Invoke-DAFT.ps1' or filepath like '%\\Invoke-DCSync.ps1' or filepath like '%\\Invoke-Decode.ps1' or filepath like '%\\Invoke-DinvokeKatz.ps1' or filepath like '%\\Invoke-DllInjection.ps1' or filepath like '%\\Invoke-DNSUpdate.ps1' or filepath like '%\\Invoke-DowngradeAccount.ps1' or filepath like '%\\Invoke-EgressCheck.ps1' or filepath like '%\\Invoke-Encode.ps1' or filepath like '%\\Invoke-EventViewer.ps1' or filepath like '%\\Invoke-Eyewitness.ps1' or filepath like '%\\Invoke-FakeLogonScreen.ps1' or filepath like '%\\Invoke-Farmer.ps1' or filepath like '%\\Invoke-Get-RBCD-Threaded.ps1' or filepath like '%\\Invoke-Gopher.ps1' or filepath like '%\\Invoke-Grouper2.ps1' or filepath like '%\\Invoke-Grouper3.ps1' or filepath like '%\\Invoke-HandleKatz.ps1' or filepath like '%\\Invoke-Interceptor.ps1' or filepath like '%\\Invoke-Internalmonologue.ps1' or filepath like '%\\Invoke-Inveigh.ps1' or filepath like '%\\Invoke-InveighRelay.ps1' or filepath like '%\\Invoke-JSRatRegsvr.ps1' or filepath like '%\\Invoke-JSRatRundll.ps1' or filepath like '%\\Invoke-KrbRelay.ps1' or filepath like '%\\Invoke-KrbRelayUp.ps1' or filepath like '%\\Invoke-LdapSignCheck.ps1' or filepath like '%\\Invoke-Lockless.ps1' or filepath like '%\\Invoke-MalSCCM.ps1' or filepath like '%\\Invoke-Mimikatz.ps1' or filepath like '%\\Invoke-MimikatzWDigestDowngrade.ps1' or filepath like '%\\Invoke-Mimikittenz.ps1' or filepath like '%\\Invoke-MITM6.ps1' or filepath like '%\\Invoke-NanoDump.ps1' or filepath like '%\\Invoke-NetRipper.ps1' or filepath like '%\\Invoke-NetworkRelay.ps1' or filepath like '%\\Invoke-NinjaCopy.ps1' or filepath like '%\\Invoke-OxidResolver.ps1' or filepath like '%\\Invoke-P0wnedshell.ps1' or filepath like '%\\Invoke-P0wnedshellx86.ps1' or filepath like '%\\Invoke-Paranoia.ps1' or filepath like '%\\Invoke-PortScan.ps1' or filepath like '%\\Invoke-PoshRatHttp.ps1' or filepath like '%\\Invoke-PoshRatHttps.ps1' or filepath like '%\\Invoke-PostExfil.ps1' or filepath like '%\\Invoke-PowerDump.ps1' or filepath like '%\\Invoke-PowerShellIcmp.ps1' or filepath like '%\\Invoke-PowerShellTCP.ps1' or filepath like '%\\Invoke-PowerShellTcpOneLine.ps1' or filepath like '%\\Invoke-PowerShellTcpOneLineBind.ps1' or filepath like '%\\Invoke-PowerShellUdp.ps1' or filepath like '%\\Invoke-PowerShellUdpOneLine.ps1' or filepath like '%\\Invoke-PowerShellWMI.ps1' or filepath like '%\\Invoke-PowerThIEf.ps1' or filepath like '%\\Invoke-PPLDump.ps1' or filepath like '%\\Invoke-Prasadhak.ps1' or filepath like '%\\Invoke-PsExec.ps1' or filepath like '%\\Invoke-PsGcat.ps1' or filepath like '%\\Invoke-PsGcatAgent.ps1' or filepath like '%\\Invoke-PSInject.ps1' or filepath like '%\\Invoke-PsUaCme.ps1' or filepath like '%\\Invoke-ReflectivePEInjection.ps1' or filepath like '%\\Invoke-ReverseDNSLookup.ps1' or filepath like '%\\Invoke-Rubeus.ps1' or filepath like '%\\Invoke-RunAs.ps1' or filepath like '%\\Invoke-SafetyKatz.ps1' or filepath like '%\\Invoke-SauronEye.ps1' or filepath like '%\\Invoke-SCShell.ps1' or filepath like '%\\Invoke-Seatbelt.ps1' or filepath like '%\\Invoke-ServiceAbuse.ps1' or filepath like '%\\Invoke-SessionGopher.ps1' or filepath like '%\\Invoke-ShellCode.ps1' or filepath like '%\\Invoke-SMBScanner.ps1' or filepath like '%\\Invoke-Snaffler.ps1' or filepath like '%\\Invoke-Spoolsample.ps1' or filepath like '%\\Invoke-SSHCommand.ps1' or filepath like '%\\Invoke-SSIDExfil.ps1' or filepath like '%\\Invoke-StandIn.ps1' or filepath like '%\\Invoke-StickyNotesExtract.ps1' or filepath like '%\\Invoke-Tater.ps1' or filepath like '%\\Invoke-Thunderfox.ps1' or filepath like '%\\Invoke-ThunderStruck.ps1' or filepath like '%\\Invoke-TokenManipulation.ps1' or filepath like '%\\Invoke-Tokenvator.ps1' or filepath like '%\\Invoke-TotalExec.ps1' or filepath like '%\\Invoke-UrbanBishop.ps1' or filepath like '%\\Invoke-UserHunter.ps1' or filepath like '%\\Invoke-VoiceTroll.ps1' or filepath like '%\\Invoke-Whisker.ps1' or filepath like '%\\Invoke-WinEnum.ps1' or filepath like '%\\Invoke-winPEAS.ps1' or filepath like '%\\Invoke-WireTap.ps1' or filepath like '%\\Invoke-WmiCommand.ps1' or filepath like '%\\Invoke-WScriptBypassUAC.ps1' or filepath like '%\\Invoke-Zerologon.ps1' or filepath like '%\\Keylogger.ps1' or filepath like '%\\MailRaider.ps1' or filepath like '%\\New-HoneyHash.ps1' or filepath like '%\\OfficeMemScraper.ps1' or filepath like '%\\Offline_Winpwn.ps1' or filepath like '%\\Out-CHM.ps1' or filepath like '%\\Out-DnsTxt.ps1' or filepath like '%\\Out-Excel.ps1' or filepath like '%\\Out-HTA.ps1' or filepath like '%\\Out-Java.ps1' or filepath like '%\\Out-JS.ps1' or filepath like '%\\Out-Minidump.ps1' or filepath like '%\\Out-RundllCommand.ps1' or filepath like '%\\Out-SCF.ps1' or filepath like '%\\Out-SCT.ps1' or filepath like '%\\Out-Shortcut.ps1' or filepath like '%\\Out-WebQuery.ps1' or filepath like '%\\Out-Word.ps1' or filepath like '%\\Parse_Keys.ps1' or filepath like '%\\Port-Scan.ps1' or filepath like '%\\PowerBreach.ps1' or filepath like '%\\powercat.ps1' or filepath like '%\\Powermad.ps1' or filepath like '%\\PowerRunAsSystem.psm1' or filepath like '%\\PowerSharpPack.ps1' or filepath like '%\\PowerUp.ps1' or filepath like '%\\PowerUpSQL.ps1' or filepath like '%\\PowerView.ps1' or filepath like '%\\PSAsyncShell.ps1' or filepath like '%\\RemoteHashRetrieval.ps1' or filepath like '%\\Remove-Persistence.ps1' or filepath like '%\\Remove-PoshRat.ps1' or filepath like '%\\Remove-Update.ps1' or filepath like '%\\Run-EXEonRemote.ps1' or filepath like '%\\Schtasks-Backdoor.ps1' or filepath like '%\\Set-DCShadowPermissions.ps1' or filepath like '%\\Set-MacAttribute.ps1' or filepath like '%\\Set-RemotePSRemoting.ps1' or filepath like '%\\Set-RemoteWMI.ps1' or filepath like '%\\Set-Wallpaper.ps1' or filepath like '%\\Show-TargetScreen.ps1' or filepath like '%\\Speak.ps1' or filepath like '%\\Start-CaptureServer.ps1' or filepath like '%\\Start-WebcamRecorder.ps1' or filepath like '%\\StringToBase64.ps1' or filepath like '%\\TexttoExe.ps1' or filepath like '%\\VolumeShadowCopyTools.ps1' or filepath like '%\\WinPwn.ps1' or filepath like '%\\WSUSpendu.ps1') or (filepath like '%Invoke-Sharp%' and filepath like '%.ps1'))",
  "Tags": [
    "attack.execution",
    "attack.t1059.001"
  ],
  "Version": "0.1"
}