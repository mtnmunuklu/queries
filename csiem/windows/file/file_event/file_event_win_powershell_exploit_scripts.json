{
  "Description": "Detects the creation of known offensive powershell scripts used for exploitation\n\nAuthor: Markus Neis, Nasreddine Bencherchali (Nextron Systems), Mustafa Kaan Demir, Georg Lauenstein\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "f331aa1f-8c53-4fc3-b083-cc159bc971cb",
  "InsertDate": "2025-01-21T09:27:45Z",
  "LastUpdateDate": "2025-01-21T09:27:45Z",
  "Level": "high",
  "Name": "Malicious PowerShell Scripts - FileCreation",
  "Query": "sourcetype='windows-sysmon' eql select * from _source_ where ((filepath like '%\\add-constraineddelegationbackdoor.ps1' or filepath like '%\\add-exfiltration.ps1' or filepath like '%\\add-persistence.ps1' or filepath like '%\\add-regbackdoor.ps1' or filepath like '%\\add-remoteregbackdoor.ps1' or filepath like '%\\add-scrnsavebackdoor.ps1' or filepath like '%\\adrecon.ps1' or filepath like '%\\azureadrecon.ps1' or filepath like '%\\check-vm.ps1' or filepath like '%\\convertto-rot13.ps1' or filepath like '%\\copy-vss.ps1' or filepath like '%\\create-multiplesessions.ps1' or filepath like '%\\dns_txt_pwnage.ps1' or filepath like '%\\dnscat2.ps1' or filepath like '%\\do-exfiltration.ps1' or filepath like '%\\domainpasswordspray.ps1' or filepath like '%\\download_execute.ps1' or filepath like '%\\download-execute-ps.ps1' or filepath like '%\\enable-duplicatetoken.ps1' or filepath like '%\\enabled-duplicatetoken.ps1' or filepath like '%\\execute-command-mssql.ps1' or filepath like '%\\execute-dnstxt-code.ps1' or filepath like '%\\execute-ontime.ps1' or filepath like '%\\exetotext.ps1' or filepath like '%\\exploit-jboss.ps1' or filepath like '%\\find-avsignature.ps1' or filepath like '%\\find-fruit.ps1' or filepath like '%\\find-gpolocation.ps1' or filepath like '%\\find-trusteddocuments.ps1' or filepath like '%\\firebuster.ps1' or filepath like '%\\firelistener.ps1' or filepath like '%\\get-applicationhost.ps1' or filepath like '%\\get-chromedump.ps1' or filepath like '%\\get-clipboardcontents.ps1' or filepath like '%\\get-computerdetail.ps1' or filepath like '%\\get-foxdump.ps1' or filepath like '%\\get-gppautologon.ps1' or filepath like '%\\get-gpppassword.ps1' or filepath like '%\\get-indexeditem.ps1' or filepath like '%\\get-keystrokes.ps1' or filepath like '%\\get-lsasecret.ps1' or filepath like '%\\get-microphoneaudio.ps1' or filepath like '%\\get-passhashes.ps1' or filepath like '%\\get-passhints.ps1' or filepath like '%\\get-regalwaysinstallelevated.ps1' or filepath like '%\\get-regautologon.ps1' or filepath like '%\\get-rickastley.ps1' or filepath like '%\\get-screenshot.ps1' or filepath like '%\\get-securitypackages.ps1' or filepath like '%\\get-servicefilepermission.ps1' or filepath like '%\\get-servicepermission.ps1' or filepath like '%\\get-serviceunquoted.ps1' or filepath like '%\\get-sitelistpassword.ps1' or filepath like '%\\get-system.ps1' or filepath like '%\\get-timedscreenshot.ps1' or filepath like '%\\get-unattendedinstallfile.ps1' or filepath like '%\\get-unconstrained.ps1' or filepath like '%\\get-usbkeystrokes.ps1' or filepath like '%\\get-vaultcredential.ps1' or filepath like '%\\get-vulnautorun.ps1' or filepath like '%\\get-vulnschtask.ps1' or filepath like '%\\get-webconfig.ps1' or filepath like '%\\get-webcredentials.ps1' or filepath like '%\\get-wlan-keys.ps1' or filepath like '%\\gupt-backdoor.ps1' or filepath like '%\\http-backdoor.ps1' or filepath like '%\\http-login.ps1' or filepath like '%\\install-servicebinary.ps1' or filepath like '%\\install-ssp.ps1' or filepath like '%\\invoke-aclscanner.ps1' or filepath like '%\\invoke-adsbackdoor.ps1' or filepath like '%\\invoke-amsibypass.ps1' or filepath like '%\\invoke-arpscan.ps1' or filepath like '%\\invoke-backdoorlnk.ps1' or filepath like '%\\invoke-badpotato.ps1' or filepath like '%\\invoke-bettersafetykatz.ps1' or filepath like '%\\invoke-bruteforce.ps1' or filepath like '%\\invoke-bypassuac.ps1' or filepath like '%\\invoke-carbuncle.ps1' or filepath like '%\\invoke-certify.ps1' or filepath like '%\\invoke-conptyshell.ps1' or filepath like '%\\invoke-credentialinjection.ps1' or filepath like '%\\invoke-credentialsphish.ps1' or filepath like '%\\invoke-daft.ps1' or filepath like '%\\invoke-dcsync.ps1' or filepath like '%\\invoke-decode.ps1' or filepath like '%\\invoke-dinvokekatz.ps1' or filepath like '%\\invoke-dllinjection.ps1' or filepath like '%\\invoke-dnsupdate.ps1' or filepath like '%\\invoke-downgradeaccount.ps1' or filepath like '%\\invoke-egresscheck.ps1' or filepath like '%\\invoke-encode.ps1' or filepath like '%\\invoke-eventviewer.ps1' or filepath like '%\\invoke-eyewitness.ps1' or filepath like '%\\invoke-fakelogonscreen.ps1' or filepath like '%\\invoke-farmer.ps1' or filepath like '%\\invoke-get-rbcd-threaded.ps1' or filepath like '%\\invoke-gopher.ps1' or filepath like '%\\invoke-grouper2.ps1' or filepath like '%\\invoke-grouper3.ps1' or filepath like '%\\invoke-handlekatz.ps1' or filepath like '%\\invoke-interceptor.ps1' or filepath like '%\\invoke-internalmonologue.ps1' or filepath like '%\\invoke-inveigh.ps1' or filepath like '%\\invoke-inveighrelay.ps1' or filepath like '%\\invoke-jsratregsvr.ps1' or filepath like '%\\invoke-jsratrundll.ps1' or filepath like '%\\invoke-krbrelay.ps1' or filepath like '%\\invoke-krbrelayup.ps1' or filepath like '%\\invoke-ldapsigncheck.ps1' or filepath like '%\\invoke-lockless.ps1' or filepath like '%\\invoke-malsccm.ps1' or filepath like '%\\invoke-mimikatz.ps1' or filepath like '%\\invoke-mimikatzwdigestdowngrade.ps1' or filepath like '%\\invoke-mimikittenz.ps1' or filepath like '%\\invoke-mitm6.ps1' or filepath like '%\\invoke-nanodump.ps1' or filepath like '%\\invoke-netripper.ps1' or filepath like '%\\invoke-networkrelay.ps1' or filepath like '%\\invoke-ninjacopy.ps1' or filepath like '%\\invoke-oxidresolver.ps1' or filepath like '%\\invoke-p0wnedshell.ps1' or filepath like '%\\invoke-p0wnedshellx86.ps1' or filepath like '%\\invoke-paranoia.ps1' or filepath like '%\\invoke-portscan.ps1' or filepath like '%\\invoke-poshrathttp.ps1' or filepath like '%\\invoke-poshrathttps.ps1' or filepath like '%\\invoke-postexfil.ps1' or filepath like '%\\invoke-powerdump.ps1' or filepath like '%\\invoke-powershellicmp.ps1' or filepath like '%\\invoke-powershelltcp.ps1' or filepath like '%\\invoke-powershelltcponeline.ps1' or filepath like '%\\invoke-powershelltcponelinebind.ps1' or filepath like '%\\invoke-powershelludp.ps1' or filepath like '%\\invoke-powershelludponeline.ps1' or filepath like '%\\invoke-powershellwmi.ps1' or filepath like '%\\invoke-powerthief.ps1' or filepath like '%\\invoke-ppldump.ps1' or filepath like '%\\invoke-prasadhak.ps1' or filepath like '%\\invoke-psexec.ps1' or filepath like '%\\invoke-psgcat.ps1' or filepath like '%\\invoke-psgcatagent.ps1' or filepath like '%\\invoke-psinject.ps1' or filepath like '%\\invoke-psuacme.ps1' or filepath like '%\\invoke-reflectivepeinjection.ps1' or filepath like '%\\invoke-reversednslookup.ps1' or filepath like '%\\invoke-rubeus.ps1' or filepath like '%\\invoke-runas.ps1' or filepath like '%\\invoke-safetykatz.ps1' or filepath like '%\\invoke-sauroneye.ps1' or filepath like '%\\invoke-scshell.ps1' or filepath like '%\\invoke-seatbelt.ps1' or filepath like '%\\invoke-serviceabuse.ps1' or filepath like '%\\invoke-sessiongopher.ps1' or filepath like '%\\invoke-shellcode.ps1' or filepath like '%\\invoke-smbscanner.ps1' or filepath like '%\\invoke-snaffler.ps1' or filepath like '%\\invoke-spoolsample.ps1' or filepath like '%\\invoke-sshcommand.ps1' or filepath like '%\\invoke-ssidexfil.ps1' or filepath like '%\\invoke-standin.ps1' or filepath like '%\\invoke-stickynotesextract.ps1' or filepath like '%\\invoke-tater.ps1' or filepath like '%\\invoke-thunderfox.ps1' or filepath like '%\\invoke-thunderstruck.ps1' or filepath like '%\\invoke-tokenmanipulation.ps1' or filepath like '%\\invoke-tokenvator.ps1' or filepath like '%\\invoke-totalexec.ps1' or filepath like '%\\invoke-urbanbishop.ps1' or filepath like '%\\invoke-userhunter.ps1' or filepath like '%\\invoke-voicetroll.ps1' or filepath like '%\\invoke-whisker.ps1' or filepath like '%\\invoke-winenum.ps1' or filepath like '%\\invoke-winpeas.ps1' or filepath like '%\\invoke-wiretap.ps1' or filepath like '%\\invoke-wmicommand.ps1' or filepath like '%\\invoke-wscriptbypassuac.ps1' or filepath like '%\\invoke-zerologon.ps1' or filepath like '%\\keylogger.ps1' or filepath like '%\\mailraider.ps1' or filepath like '%\\new-honeyhash.ps1' or filepath like '%\\officememscraper.ps1' or filepath like '%\\offline_winpwn.ps1' or filepath like '%\\out-chm.ps1' or filepath like '%\\out-dnstxt.ps1' or filepath like '%\\out-excel.ps1' or filepath like '%\\out-hta.ps1' or filepath like '%\\out-java.ps1' or filepath like '%\\out-js.ps1' or filepath like '%\\out-minidump.ps1' or filepath like '%\\out-rundllcommand.ps1' or filepath like '%\\out-scf.ps1' or filepath like '%\\out-sct.ps1' or filepath like '%\\out-shortcut.ps1' or filepath like '%\\out-webquery.ps1' or filepath like '%\\out-word.ps1' or filepath like '%\\parse_keys.ps1' or filepath like '%\\port-scan.ps1' or filepath like '%\\powerbreach.ps1' or filepath like '%\\powercat.ps1' or filepath like '%\\powermad.ps1' or filepath like '%\\powerrunassystem.psm1' or filepath like '%\\powersharppack.ps1' or filepath like '%\\powerup.ps1' or filepath like '%\\powerupsql.ps1' or filepath like '%\\powerview.ps1' or filepath like '%\\psasyncshell.ps1' or filepath like '%\\remotehashretrieval.ps1' or filepath like '%\\remove-persistence.ps1' or filepath like '%\\remove-poshrat.ps1' or filepath like '%\\remove-update.ps1' or filepath like '%\\run-exeonremote.ps1' or filepath like '%\\schtasks-backdoor.ps1' or filepath like '%\\set-dcshadowpermissions.ps1' or filepath like '%\\set-macattribute.ps1' or filepath like '%\\set-remotepsremoting.ps1' or filepath like '%\\set-remotewmi.ps1' or filepath like '%\\set-wallpaper.ps1' or filepath like '%\\show-targetscreen.ps1' or filepath like '%\\speak.ps1' or filepath like '%\\start-captureserver.ps1' or filepath like '%\\start-webcamrecorder.ps1' or filepath like '%\\stringtobase64.ps1' or filepath like '%\\texttoexe.ps1' or filepath like '%\\volumeshadowcopytools.ps1' or filepath like '%\\winpwn.ps1' or filepath like '%\\wsuspendu.ps1') or (filepath like '%invoke-sharp%' and filepath like '%.ps1'))",
  "Tags": [
    "attack.execution",
    "attack.t1059.001"
  ],
  "Version": "0.1"
}