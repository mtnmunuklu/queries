{
  "Description": "Detects the creation of an executable with a system process name in folders other than the system ones (System32, SysWOW64, etc.).\nIt is highly recommended to perform an initial baseline before using this rule in production.\n\n\nAuthor: Sander Wiebing, Tim Shelton, Nasreddine Bencherchali (Nextron Systems)\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "d5866ddf-ce8f-4aea-b28e-d96485a20d3d",
  "InsertDate": "2025-01-25T21:20:53Z",
  "LastUpdateDate": "2025-01-25T21:20:53Z",
  "Level": "medium",
  "Name": "Files With System Process Name In Unsuspected Locations",
  "Query": "sourcetype='windows-sysmon' eql select * from _source_ where ((filepath like '%\\AtBroker.exe' or filepath like '%\\audiodg.exe' or filepath like '%\\backgroundTaskHost.exe' or filepath like '%\\bcdedit.exe' or filepath like '%\\bitsadmin.exe' or filepath like '%\\cmdl32.exe' or filepath like '%\\cmstp.exe' or filepath like '%\\conhost.exe' or filepath like '%\\csrss.exe' or filepath like '%\\dasHost.exe' or filepath like '%\\dfrgui.exe' or filepath like '%\\dllhost.exe' or filepath like '%\\dwm.exe' or filepath like '%\\eventcreate.exe' or filepath like '%\\eventvwr.exe' or filepath like '%\\explorer.exe' or filepath like '%\\extrac32.exe' or filepath like '%\\fontdrvhost.exe' or filepath like '%\\ipconfig.exe' or filepath like '%\\iscsicli.exe' or filepath like '%\\iscsicpl.exe' or filepath like '%\\logman.exe' or filepath like '%\\LogonUI.exe' or filepath like '%\\LsaIso.exe' or filepath like '%\\lsass.exe' or filepath like '%\\lsm.exe' or filepath like '%\\msiexec.exe' or filepath like '%\\msinfo32.exe' or filepath like '%\\mstsc.exe' or filepath like '%\\nbtstat.exe' or filepath like '%\\odbcconf.exe' or filepath like '%\\powershell.exe' or filepath like '%\\pwsh.exe' or filepath like '%\\regini.exe' or filepath like '%\\regsvr32.exe' or filepath like '%\\rundll32.exe' or filepath like '%\\RuntimeBroker.exe' or filepath like '%\\schtasks.exe' or filepath like '%\\SearchFilterHost.exe' or filepath like '%\\SearchIndexer.exe' or filepath like '%\\SearchProtocolHost.exe' or filepath like '%\\SecurityHealthService.exe' or filepath like '%\\SecurityHealthSystray.exe' or filepath like '%\\services.exe' or filepath like '%\\ShellAppRuntime.exe' or filepath like '%\\sihost.exe' or filepath like '%\\smartscreen.exe' or filepath like '%\\smss.exe' or filepath like '%\\spoolsv.exe' or filepath like '%\\svchost.exe' or filepath like '%\\SystemSettingsBroker.exe' or filepath like '%\\taskhost.exe' or filepath like '%\\taskhostw.exe' or filepath like '%\\Taskmgr.exe' or filepath like '%\\TiWorker.exe' or filepath like '%\\vssadmin.exe' or filepath like '%\\w32tm.exe' or filepath like '%\\WerFault.exe' or filepath like '%\\WerFaultSecure.exe' or filepath like '%\\wermgr.exe' or filepath like '%\\wevtutil.exe' or filepath like '%\\wininit.exe' or filepath like '%\\winlogon.exe' or filepath like '%\\winrshost.exe' or filepath like '%\\WinRTNetMUAHostServer.exe' or filepath like '%\\wlanext.exe' or filepath like '%\\wlrmdr.exe' or filepath like '%\\WmiPrvSE.exe' or filepath like '%\\wslhost.exe' or filepath like '%\\WSReset.exe' or filepath like '%\\WUDFHost.exe' or filepath like '%\\WWAHost.exe') and  not ((filepath like '%C:\\$WINDOWS.~BT\\%' or filepath like '%C:\\$WinREAgent\\%' or filepath like '%C:\\Windows\\SoftwareDistribution\\%' or filepath like '%C:\\Windows\\System32\\%' or filepath like '%C:\\Windows\\SysWOW64\\%' or filepath like '%C:\\Windows\\WinSxS\\%' or filepath like '%C:\\Windows\\uus\\%') or (process_path like '%C:\\Windows\\system32\\svchost.exe' and filepath like '%C:\\Program Files\\WindowsApps\\%') or process_path like '%C:\\Windows\\System32\\wuauclt.exe' or filepath like '%C:\\Windows\\explorer.exe' or (process_path like '%C:\\WINDOWS\\system32\\msiexec.exe' and (filepath like '%C:\\Program Files\\PowerShell\\7\\pwsh.exe' or filepath like '%C:\\Program Files\\PowerShell\\7-preview\\pwsh.exe')) or (filepath like '%C:\\Windows\\System32\\SecurityHealth\\%' and filepath like '%\\SecurityHealthSystray.exe' and process_path like '%\\SecurityHealthSetup.exe')))",
  "Tags": [
    "attack.defense-evasion",
    "attack.t1036.005"
  ],
  "Version": "0.1"
}