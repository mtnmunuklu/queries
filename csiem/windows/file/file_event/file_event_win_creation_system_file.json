{
  "Description": "Detects the creation of an executable with a system process name in folders other than the system ones (System32, SysWOW64, etc.).\nIt is highly recommended to perform an initial baseline before using this rule in production.\n\n\nAuthor: Sander Wiebing, Tim Shelton, Nasreddine Bencherchali (Nextron Systems)\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "d5866ddf-ce8f-4aea-b28e-d96485a20d3d",
  "InsertDate": "2025-01-19T11:33:59Z",
  "LastUpdateDate": "2025-01-19T11:33:59Z",
  "Level": "medium",
  "Name": "Files With System Process Name In Unsuspected Locations",
  "Query": "sourcetype='windows-sysmon' eql select * from _source_ where ((filepath like '%\\atbroker.exe' or filepath like '%\\audiodg.exe' or filepath like '%\\backgroundtaskhost.exe' or filepath like '%\\bcdedit.exe' or filepath like '%\\bitsadmin.exe' or filepath like '%\\cmdl32.exe' or filepath like '%\\cmstp.exe' or filepath like '%\\conhost.exe' or filepath like '%\\csrss.exe' or filepath like '%\\dashost.exe' or filepath like '%\\dfrgui.exe' or filepath like '%\\dllhost.exe' or filepath like '%\\dwm.exe' or filepath like '%\\eventcreate.exe' or filepath like '%\\eventvwr.exe' or filepath like '%\\explorer.exe' or filepath like '%\\extrac32.exe' or filepath like '%\\fontdrvhost.exe' or filepath like '%\\ipconfig.exe' or filepath like '%\\iscsicli.exe' or filepath like '%\\iscsicpl.exe' or filepath like '%\\logman.exe' or filepath like '%\\logonui.exe' or filepath like '%\\lsaiso.exe' or filepath like '%\\lsass.exe' or filepath like '%\\lsm.exe' or filepath like '%\\msiexec.exe' or filepath like '%\\msinfo32.exe' or filepath like '%\\mstsc.exe' or filepath like '%\\nbtstat.exe' or filepath like '%\\odbcconf.exe' or filepath like '%\\powershell.exe' or filepath like '%\\pwsh.exe' or filepath like '%\\regini.exe' or filepath like '%\\regsvr32.exe' or filepath like '%\\rundll32.exe' or filepath like '%\\runtimebroker.exe' or filepath like '%\\schtasks.exe' or filepath like '%\\searchfilterhost.exe' or filepath like '%\\searchindexer.exe' or filepath like '%\\searchprotocolhost.exe' or filepath like '%\\securityhealthservice.exe' or filepath like '%\\securityhealthsystray.exe' or filepath like '%\\services.exe' or filepath like '%\\shellappruntime.exe' or filepath like '%\\sihost.exe' or filepath like '%\\smartscreen.exe' or filepath like '%\\smss.exe' or filepath like '%\\spoolsv.exe' or filepath like '%\\svchost.exe' or filepath like '%\\systemsettingsbroker.exe' or filepath like '%\\taskhost.exe' or filepath like '%\\taskhostw.exe' or filepath like '%\\taskmgr.exe' or filepath like '%\\tiworker.exe' or filepath like '%\\vssadmin.exe' or filepath like '%\\w32tm.exe' or filepath like '%\\werfault.exe' or filepath like '%\\werfaultsecure.exe' or filepath like '%\\wermgr.exe' or filepath like '%\\wevtutil.exe' or filepath like '%\\wininit.exe' or filepath like '%\\winlogon.exe' or filepath like '%\\winrshost.exe' or filepath like '%\\winrtnetmuahostserver.exe' or filepath like '%\\wlanext.exe' or filepath like '%\\wlrmdr.exe' or filepath like '%\\wmiprvse.exe' or filepath like '%\\wslhost.exe' or filepath like '%\\wsreset.exe' or filepath like '%\\wudfhost.exe' or filepath like '%\\wwahost.exe') and  not ((filepath like '%c:\\$windows.~bt\\%' or filepath like '%c:\\$winreagent\\%' or filepath like '%c:\\windows\\softwaredistribution\\%' or filepath like '%c:\\windows\\system32\\%' or filepath like '%c:\\windows\\syswow64\\%' or filepath like '%c:\\windows\\winsxs\\%' or filepath like '%c:\\windows\\uus\\%') or (process_path like '%c:\\windows\\system32\\svchost.exe' and filepath like '%c:\\program files\\windowsapps\\%') or process_path like '%c:\\windows\\system32\\wuauclt.exe' or filepath like '%c:\\windows\\explorer.exe' or (process_path like '%c:\\windows\\system32\\msiexec.exe' and (filepath like '%c:\\program files\\powershell\\7\\pwsh.exe' or filepath like '%c:\\program files\\powershell\\7-preview\\pwsh.exe')) or (filepath like '%c:\\windows\\system32\\securityhealth\\%' and filepath like '%\\securityhealthsystray.exe' and process_path like '%\\securityhealthsetup.exe')))",
  "Tags": [
    "attack.defense-evasion",
    "attack.t1036.005"
  ],
  "Version": "0.1"
}