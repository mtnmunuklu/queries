{
  "Description": "Detects the creation of known offensive powershell scripts used for exploitation\n\nAuthor: Markus Neis, Nasreddine Bencherchali (Nextron Systems), Mustafa Kaan Demir, Georg Lauenstein\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "f331aa1f-8c53-4fc3-b083-cc159bc971cb",
  "InsertDate": "2025-02-03T20:32:19Z",
  "LastUpdateDate": "2025-02-03T20:32:19Z",
  "Level": "high",
  "Name": "Malicious PowerShell Scripts - FileCreation",
  "Query": "sourcetype=\"windows-sysmon\" (filepath=\"*\\\\Add-ConstrainedDelegationBackdoor.ps1\" OR filepath=\"*\\\\Add-Exfiltration.ps1\" OR filepath=\"*\\\\Add-Persistence.ps1\" OR filepath=\"*\\\\Add-RegBackdoor.ps1\" OR filepath=\"*\\\\Add-RemoteRegBackdoor.ps1\" OR filepath=\"*\\\\Add-ScrnSaveBackdoor.ps1\" OR filepath=\"*\\\\ADRecon.ps1\" OR filepath=\"*\\\\AzureADRecon.ps1\" OR filepath=\"*\\\\Check-VM.ps1\" OR filepath=\"*\\\\ConvertTo-ROT13.ps1\" OR filepath=\"*\\\\Copy-VSS.ps1\" OR filepath=\"*\\\\Create-MultipleSessions.ps1\" OR filepath=\"*\\\\DNS_TXT_Pwnage.ps1\" OR filepath=\"*\\\\dnscat2.ps1\" OR filepath=\"*\\\\Do-Exfiltration.ps1\" OR filepath=\"*\\\\DomainPasswordSpray.ps1\" OR filepath=\"*\\\\Download_Execute.ps1\" OR filepath=\"*\\\\Download-Execute-PS.ps1\" OR filepath=\"*\\\\Enable-DuplicateToken.ps1\" OR filepath=\"*\\\\Enabled-DuplicateToken.ps1\" OR filepath=\"*\\\\Execute-Command-MSSQL.ps1\" OR filepath=\"*\\\\Execute-DNSTXT-Code.ps1\" OR filepath=\"*\\\\Execute-OnTime.ps1\" OR filepath=\"*\\\\ExetoText.ps1\" OR filepath=\"*\\\\Exploit-Jboss.ps1\" OR filepath=\"*\\\\Find-AVSignature.ps1\" OR filepath=\"*\\\\Find-Fruit.ps1\" OR filepath=\"*\\\\Find-GPOLocation.ps1\" OR filepath=\"*\\\\Find-TrustedDocuments.ps1\" OR filepath=\"*\\\\FireBuster.ps1\" OR filepath=\"*\\\\FireListener.ps1\" OR filepath=\"*\\\\Get-ApplicationHost.ps1\" OR filepath=\"*\\\\Get-ChromeDump.ps1\" OR filepath=\"*\\\\Get-ClipboardContents.ps1\" OR filepath=\"*\\\\Get-ComputerDetail.ps1\" OR filepath=\"*\\\\Get-FoxDump.ps1\" OR filepath=\"*\\\\Get-GPPAutologon.ps1\" OR filepath=\"*\\\\Get-GPPPassword.ps1\" OR filepath=\"*\\\\Get-IndexedItem.ps1\" OR filepath=\"*\\\\Get-Keystrokes.ps1\" OR filepath=\"*\\\\Get-LSASecret.ps1\" OR filepath=\"*\\\\Get-MicrophoneAudio.ps1\" OR filepath=\"*\\\\Get-PassHashes.ps1\" OR filepath=\"*\\\\Get-PassHints.ps1\" OR filepath=\"*\\\\Get-RegAlwaysInstallElevated.ps1\" OR filepath=\"*\\\\Get-RegAutoLogon.ps1\" OR filepath=\"*\\\\Get-RickAstley.ps1\" OR filepath=\"*\\\\Get-Screenshot.ps1\" OR filepath=\"*\\\\Get-SecurityPackages.ps1\" OR filepath=\"*\\\\Get-ServiceFilePermission.ps1\" OR filepath=\"*\\\\Get-ServicePermission.ps1\" OR filepath=\"*\\\\Get-ServiceUnquoted.ps1\" OR filepath=\"*\\\\Get-SiteListPassword.ps1\" OR filepath=\"*\\\\Get-System.ps1\" OR filepath=\"*\\\\Get-TimedScreenshot.ps1\" OR filepath=\"*\\\\Get-UnattendedInstallFile.ps1\" OR filepath=\"*\\\\Get-Unconstrained.ps1\" OR filepath=\"*\\\\Get-USBKeystrokes.ps1\" OR filepath=\"*\\\\Get-VaultCredential.ps1\" OR filepath=\"*\\\\Get-VulnAutoRun.ps1\" OR filepath=\"*\\\\Get-VulnSchTask.ps1\" OR filepath=\"*\\\\Get-WebConfig.ps1\" OR filepath=\"*\\\\Get-WebCredentials.ps1\" OR filepath=\"*\\\\Get-WLAN-Keys.ps1\" OR filepath=\"*\\\\Gupt-Backdoor.ps1\" OR filepath=\"*\\\\HTTP-Backdoor.ps1\" OR filepath=\"*\\\\HTTP-Login.ps1\" OR filepath=\"*\\\\Install-ServiceBinary.ps1\" OR filepath=\"*\\\\Install-SSP.ps1\" OR filepath=\"*\\\\Invoke-ACLScanner.ps1\" OR filepath=\"*\\\\Invoke-ADSBackdoor.ps1\" OR filepath=\"*\\\\Invoke-AmsiBypass.ps1\" OR filepath=\"*\\\\Invoke-ARPScan.ps1\" OR filepath=\"*\\\\Invoke-BackdoorLNK.ps1\" OR filepath=\"*\\\\Invoke-BadPotato.ps1\" OR filepath=\"*\\\\Invoke-BetterSafetyKatz.ps1\" OR filepath=\"*\\\\Invoke-BruteForce.ps1\" OR filepath=\"*\\\\Invoke-BypassUAC.ps1\" OR filepath=\"*\\\\Invoke-Carbuncle.ps1\" OR filepath=\"*\\\\Invoke-Certify.ps1\" OR filepath=\"*\\\\Invoke-ConPtyShell.ps1\" OR filepath=\"*\\\\Invoke-CredentialInjection.ps1\" OR filepath=\"*\\\\Invoke-CredentialsPhish.ps1\" OR filepath=\"*\\\\Invoke-DAFT.ps1\" OR filepath=\"*\\\\Invoke-DCSync.ps1\" OR filepath=\"*\\\\Invoke-Decode.ps1\" OR filepath=\"*\\\\Invoke-DinvokeKatz.ps1\" OR filepath=\"*\\\\Invoke-DllInjection.ps1\" OR filepath=\"*\\\\Invoke-DNSUpdate.ps1\" OR filepath=\"*\\\\Invoke-DowngradeAccount.ps1\" OR filepath=\"*\\\\Invoke-EgressCheck.ps1\" OR filepath=\"*\\\\Invoke-Encode.ps1\" OR filepath=\"*\\\\Invoke-EventViewer.ps1\" OR filepath=\"*\\\\Invoke-Eyewitness.ps1\" OR filepath=\"*\\\\Invoke-FakeLogonScreen.ps1\" OR filepath=\"*\\\\Invoke-Farmer.ps1\" OR filepath=\"*\\\\Invoke-Get-RBCD-Threaded.ps1\" OR filepath=\"*\\\\Invoke-Gopher.ps1\" OR filepath=\"*\\\\Invoke-Grouper2.ps1\" OR filepath=\"*\\\\Invoke-Grouper3.ps1\" OR filepath=\"*\\\\Invoke-HandleKatz.ps1\" OR filepath=\"*\\\\Invoke-Interceptor.ps1\" OR filepath=\"*\\\\Invoke-Internalmonologue.ps1\" OR filepath=\"*\\\\Invoke-Inveigh.ps1\" OR filepath=\"*\\\\Invoke-InveighRelay.ps1\" OR filepath=\"*\\\\Invoke-JSRatRegsvr.ps1\" OR filepath=\"*\\\\Invoke-JSRatRundll.ps1\" OR filepath=\"*\\\\Invoke-KrbRelay.ps1\" OR filepath=\"*\\\\Invoke-KrbRelayUp.ps1\" OR filepath=\"*\\\\Invoke-LdapSignCheck.ps1\" OR filepath=\"*\\\\Invoke-Lockless.ps1\" OR filepath=\"*\\\\Invoke-MalSCCM.ps1\" OR filepath=\"*\\\\Invoke-Mimikatz.ps1\" OR filepath=\"*\\\\Invoke-MimikatzWDigestDowngrade.ps1\" OR filepath=\"*\\\\Invoke-Mimikittenz.ps1\" OR filepath=\"*\\\\Invoke-MITM6.ps1\" OR filepath=\"*\\\\Invoke-NanoDump.ps1\" OR filepath=\"*\\\\Invoke-NetRipper.ps1\" OR filepath=\"*\\\\Invoke-NetworkRelay.ps1\" OR filepath=\"*\\\\Invoke-NinjaCopy.ps1\" OR filepath=\"*\\\\Invoke-OxidResolver.ps1\" OR filepath=\"*\\\\Invoke-P0wnedshell.ps1\" OR filepath=\"*\\\\Invoke-P0wnedshellx86.ps1\" OR filepath=\"*\\\\Invoke-Paranoia.ps1\" OR filepath=\"*\\\\Invoke-PortScan.ps1\" OR filepath=\"*\\\\Invoke-PoshRatHttp.ps1\" OR filepath=\"*\\\\Invoke-PoshRatHttps.ps1\" OR filepath=\"*\\\\Invoke-PostExfil.ps1\" OR filepath=\"*\\\\Invoke-PowerDump.ps1\" OR filepath=\"*\\\\Invoke-PowerShellIcmp.ps1\" OR filepath=\"*\\\\Invoke-PowerShellTCP.ps1\" OR filepath=\"*\\\\Invoke-PowerShellTcpOneLine.ps1\" OR filepath=\"*\\\\Invoke-PowerShellTcpOneLineBind.ps1\" OR filepath=\"*\\\\Invoke-PowerShellUdp.ps1\" OR filepath=\"*\\\\Invoke-PowerShellUdpOneLine.ps1\" OR filepath=\"*\\\\Invoke-PowerShellWMI.ps1\" OR filepath=\"*\\\\Invoke-PowerThIEf.ps1\" OR filepath=\"*\\\\Invoke-PPLDump.ps1\" OR filepath=\"*\\\\Invoke-Prasadhak.ps1\" OR filepath=\"*\\\\Invoke-PsExec.ps1\" OR filepath=\"*\\\\Invoke-PsGcat.ps1\" OR filepath=\"*\\\\Invoke-PsGcatAgent.ps1\" OR filepath=\"*\\\\Invoke-PSInject.ps1\" OR filepath=\"*\\\\Invoke-PsUaCme.ps1\" OR filepath=\"*\\\\Invoke-ReflectivePEInjection.ps1\" OR filepath=\"*\\\\Invoke-ReverseDNSLookup.ps1\" OR filepath=\"*\\\\Invoke-Rubeus.ps1\" OR filepath=\"*\\\\Invoke-RunAs.ps1\" OR filepath=\"*\\\\Invoke-SafetyKatz.ps1\" OR filepath=\"*\\\\Invoke-SauronEye.ps1\" OR filepath=\"*\\\\Invoke-SCShell.ps1\" OR filepath=\"*\\\\Invoke-Seatbelt.ps1\" OR filepath=\"*\\\\Invoke-ServiceAbuse.ps1\" OR filepath=\"*\\\\Invoke-SessionGopher.ps1\" OR filepath=\"*\\\\Invoke-ShellCode.ps1\" OR filepath=\"*\\\\Invoke-SMBScanner.ps1\" OR filepath=\"*\\\\Invoke-Snaffler.ps1\" OR filepath=\"*\\\\Invoke-Spoolsample.ps1\" OR filepath=\"*\\\\Invoke-SSHCommand.ps1\" OR filepath=\"*\\\\Invoke-SSIDExfil.ps1\" OR filepath=\"*\\\\Invoke-StandIn.ps1\" OR filepath=\"*\\\\Invoke-StickyNotesExtract.ps1\" OR filepath=\"*\\\\Invoke-Tater.ps1\" OR filepath=\"*\\\\Invoke-Thunderfox.ps1\" OR filepath=\"*\\\\Invoke-ThunderStruck.ps1\" OR filepath=\"*\\\\Invoke-TokenManipulation.ps1\" OR filepath=\"*\\\\Invoke-Tokenvator.ps1\" OR filepath=\"*\\\\Invoke-TotalExec.ps1\" OR filepath=\"*\\\\Invoke-UrbanBishop.ps1\" OR filepath=\"*\\\\Invoke-UserHunter.ps1\" OR filepath=\"*\\\\Invoke-VoiceTroll.ps1\" OR filepath=\"*\\\\Invoke-Whisker.ps1\" OR filepath=\"*\\\\Invoke-WinEnum.ps1\" OR filepath=\"*\\\\Invoke-winPEAS.ps1\" OR filepath=\"*\\\\Invoke-WireTap.ps1\" OR filepath=\"*\\\\Invoke-WmiCommand.ps1\" OR filepath=\"*\\\\Invoke-WScriptBypassUAC.ps1\" OR filepath=\"*\\\\Invoke-Zerologon.ps1\" OR filepath=\"*\\\\Keylogger.ps1\" OR filepath=\"*\\\\MailRaider.ps1\" OR filepath=\"*\\\\New-HoneyHash.ps1\" OR filepath=\"*\\\\OfficeMemScraper.ps1\" OR filepath=\"*\\\\Offline_Winpwn.ps1\" OR filepath=\"*\\\\Out-CHM.ps1\" OR filepath=\"*\\\\Out-DnsTxt.ps1\" OR filepath=\"*\\\\Out-Excel.ps1\" OR filepath=\"*\\\\Out-HTA.ps1\" OR filepath=\"*\\\\Out-Java.ps1\" OR filepath=\"*\\\\Out-JS.ps1\" OR filepath=\"*\\\\Out-Minidump.ps1\" OR filepath=\"*\\\\Out-RundllCommand.ps1\" OR filepath=\"*\\\\Out-SCF.ps1\" OR filepath=\"*\\\\Out-SCT.ps1\" OR filepath=\"*\\\\Out-Shortcut.ps1\" OR filepath=\"*\\\\Out-WebQuery.ps1\" OR filepath=\"*\\\\Out-Word.ps1\" OR filepath=\"*\\\\Parse_Keys.ps1\" OR filepath=\"*\\\\Port-Scan.ps1\" OR filepath=\"*\\\\PowerBreach.ps1\" OR filepath=\"*\\\\powercat.ps1\" OR filepath=\"*\\\\Powermad.ps1\" OR filepath=\"*\\\\PowerRunAsSystem.psm1\" OR filepath=\"*\\\\PowerSharpPack.ps1\" OR filepath=\"*\\\\PowerUp.ps1\" OR filepath=\"*\\\\PowerUpSQL.ps1\" OR filepath=\"*\\\\PowerView.ps1\" OR filepath=\"*\\\\PSAsyncShell.ps1\" OR filepath=\"*\\\\RemoteHashRetrieval.ps1\" OR filepath=\"*\\\\Remove-Persistence.ps1\" OR filepath=\"*\\\\Remove-PoshRat.ps1\" OR filepath=\"*\\\\Remove-Update.ps1\" OR filepath=\"*\\\\Run-EXEonRemote.ps1\" OR filepath=\"*\\\\Schtasks-Backdoor.ps1\" OR filepath=\"*\\\\Set-DCShadowPermissions.ps1\" OR filepath=\"*\\\\Set-MacAttribute.ps1\" OR filepath=\"*\\\\Set-RemotePSRemoting.ps1\" OR filepath=\"*\\\\Set-RemoteWMI.ps1\" OR filepath=\"*\\\\Set-Wallpaper.ps1\" OR filepath=\"*\\\\Show-TargetScreen.ps1\" OR filepath=\"*\\\\Speak.ps1\" OR filepath=\"*\\\\Start-CaptureServer.ps1\" OR filepath=\"*\\\\Start-WebcamRecorder.ps1\" OR filepath=\"*\\\\StringToBase64.ps1\" OR filepath=\"*\\\\TexttoExe.ps1\" OR filepath=\"*\\\\VolumeShadowCopyTools.ps1\" OR filepath=\"*\\\\WinPwn.ps1\" OR filepath=\"*\\\\WSUSpendu.ps1\") OR (filepath=\"*Invoke-Sharp*\" filepath=\"*.ps1\")",
  "Tags": [
    "attack.execution",
    "attack.t1059.001"
  ],
  "Version": "0.1"
}