{
  "Description": "Detects loading of essential DLLs used by PowerShell by non-PowerShell process.\nDetects behavior similar to meterpreter's \"load powershell\" extension.\n\n\nAuthor: Tom Kern, oscd.community, Natalia Shornikova, Tim Shelton, Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "092bc4b9-3d1d-43b4-a6b4-8c8acd83522f",
  "InsertDate": "2025-02-03T20:32:21Z",
  "LastUpdateDate": "2025-02-03T20:32:21Z",
  "Level": "medium",
  "Name": "PowerShell Core DLL Loaded By Non PowerShell Process",
  "Query": "sourcetype=\"windows-sysmon\" (description=\"System.Management.Automation\" original_file_name=\"System.Management.Automation.dll\" (image_loaded=\"*\\\\System.Management.Automation.dll\" OR image_loaded=\"*\\\\System.Management.Automation.ni.dll\")) NOT ((process_path=\"*:\\\\Program Files\\\\PowerShell\\\\7\\\\pwsh.exe\" OR process_path=\"*:\\\\Windows\\\\System32\\\\dsac.exe\" OR process_path=\"*:\\\\WINDOWS\\\\System32\\\\RemoteFXvGPUDisablement.exe\" OR process_path=\"*:\\\\Windows\\\\System32\\\\runscripthelper.exe\" OR process_path=\"*:\\\\WINDOWS\\\\System32\\\\sdiagnhost.exe\" OR process_path=\"*:\\\\Windows\\\\System32\\\\ServerManager.exe\" OR process_path=\"*:\\\\Windows\\\\System32\\\\SyncAppvPublishingServer.exe\" OR process_path=\"*:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell_ise.exe\" OR process_path=\"*:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\" OR process_path=\"*:\\\\Windows\\\\System32\\\\winrshost.exe\" OR process_path=\"*:\\\\Windows\\\\System32\\\\wsmprovhost.exe\" OR process_path=\"*:\\\\Windows\\\\SysWOW64\\\\WindowsPowerShell\\\\v1.0\\\\powershell_ise.exe\" OR process_path=\"*:\\\\Windows\\\\SysWOW64\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\" OR process_path=\"*:\\\\Windows\\\\SysWOW64\\\\winrshost.exe\" OR process_path=\"*:\\\\Windows\\\\SysWOW64\\\\wsmprovhost.exe\") OR ((process_path=\"*:\\\\Windows\\\\Microsoft.NET\\\\Framework\\\\*\" OR process_path=\"*:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\*\") process_path=\"*\\\\mscorsvw.exe\")) NOT (((process_path=\"*:\\\\Program Files (x86)\\\\Microsoft SQL Server Management Studio*\" OR process_path=\"*:\\\\Program Files\\\\Microsoft SQL Server Management Studio*\") process_path=\"*\\\\IDE\\\\Ssms.exe\") OR ((process_path=\"*:\\\\Program Files (x86)\\\\Microsoft SQL Server\\\\*\" OR process_path=\"*:\\\\Program Files\\\\Microsoft SQL Server\\\\*\") process_path=\"*\\\\Tools\\\\Binn\\\\SQLPS.exe\") OR process_path=\"*\\\\Citrix\\\\ConfigSync\\\\ConfigSyncRun.exe\" OR (process_path=\"*:\\\\Program Files (x86)\\\\Microsoft Visual Studio\\\\*\" OR process_path=\"*:\\\\Program Files\\\\Microsoft Visual Studio\\\\*\") OR process_path=\"*:\\\\ProgramData\\\\chocolatey\\\\choco.exe*\" OR (process_path=\"*:\\\\Windows\\\\Temp\\\\asgard2-agent\\\\*\" (process_path=\"*\\\\thor64.exe\" OR process_path=\"*\\\\thor.exe\")) OR process_path=\"null\")",
  "Tags": [
    "attack.t1059.001",
    "attack.execution"
  ],
  "Version": "0.1"
}