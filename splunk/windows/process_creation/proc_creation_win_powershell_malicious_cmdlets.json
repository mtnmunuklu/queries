{
  "Description": "Detects Commandlet names from well-known PowerShell exploitation frameworks\n\nAuthor: Nasreddine Bencherchali (Nextron Systems)\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "02030f2f-6199-49ec-b258-ea71b07e03dc",
  "InsertDate": "2025-02-03T20:32:58Z",
  "LastUpdateDate": "2025-02-03T20:32:58Z",
  "Level": "high",
  "Name": "Malicious PowerShell Commandlets - ProcessCreation",
  "Query": "sourcetype=\"windows-sysmon\" (command=\"*Add-Exfiltration*\" OR command=\"*Add-Persistence*\" OR command=\"*Add-RegBackdoor*\" OR command=\"*Add-RemoteRegBackdoor*\" OR command=\"*Add-ScrnSaveBackdoor*\" OR command=\"*Check-VM*\" OR command=\"*ConvertTo-Rc4ByteStream*\" OR command=\"*Decrypt-Hash*\" OR command=\"*Disable-ADIDNSNode*\" OR command=\"*Disable-MachineAccount*\" OR command=\"*Do-Exfiltration*\" OR command=\"*Enable-ADIDNSNode*\" OR command=\"*Enable-MachineAccount*\" OR command=\"*Enabled-DuplicateToken*\" OR command=\"*Exploit-Jboss*\" OR command=\"*Export-ADR*\" OR command=\"*Export-ADRCSV*\" OR command=\"*Export-ADRExcel*\" OR command=\"*Export-ADRHTML*\" OR command=\"*Export-ADRJSON*\" OR command=\"*Export-ADRXML*\" OR command=\"*Find-Fruit*\" OR command=\"*Find-GPOLocation*\" OR command=\"*Find-TrustedDocuments*\" OR command=\"*Get-ADIDNS*\" OR command=\"*Get-ApplicationHost*\" OR command=\"*Get-ChromeDump*\" OR command=\"*Get-ClipboardContents*\" OR command=\"*Get-FoxDump*\" OR command=\"*Get-GPPPassword*\" OR command=\"*Get-IndexedItem*\" OR command=\"*Get-KerberosAESKey*\" OR command=\"*Get-Keystrokes*\" OR command=\"*Get-LSASecret*\" OR command=\"*Get-MachineAccountAttribute*\" OR command=\"*Get-MachineAccountCreator*\" OR command=\"*Get-PassHashes*\" OR command=\"*Get-RegAlwaysInstallElevated*\" OR command=\"*Get-RegAutoLogon*\" OR command=\"*Get-RemoteBootKey*\" OR command=\"*Get-RemoteCachedCredential*\" OR command=\"*Get-RemoteLocalAccountHash*\" OR command=\"*Get-RemoteLSAKey*\" OR command=\"*Get-RemoteMachineAccountHash*\" OR command=\"*Get-RemoteNLKMKey*\" OR command=\"*Get-RickAstley*\" OR command=\"*Get-Screenshot*\" OR command=\"*Get-SecurityPackages*\" OR command=\"*Get-ServiceFilePermission*\" OR command=\"*Get-ServicePermission*\" OR command=\"*Get-ServiceUnquoted*\" OR command=\"*Get-SiteListPassword*\" OR command=\"*Get-System*\" OR command=\"*Get-TimedScreenshot*\" OR command=\"*Get-UnattendedInstallFile*\" OR command=\"*Get-Unconstrained*\" OR command=\"*Get-USBKeystrokes*\" OR command=\"*Get-VaultCredential*\" OR command=\"*Get-VulnAutoRun*\" OR command=\"*Get-VulnSchTask*\" OR command=\"*Grant-ADIDNSPermission*\" OR command=\"*Gupt-Backdoor*\" OR command=\"*HTTP-Login*\" OR command=\"*Install-ServiceBinary*\" OR command=\"*Install-SSP*\" OR command=\"*Invoke-ACLScanner*\" OR command=\"*Invoke-ADRecon*\" OR command=\"*Invoke-ADSBackdoor*\" OR command=\"*Invoke-AgentSmith*\" OR command=\"*Invoke-AllChecks*\" OR command=\"*Invoke-ARPScan*\" OR command=\"*Invoke-AzureHound*\" OR command=\"*Invoke-BackdoorLNK*\" OR command=\"*Invoke-BadPotato*\" OR command=\"*Invoke-BetterSafetyKatz*\" OR command=\"*Invoke-BypassUAC*\" OR command=\"*Invoke-Carbuncle*\" OR command=\"*Invoke-Certify*\" OR command=\"*Invoke-ConPtyShell*\" OR command=\"*Invoke-CredentialInjection*\" OR command=\"*Invoke-DAFT*\" OR command=\"*Invoke-DCSync*\" OR command=\"*Invoke-DinvokeKatz*\" OR command=\"*Invoke-DllInjection*\" OR command=\"*Invoke-DNSUpdate*\" OR command=\"*Invoke-DomainPasswordSpray*\" OR command=\"*Invoke-DowngradeAccount*\" OR command=\"*Invoke-EgressCheck*\" OR command=\"*Invoke-Eyewitness*\" OR command=\"*Invoke-FakeLogonScreen*\" OR command=\"*Invoke-Farmer*\" OR command=\"*Invoke-Get-RBCD-Threaded*\" OR command=\"*Invoke-Gopher*\" OR command=\"*Invoke-Grouper*\" OR command=\"*Invoke-HandleKatz*\" OR command=\"*Invoke-ImpersonatedProcess*\" OR command=\"*Invoke-ImpersonateSystem*\" OR command=\"*Invoke-InteractiveSystemPowerShell*\" OR command=\"*Invoke-Internalmonologue*\" OR command=\"*Invoke-Inveigh*\" OR command=\"*Invoke-InveighRelay*\" OR command=\"*Invoke-KrbRelay*\" OR command=\"*Invoke-LdapSignCheck*\" OR command=\"*Invoke-Lockless*\" OR command=\"*Invoke-MalSCCM*\" OR command=\"*Invoke-Mimikatz*\" OR command=\"*Invoke-Mimikittenz*\" OR command=\"*Invoke-MITM6*\" OR command=\"*Invoke-NanoDump*\" OR command=\"*Invoke-NetRipper*\" OR command=\"*Invoke-Nightmare*\" OR command=\"*Invoke-NinjaCopy*\" OR command=\"*Invoke-OfficeScrape*\" OR command=\"*Invoke-OxidResolver*\" OR command=\"*Invoke-P0wnedshell*\" OR command=\"*Invoke-Paranoia*\" OR command=\"*Invoke-PortScan*\" OR command=\"*Invoke-PoshRatHttp*\" OR command=\"*Invoke-PostExfil*\" OR command=\"*Invoke-PowerDump*\" OR command=\"*Invoke-PowerShellTCP*\" OR command=\"*Invoke-PowerShellWMI*\" OR command=\"*Invoke-PPLDump*\" OR command=\"*Invoke-PsExec*\" OR command=\"*Invoke-PSInject*\" OR command=\"*Invoke-PsUaCme*\" OR command=\"*Invoke-ReflectivePEInjection*\" OR command=\"*Invoke-ReverseDNSLookup*\" OR command=\"*Invoke-Rubeus*\" OR command=\"*Invoke-RunAs*\" OR command=\"*Invoke-SafetyKatz*\" OR command=\"*Invoke-SauronEye*\" OR command=\"*Invoke-SCShell*\" OR command=\"*Invoke-Seatbelt*\" OR command=\"*Invoke-ServiceAbuse*\" OR command=\"*Invoke-ShadowSpray*\" OR command=\"*Invoke-Sharp*\" OR command=\"*Invoke-Shellcode*\" OR command=\"*Invoke-SMBScanner*\" OR command=\"*Invoke-Snaffler*\" OR command=\"*Invoke-Spoolsample*\" OR command=\"*Invoke-SpraySinglePassword*\" OR command=\"*Invoke-SSHCommand*\" OR command=\"*Invoke-StandIn*\" OR command=\"*Invoke-StickyNotesExtract*\" OR command=\"*Invoke-SystemCommand*\" OR command=\"*Invoke-Tasksbackdoor*\" OR command=\"*Invoke-Tater*\" OR command=\"*Invoke-Thunderfox*\" OR command=\"*Invoke-ThunderStruck*\" OR command=\"*Invoke-TokenManipulation*\" OR command=\"*Invoke-Tokenvator*\" OR command=\"*Invoke-TotalExec*\" OR command=\"*Invoke-UrbanBishop*\" OR command=\"*Invoke-UserHunter*\" OR command=\"*Invoke-VoiceTroll*\" OR command=\"*Invoke-Whisker*\" OR command=\"*Invoke-WinEnum*\" OR command=\"*Invoke-winPEAS*\" OR command=\"*Invoke-WireTap*\" OR command=\"*Invoke-WmiCommand*\" OR command=\"*Invoke-WMIExec*\" OR command=\"*Invoke-WScriptBypassUAC*\" OR command=\"*Invoke-Zerologon*\" OR command=\"*MailRaider*\" OR command=\"*New-ADIDNSNode*\" OR command=\"*New-DNSRecordArray*\" OR command=\"*New-HoneyHash*\" OR command=\"*New-InMemoryModule*\" OR command=\"*New-MachineAccount*\" OR command=\"*New-SOASerialNumberArray*\" OR command=\"*Out-Minidump*\" OR command=\"*Port-Scan*\" OR command=\"*PowerBreach*\" OR command=\"*powercat *\" OR command=\"*PowerUp*\" OR command=\"*PowerView*\" OR command=\"*Remove-ADIDNSNode*\" OR command=\"*Remove-MachineAccount*\" OR command=\"*Remove-Update*\" OR command=\"*Rename-ADIDNSNode*\" OR command=\"*Revoke-ADIDNSPermission*\" OR command=\"*Set-ADIDNSNode*\" OR command=\"*Set-MacAttribute*\" OR command=\"*Set-MachineAccountAttribute*\" OR command=\"*Set-Wallpaper*\" OR command=\"*Show-TargetScreen*\" OR command=\"*Start-CaptureServer*\" OR command=\"*Start-Dnscat2*\" OR command=\"*Start-WebcamRecorder*\" OR command=\"*VolumeShadowCopyTools*\")",
  "Tags": [
    "attack.execution",
    "attack.discovery",
    "attack.t1482",
    "attack.t1087",
    "attack.t1087.001",
    "attack.t1087.002",
    "attack.t1069.001",
    "attack.t1069.002",
    "attack.t1069",
    "attack.t1059.001"
  ],
  "Version": "0.1"
}