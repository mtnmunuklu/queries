{
  "Description": "Detects the execution of PingCastle, a tool designed to quickly assess the Active Directory security level via a script located in a potentially suspicious or uncommon location.\n\n\nAuthor: Nasreddine Bencherchali (Nextron Systems), X__Junior (Nextron Systems)\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "b37998de-a70b-4f33-b219-ec36bf433dc0",
  "InsertDate": "2025-02-03T20:33:01Z",
  "LastUpdateDate": "2025-02-03T20:33:01Z",
  "Level": "high",
  "Name": "PUA - PingCastle Execution From Potentially Suspicious Parent",
  "Query": "sourcetype=\"windows-sysmon\" ((parent_command_line=\"*.bat*\" OR parent_command_line=\"*.chm*\" OR parent_command_line=\"*.cmd*\" OR parent_command_line=\"*.hta*\" OR parent_command_line=\"*.htm*\" OR parent_command_line=\"*.html*\" OR parent_command_line=\"*.js*\" OR parent_command_line=\"*.lnk*\" OR parent_command_line=\"*.ps1*\" OR parent_command_line=\"*.vbe*\" OR parent_command_line=\"*.vbs*\" OR parent_command_line=\"*.wsf*\") OR (parent_command_line=\"*:\\\\Perflogs\\\\*\" OR parent_command_line=\"*:\\\\Temp\\\\*\" OR parent_command_line=\"*:\\\\Users\\\\Public\\\\*\" OR parent_command_line=\"*:\\\\Windows\\\\Temp\\\\*\" OR parent_command_line=\"*\\\\AppData\\\\Local\\\\Temp*\" OR parent_command_line=\"*\\\\AppData\\\\Roaming\\\\*\" OR parent_command_line=\"*\\\\Temporary Internet*\") OR ((parent_command_line=\"*:\\\\Users\\\\*\" parent_command_line=\"*\\\\Favorites\\\\*\") (parent_command_line=\"*:\\\\Users\\\\*\" parent_command_line=\"*\\\\Favourites\\\\*\") (parent_command_line=\"*:\\\\Users\\\\*\" parent_command_line=\"*\\\\Contacts\\\\*\"))) (parent_command_line=\"*.bat*\" OR parent_command_line=\"*.chm*\" OR parent_command_line=\"*.cmd*\" OR parent_command_line=\"*.hta*\" OR parent_command_line=\"*.htm*\" OR parent_command_line=\"*.html*\" OR parent_command_line=\"*.js*\" OR parent_command_line=\"*.lnk*\" OR parent_command_line=\"*.ps1*\" OR parent_command_line=\"*.vbe*\" OR parent_command_line=\"*.vbs*\" OR parent_command_line=\"*.wsf*\") (process_path=\"*\\\\PingCastle.exe\" original_file_name=\"PingCastle.exe\" product=\"Ping Castle\" (command=\"*--scanner aclcheck*\" OR command=\"*--scanner antivirus*\" OR command=\"*--scanner computerversion*\" OR command=\"*--scanner foreignusers*\" OR command=\"*--scanner laps_bitlocker*\" OR command=\"*--scanner localadmin*\" OR command=\"*--scanner nullsession*\" OR command=\"*--scanner nullsession-trust*\" OR command=\"*--scanner oxidbindings*\" OR command=\"*--scanner remote*\" OR command=\"*--scanner share*\" OR command=\"*--scanner smb*\" OR command=\"*--scanner smb3querynetwork*\" OR command=\"*--scanner spooler*\" OR command=\"*--scanner startup*\" OR command=\"*--scanner zerologon*\") command=\"*--no-enum-limit*\" (command=\"*--healthcheck*\" command=\"*--level Full*\") (command=\"*--healthcheck*\" command=\"*--server *\"))",
  "Tags": [
    "attack.reconnaissance",
    "attack.t1595"
  ],
  "Version": "0.1"
}