{
  "Description": "Detects Commandlet names from well-known PowerShell exploitation frameworks\n\nAuthor: Sean Metcalf, Florian Roth, Bartlomiej Czyz @bczyz1, oscd.community, Nasreddine Bencherchali, Tim Shelton, Mustafa Kaan Demir, Georg Lauenstein, Max Altgelt, Tobias Michalski, Austin Songer\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "89819aa4-bbd6-46bc-88ec-c7f7fe30efa6",
  "InsertDate": "2025-02-03T20:32:31Z",
  "LastUpdateDate": "2025-02-03T20:32:31Z",
  "Level": "high",
  "Name": "Malicious PowerShell Commandlets - ScriptBlock",
  "Query": "sourcetype=\"windows-*\" (scriptblocktext=\"*Add-Exfiltration*\" OR scriptblocktext=\"*Add-Persistence*\" OR scriptblocktext=\"*Add-RegBackdoor*\" OR scriptblocktext=\"*Add-RemoteRegBackdoor*\" OR scriptblocktext=\"*Add-ScrnSaveBackdoor*\" OR scriptblocktext=\"*ConvertTo-Rc4ByteStream*\" OR scriptblocktext=\"*Decrypt-Hash*\" OR scriptblocktext=\"*Disable-ADIDNSNode*\" OR scriptblocktext=\"*Do-Exfiltration*\" OR scriptblocktext=\"*Enable-ADIDNSNode*\" OR scriptblocktext=\"*Enabled-DuplicateToken*\" OR scriptblocktext=\"*Exploit-Jboss*\" OR scriptblocktext=\"*Export-ADRCSV*\" OR scriptblocktext=\"*Export-ADRExcel*\" OR scriptblocktext=\"*Export-ADRHTML*\" OR scriptblocktext=\"*Export-ADRJSON*\" OR scriptblocktext=\"*Export-ADRXML*\" OR scriptblocktext=\"*Find-Fruit*\" OR scriptblocktext=\"*Find-GPOLocation*\" OR scriptblocktext=\"*Find-TrustedDocuments*\" OR scriptblocktext=\"*Get-ADIDNSNodeAttribute*\" OR scriptblocktext=\"*Get-ADIDNSNodeOwner*\" OR scriptblocktext=\"*Get-ADIDNSNodeTombstoned*\" OR scriptblocktext=\"*Get-ADIDNSPermission*\" OR scriptblocktext=\"*Get-ADIDNSZone*\" OR scriptblocktext=\"*Get-ChromeDump*\" OR scriptblocktext=\"*Get-ClipboardContents*\" OR scriptblocktext=\"*Get-FoxDump*\" OR scriptblocktext=\"*Get-GPPPassword*\" OR scriptblocktext=\"*Get-IndexedItem*\" OR scriptblocktext=\"*Get-KerberosAESKey*\" OR scriptblocktext=\"*Get-Keystrokes*\" OR scriptblocktext=\"*Get-LSASecret*\" OR scriptblocktext=\"*Get-PassHashes*\" OR scriptblocktext=\"*Get-RegAlwaysInstallElevated*\" OR scriptblocktext=\"*Get-RegAutoLogon*\" OR scriptblocktext=\"*Get-RemoteBootKey*\" OR scriptblocktext=\"*Get-RemoteCachedCredential*\" OR scriptblocktext=\"*Get-RemoteLocalAccountHash*\" OR scriptblocktext=\"*Get-RemoteLSAKey*\" OR scriptblocktext=\"*Get-RemoteMachineAccountHash*\" OR scriptblocktext=\"*Get-RemoteNLKMKey*\" OR scriptblocktext=\"*Get-RickAstley*\" OR scriptblocktext=\"*Get-SecurityPackages*\" OR scriptblocktext=\"*Get-ServiceFilePermission*\" OR scriptblocktext=\"*Get-ServicePermission*\" OR scriptblocktext=\"*Get-ServiceUnquoted*\" OR scriptblocktext=\"*Get-SiteListPassword*\" OR scriptblocktext=\"*Get-System*\" OR scriptblocktext=\"*Get-TimedScreenshot*\" OR scriptblocktext=\"*Get-UnattendedInstallFile*\" OR scriptblocktext=\"*Get-Unconstrained*\" OR scriptblocktext=\"*Get-USBKeystrokes*\" OR scriptblocktext=\"*Get-VaultCredential*\" OR scriptblocktext=\"*Get-VulnAutoRun*\" OR scriptblocktext=\"*Get-VulnSchTask*\" OR scriptblocktext=\"*Grant-ADIDNSPermission*\" OR scriptblocktext=\"*Gupt-Backdoor*\" OR scriptblocktext=\"*Invoke-ACLScanner*\" OR scriptblocktext=\"*Invoke-ADRecon*\" OR scriptblocktext=\"*Invoke-ADSBackdoor*\" OR scriptblocktext=\"*Invoke-AgentSmith*\" OR scriptblocktext=\"*Invoke-AllChecks*\" OR scriptblocktext=\"*Invoke-ARPScan*\" OR scriptblocktext=\"*Invoke-AzureHound*\" OR scriptblocktext=\"*Invoke-BackdoorLNK*\" OR scriptblocktext=\"*Invoke-BadPotato*\" OR scriptblocktext=\"*Invoke-BetterSafetyKatz*\" OR scriptblocktext=\"*Invoke-BypassUAC*\" OR scriptblocktext=\"*Invoke-Carbuncle*\" OR scriptblocktext=\"*Invoke-Certify*\" OR scriptblocktext=\"*Invoke-ConPtyShell*\" OR scriptblocktext=\"*Invoke-CredentialInjection*\" OR scriptblocktext=\"*Invoke-DAFT*\" OR scriptblocktext=\"*Invoke-DCSync*\" OR scriptblocktext=\"*Invoke-DinvokeKatz*\" OR scriptblocktext=\"*Invoke-DllInjection*\" OR scriptblocktext=\"*Invoke-DNSUpdate*\" OR scriptblocktext=\"*Invoke-DomainPasswordSpray*\" OR scriptblocktext=\"*Invoke-DowngradeAccount*\" OR scriptblocktext=\"*Invoke-EgressCheck*\" OR scriptblocktext=\"*Invoke-Eyewitness*\" OR scriptblocktext=\"*Invoke-FakeLogonScreen*\" OR scriptblocktext=\"*Invoke-Farmer*\" OR scriptblocktext=\"*Invoke-Get-RBCD-Threaded*\" OR scriptblocktext=\"*Invoke-Gopher*\" OR scriptblocktext=\"*Invoke-Grouper*\" OR scriptblocktext=\"*Invoke-HandleKatz*\" OR scriptblocktext=\"*Invoke-ImpersonatedProcess*\" OR scriptblocktext=\"*Invoke-ImpersonateSystem*\" OR scriptblocktext=\"*Invoke-InteractiveSystemPowerShell*\" OR scriptblocktext=\"*Invoke-Internalmonologue*\" OR scriptblocktext=\"*Invoke-Inveigh*\" OR scriptblocktext=\"*Invoke-InveighRelay*\" OR scriptblocktext=\"*Invoke-KrbRelay*\" OR scriptblocktext=\"*Invoke-LdapSignCheck*\" OR scriptblocktext=\"*Invoke-Lockless*\" OR scriptblocktext=\"*Invoke-MalSCCM*\" OR scriptblocktext=\"*Invoke-Mimikatz*\" OR scriptblocktext=\"*Invoke-Mimikittenz*\" OR scriptblocktext=\"*Invoke-MITM6*\" OR scriptblocktext=\"*Invoke-NanoDump*\" OR scriptblocktext=\"*Invoke-NetRipper*\" OR scriptblocktext=\"*Invoke-Nightmare*\" OR scriptblocktext=\"*Invoke-NinjaCopy*\" OR scriptblocktext=\"*Invoke-OfficeScrape*\" OR scriptblocktext=\"*Invoke-OxidResolver*\" OR scriptblocktext=\"*Invoke-P0wnedshell*\" OR scriptblocktext=\"*Invoke-Paranoia*\" OR scriptblocktext=\"*Invoke-PortScan*\" OR scriptblocktext=\"*Invoke-PoshRatHttp*\" OR scriptblocktext=\"*Invoke-PostExfil*\" OR scriptblocktext=\"*Invoke-PowerDump*\" OR scriptblocktext=\"*Invoke-PowerShellTCP*\" OR scriptblocktext=\"*Invoke-PowerShellWMI*\" OR scriptblocktext=\"*Invoke-PPLDump*\" OR scriptblocktext=\"*Invoke-PsExec*\" OR scriptblocktext=\"*Invoke-PSInject*\" OR scriptblocktext=\"*Invoke-PsUaCme*\" OR scriptblocktext=\"*Invoke-ReflectivePEInjection*\" OR scriptblocktext=\"*Invoke-ReverseDNSLookup*\" OR scriptblocktext=\"*Invoke-Rubeus*\" OR scriptblocktext=\"*Invoke-RunAs*\" OR scriptblocktext=\"*Invoke-SafetyKatz*\" OR scriptblocktext=\"*Invoke-SauronEye*\" OR scriptblocktext=\"*Invoke-SCShell*\" OR scriptblocktext=\"*Invoke-Seatbelt*\" OR scriptblocktext=\"*Invoke-ServiceAbuse*\" OR scriptblocktext=\"*Invoke-ShadowSpray*\" OR scriptblocktext=\"*Invoke-Sharp*\" OR scriptblocktext=\"*Invoke-Shellcode*\" OR scriptblocktext=\"*Invoke-SMBScanner*\" OR scriptblocktext=\"*Invoke-Snaffler*\" OR scriptblocktext=\"*Invoke-Spoolsample*\" OR scriptblocktext=\"*Invoke-SpraySinglePassword*\" OR scriptblocktext=\"*Invoke-SSHCommand*\" OR scriptblocktext=\"*Invoke-StandIn*\" OR scriptblocktext=\"*Invoke-StickyNotesExtract*\" OR scriptblocktext=\"*Invoke-SystemCommand*\" OR scriptblocktext=\"*Invoke-Tasksbackdoor*\" OR scriptblocktext=\"*Invoke-Tater*\" OR scriptblocktext=\"*Invoke-Thunderfox*\" OR scriptblocktext=\"*Invoke-ThunderStruck*\" OR scriptblocktext=\"*Invoke-TokenManipulation*\" OR scriptblocktext=\"*Invoke-Tokenvator*\" OR scriptblocktext=\"*Invoke-TotalExec*\" OR scriptblocktext=\"*Invoke-UrbanBishop*\" OR scriptblocktext=\"*Invoke-UserHunter*\" OR scriptblocktext=\"*Invoke-VoiceTroll*\" OR scriptblocktext=\"*Invoke-Whisker*\" OR scriptblocktext=\"*Invoke-WinEnum*\" OR scriptblocktext=\"*Invoke-winPEAS*\" OR scriptblocktext=\"*Invoke-WireTap*\" OR scriptblocktext=\"*Invoke-WmiCommand*\" OR scriptblocktext=\"*Invoke-WMIExec*\" OR scriptblocktext=\"*Invoke-WScriptBypassUAC*\" OR scriptblocktext=\"*Invoke-Zerologon*\" OR scriptblocktext=\"*MailRaider*\" OR scriptblocktext=\"*New-ADIDNSNode*\" OR scriptblocktext=\"*New-HoneyHash*\" OR scriptblocktext=\"*New-InMemoryModule*\" OR scriptblocktext=\"*New-SOASerialNumberArray*\" OR scriptblocktext=\"*Out-Minidump*\" OR scriptblocktext=\"*PowerBreach*\" OR scriptblocktext=\"*powercat *\" OR scriptblocktext=\"*PowerUp*\" OR scriptblocktext=\"*PowerView*\" OR scriptblocktext=\"*Remove-ADIDNSNode*\" OR scriptblocktext=\"*Remove-Update*\" OR scriptblocktext=\"*Rename-ADIDNSNode*\" OR scriptblocktext=\"*Revoke-ADIDNSPermission*\" OR scriptblocktext=\"*Set-ADIDNSNode*\" OR scriptblocktext=\"*Show-TargetScreen*\" OR scriptblocktext=\"*Start-CaptureServer*\" OR scriptblocktext=\"*Start-Dnscat2*\" OR scriptblocktext=\"*Start-WebcamRecorder*\" OR scriptblocktext=\"*VolumeShadowCopyTools*\") NOT (scriptblocktext=\"*Get-SystemDriveInfo*\" OR scriptblocktext=\"*C:\\\\ProgramData\\\\Amazon\\\\EC2-Windows\\\\Launch\\\\Module\\\\*\")",
  "Tags": [
    "attack.execution",
    "attack.discovery",
    "attack.t1482",
    "attack.t1087",
    "attack.t1087.001",
    "attack.t1087.002",
    "attack.t1069.001",
    "attack.t1069.002",
    "attack.t1069",
    "attack.t1059.001"
  ],
  "Version": "0.1"
}