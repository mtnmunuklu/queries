{
  "Description": "Detects Commandlet names and arguments from the Nishang exploitation framework\n\nAuthor: Alec Costello\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "f772cee9-b7c2-4cb2-8f07-49870adc02e0",
  "InsertDate": "2025-02-03T20:32:31Z",
  "LastUpdateDate": "2025-02-03T20:32:31Z",
  "Level": "high",
  "Name": "Malicious Nishang PowerShell Commandlets",
  "Query": "sourcetype=\"windows-*\" (scriptblocktext=\"*Add-ConstrainedDelegationBackdoor*\" OR scriptblocktext=\"*Copy-VSS*\" OR scriptblocktext=\"*Create-MultipleSessions*\" OR scriptblocktext=\"*DataToEncode*\" OR scriptblocktext=\"*DNS_TXT_Pwnage*\" OR scriptblocktext=\"*Do-Exfiltration-Dns*\" OR scriptblocktext=\"*Download_Execute*\" OR scriptblocktext=\"*Download-Execute-PS*\" OR scriptblocktext=\"*DownloadAndExtractFromRemoteRegistry*\" OR scriptblocktext=\"*DumpCerts*\" OR scriptblocktext=\"*DumpCreds*\" OR scriptblocktext=\"*DumpHashes*\" OR scriptblocktext=\"*Enable-DuplicateToken*\" OR scriptblocktext=\"*Enable-Duplication*\" OR scriptblocktext=\"*Execute-Command-MSSQL*\" OR scriptblocktext=\"*Execute-DNSTXT-Code*\" OR scriptblocktext=\"*Execute-OnTime*\" OR scriptblocktext=\"*ExetoText*\" OR scriptblocktext=\"*exfill*\" OR scriptblocktext=\"*ExfilOption*\" OR scriptblocktext=\"*FakeDC*\" OR scriptblocktext=\"*FireBuster*\" OR scriptblocktext=\"*FireListener*\" OR scriptblocktext=\"*Get-Information *\" OR scriptblocktext=\"*Get-PassHints*\" OR scriptblocktext=\"*Get-Web-Credentials*\" OR scriptblocktext=\"*Get-WebCredentials*\" OR scriptblocktext=\"*Get-WLAN-Keys*\" OR scriptblocktext=\"*HTTP-Backdoor*\" OR scriptblocktext=\"*Invoke-AmsiBypass*\" OR scriptblocktext=\"*Invoke-BruteForce*\" OR scriptblocktext=\"*Invoke-CredentialsPhish*\" OR scriptblocktext=\"*Invoke-Decode*\" OR scriptblocktext=\"*Invoke-Encode*\" OR scriptblocktext=\"*Invoke-Interceptor*\" OR scriptblocktext=\"*Invoke-JSRatRegsvr*\" OR scriptblocktext=\"*Invoke-JSRatRundll*\" OR scriptblocktext=\"*Invoke-MimikatzWDigestDowngrade*\" OR scriptblocktext=\"*Invoke-NetworkRelay*\" OR scriptblocktext=\"*Invoke-PowerShellIcmp*\" OR scriptblocktext=\"*Invoke-PowerShellUdp*\" OR scriptblocktext=\"*Invoke-Prasadhak*\" OR scriptblocktext=\"*Invoke-PSGcat*\" OR scriptblocktext=\"*Invoke-PsGcatAgent*\" OR scriptblocktext=\"*Invoke-SessionGopher*\" OR scriptblocktext=\"*Invoke-SSIDExfil*\" OR scriptblocktext=\"*LoggedKeys*\" OR scriptblocktext=\"*Nishang*\" OR scriptblocktext=\"*NotAllNameSpaces*\" OR scriptblocktext=\"*Out-CHM*\" OR scriptblocktext=\"*OUT-DNSTXT*\" OR scriptblocktext=\"*Out-HTA*\" OR scriptblocktext=\"*Out-RundllCommand*\" OR scriptblocktext=\"*Out-SCF*\" OR scriptblocktext=\"*Out-SCT*\" OR scriptblocktext=\"*Out-Shortcut*\" OR scriptblocktext=\"*Out-WebQuery*\" OR scriptblocktext=\"*Out-Word*\" OR scriptblocktext=\"*Parse_Keys*\" OR scriptblocktext=\"*Password-List*\" OR scriptblocktext=\"*Powerpreter*\" OR scriptblocktext=\"*Remove-Persistence*\" OR scriptblocktext=\"*Remove-PoshRat*\" OR scriptblocktext=\"*Remove-Update*\" OR scriptblocktext=\"*Run-EXEonRemote*\" OR scriptblocktext=\"*Set-DCShadowPermissions*\" OR scriptblocktext=\"*Set-RemotePSRemoting*\" OR scriptblocktext=\"*Set-RemoteWMI*\" OR scriptblocktext=\"*Shellcode32*\" OR scriptblocktext=\"*Shellcode64*\" OR scriptblocktext=\"*StringtoBase64*\" OR scriptblocktext=\"*TexttoExe*\")",
  "Tags": [
    "attack.execution",
    "attack.t1059.001"
  ],
  "Version": "0.1"
}