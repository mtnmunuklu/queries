{
  "Description": "Detects the execution of known offensive powershell scripts used for exploitation or reconnaissance\n\nAuthor: frack113, Nasreddine Bencherchali (Nextron Systems)\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "41025fd7-0466-4650-a813-574aaacbe7f4",
  "InsertDate": "2025-02-03T20:32:27Z",
  "LastUpdateDate": "2025-02-03T20:32:27Z",
  "Level": "high",
  "Name": "Malicious PowerShell Scripts - PoshModule",
  "Query": "sourcetype=\"windows-*\" (contextinfo=\"*Add-ConstrainedDelegationBackdoor.ps1*\" OR contextinfo=\"*Add-Exfiltration.ps1*\" OR contextinfo=\"*Add-Persistence.ps1*\" OR contextinfo=\"*Add-RegBackdoor.ps1*\" OR contextinfo=\"*Add-RemoteRegBackdoor.ps1*\" OR contextinfo=\"*Add-ScrnSaveBackdoor.ps1*\" OR contextinfo=\"*Check-VM.ps1*\" OR contextinfo=\"*ConvertTo-ROT13.ps1*\" OR contextinfo=\"*Copy-VSS.ps1*\" OR contextinfo=\"*Create-MultipleSessions.ps1*\" OR contextinfo=\"*DNS_TXT_Pwnage.ps1*\" OR contextinfo=\"*dnscat2.ps1*\" OR contextinfo=\"*Do-Exfiltration.ps1*\" OR contextinfo=\"*DomainPasswordSpray.ps1*\" OR contextinfo=\"*Download_Execute.ps1*\" OR contextinfo=\"*Download-Execute-PS.ps1*\" OR contextinfo=\"*Enabled-DuplicateToken.ps1*\" OR contextinfo=\"*Enable-DuplicateToken.ps1*\" OR contextinfo=\"*Execute-Command-MSSQL.ps1*\" OR contextinfo=\"*Execute-DNSTXT-Code.ps1*\" OR contextinfo=\"*Execute-OnTime.ps1*\" OR contextinfo=\"*ExetoText.ps1*\" OR contextinfo=\"*Exploit-Jboss.ps1*\" OR contextinfo=\"*Find-AVSignature.ps1*\" OR contextinfo=\"*Find-Fruit.ps1*\" OR contextinfo=\"*Find-GPOLocation.ps1*\" OR contextinfo=\"*Find-TrustedDocuments.ps1*\" OR contextinfo=\"*FireBuster.ps1*\" OR contextinfo=\"*FireListener.ps1*\" OR contextinfo=\"*Get-ApplicationHost.ps1*\" OR contextinfo=\"*Get-ChromeDump.ps1*\" OR contextinfo=\"*Get-ClipboardContents.ps1*\" OR contextinfo=\"*Get-ComputerDetail.ps1*\" OR contextinfo=\"*Get-FoxDump.ps1*\" OR contextinfo=\"*Get-GPPAutologon.ps1*\" OR contextinfo=\"*Get-GPPPassword.ps1*\" OR contextinfo=\"*Get-IndexedItem.ps1*\" OR contextinfo=\"*Get-Keystrokes.ps1*\" OR contextinfo=\"*Get-LSASecret.ps1*\" OR contextinfo=\"*Get-MicrophoneAudio.ps1*\" OR contextinfo=\"*Get-PassHashes.ps1*\" OR contextinfo=\"*Get-PassHints.ps1*\" OR contextinfo=\"*Get-RegAlwaysInstallElevated.ps1*\" OR contextinfo=\"*Get-RegAutoLogon.ps1*\" OR contextinfo=\"*Get-RickAstley.ps1*\" OR contextinfo=\"*Get-Screenshot.ps1*\" OR contextinfo=\"*Get-SecurityPackages.ps1*\" OR contextinfo=\"*Get-ServiceFilePermission.ps1*\" OR contextinfo=\"*Get-ServicePermission.ps1*\" OR contextinfo=\"*Get-ServiceUnquoted.ps1*\" OR contextinfo=\"*Get-SiteListPassword.ps1*\" OR contextinfo=\"*Get-System.ps1*\" OR contextinfo=\"*Get-TimedScreenshot.ps1*\" OR contextinfo=\"*Get-UnattendedInstallFile.ps1*\" OR contextinfo=\"*Get-Unconstrained.ps1*\" OR contextinfo=\"*Get-USBKeystrokes.ps1*\" OR contextinfo=\"*Get-VaultCredential.ps1*\" OR contextinfo=\"*Get-VulnAutoRun.ps1*\" OR contextinfo=\"*Get-VulnSchTask.ps1*\" OR contextinfo=\"*Get-WebConfig.ps1*\" OR contextinfo=\"*Get-WebCredentials.ps1*\" OR contextinfo=\"*Get-WLAN-Keys.ps1*\" OR contextinfo=\"*Gupt-Backdoor.ps1*\" OR contextinfo=\"*HTTP-Backdoor.ps1*\" OR contextinfo=\"*HTTP-Login.ps1*\" OR contextinfo=\"*Install-ServiceBinary.ps1*\" OR contextinfo=\"*Install-SSP.ps1*\" OR contextinfo=\"*Invoke-ACLScanner.ps1*\" OR contextinfo=\"*Invoke-ADSBackdoor.ps1*\" OR contextinfo=\"*Invoke-AmsiBypass.ps1*\" OR contextinfo=\"*Invoke-ARPScan.ps1*\" OR contextinfo=\"*Invoke-BackdoorLNK.ps1*\" OR contextinfo=\"*Invoke-BadPotato.ps1*\" OR contextinfo=\"*Invoke-BetterSafetyKatz.ps1*\" OR contextinfo=\"*Invoke-BruteForce.ps1*\" OR contextinfo=\"*Invoke-BypassUAC.ps1*\" OR contextinfo=\"*Invoke-Carbuncle.ps1*\" OR contextinfo=\"*Invoke-Certify.ps1*\" OR contextinfo=\"*Invoke-ConPtyShell.ps1*\" OR contextinfo=\"*Invoke-CredentialInjection.ps1*\" OR contextinfo=\"*Invoke-CredentialsPhish.ps1*\" OR contextinfo=\"*Invoke-DAFT.ps1*\" OR contextinfo=\"*Invoke-DCSync.ps1*\" OR contextinfo=\"*Invoke-Decode.ps1*\" OR contextinfo=\"*Invoke-DinvokeKatz.ps1*\" OR contextinfo=\"*Invoke-DllInjection.ps1*\" OR contextinfo=\"*Invoke-DowngradeAccount.ps1*\" OR contextinfo=\"*Invoke-EgressCheck.ps1*\" OR contextinfo=\"*Invoke-Encode.ps1*\" OR contextinfo=\"*Invoke-EventViewer.ps1*\" OR contextinfo=\"*Invoke-Eyewitness.ps1*\" OR contextinfo=\"*Invoke-FakeLogonScreen.ps1*\" OR contextinfo=\"*Invoke-Farmer.ps1*\" OR contextinfo=\"*Invoke-Get-RBCD-Threaded.ps1*\" OR contextinfo=\"*Invoke-Gopher.ps1*\" OR contextinfo=\"*Invoke-Grouper2.ps1*\" OR contextinfo=\"*Invoke-Grouper3.ps1*\" OR contextinfo=\"*Invoke-HandleKatz.ps1*\" OR contextinfo=\"*Invoke-Interceptor.ps1*\" OR contextinfo=\"*Invoke-Internalmonologue.ps1*\" OR contextinfo=\"*Invoke-Inveigh.ps1*\" OR contextinfo=\"*Invoke-InveighRelay.ps1*\" OR contextinfo=\"*Invoke-JSRatRegsvr.ps1*\" OR contextinfo=\"*Invoke-JSRatRundll.ps1*\" OR contextinfo=\"*Invoke-KrbRelay.ps1*\" OR contextinfo=\"*Invoke-KrbRelayUp.ps1*\" OR contextinfo=\"*Invoke-LdapSignCheck.ps1*\" OR contextinfo=\"*Invoke-Lockless.ps1*\" OR contextinfo=\"*Invoke-MalSCCM.ps1*\" OR contextinfo=\"*Invoke-Mimikatz.ps1*\" OR contextinfo=\"*Invoke-MimikatzWDigestDowngrade.ps1*\" OR contextinfo=\"*Invoke-Mimikittenz.ps1*\" OR contextinfo=\"*Invoke-MITM6.ps1*\" OR contextinfo=\"*Invoke-NanoDump.ps1*\" OR contextinfo=\"*Invoke-NetRipper.ps1*\" OR contextinfo=\"*Invoke-NetworkRelay.ps1*\" OR contextinfo=\"*Invoke-NinjaCopy.ps1*\" OR contextinfo=\"*Invoke-OxidResolver.ps1*\" OR contextinfo=\"*Invoke-P0wnedshell.ps1*\" OR contextinfo=\"*Invoke-P0wnedshellx86.ps1*\" OR contextinfo=\"*Invoke-Paranoia.ps1*\" OR contextinfo=\"*Invoke-PortScan.ps1*\" OR contextinfo=\"*Invoke-PoshRatHttp.ps1*\" OR contextinfo=\"*Invoke-PoshRatHttps.ps1*\" OR contextinfo=\"*Invoke-PostExfil.ps1*\" OR contextinfo=\"*Invoke-PowerDump.ps1*\" OR contextinfo=\"*Invoke-PowerShellIcmp.ps1*\" OR contextinfo=\"*Invoke-PowerShellTCP.ps1*\" OR contextinfo=\"*Invoke-PowerShellTcpOneLine.ps1*\" OR contextinfo=\"*Invoke-PowerShellTcpOneLineBind.ps1*\" OR contextinfo=\"*Invoke-PowerShellUdp.ps1*\" OR contextinfo=\"*Invoke-PowerShellUdpOneLine.ps1*\" OR contextinfo=\"*Invoke-PowerShellWMI.ps1*\" OR contextinfo=\"*Invoke-PowerThIEf.ps1*\" OR contextinfo=\"*Invoke-PPLDump.ps1*\" OR contextinfo=\"*Invoke-Prasadhak.ps1*\" OR contextinfo=\"*Invoke-PsExec.ps1*\" OR contextinfo=\"*Invoke-PsGcat.ps1*\" OR contextinfo=\"*Invoke-PsGcatAgent.ps1*\" OR contextinfo=\"*Invoke-PSInject.ps1*\" OR contextinfo=\"*Invoke-PsUaCme.ps1*\" OR contextinfo=\"*Invoke-ReflectivePEInjection.ps1*\" OR contextinfo=\"*Invoke-ReverseDNSLookup.ps1*\" OR contextinfo=\"*Invoke-Rubeus.ps1*\" OR contextinfo=\"*Invoke-RunAs.ps1*\" OR contextinfo=\"*Invoke-SafetyKatz.ps1*\" OR contextinfo=\"*Invoke-SauronEye.ps1*\" OR contextinfo=\"*Invoke-SCShell.ps1*\" OR contextinfo=\"*Invoke-Seatbelt.ps1*\" OR contextinfo=\"*Invoke-ServiceAbuse.ps1*\" OR contextinfo=\"*Invoke-SessionGopher.ps1*\" OR contextinfo=\"*Invoke-ShellCode.ps1*\" OR contextinfo=\"*Invoke-SMBScanner.ps1*\" OR contextinfo=\"*Invoke-Snaffler.ps1*\" OR contextinfo=\"*Invoke-Spoolsample.ps1*\" OR contextinfo=\"*Invoke-SSHCommand.ps1*\" OR contextinfo=\"*Invoke-SSIDExfil.ps1*\" OR contextinfo=\"*Invoke-StandIn.ps1*\" OR contextinfo=\"*Invoke-StickyNotesExtract.ps1*\" OR contextinfo=\"*Invoke-Tater.ps1*\" OR contextinfo=\"*Invoke-Thunderfox.ps1*\" OR contextinfo=\"*Invoke-ThunderStruck.ps1*\" OR contextinfo=\"*Invoke-TokenManipulation.ps1*\" OR contextinfo=\"*Invoke-Tokenvator.ps1*\" OR contextinfo=\"*Invoke-TotalExec.ps1*\" OR contextinfo=\"*Invoke-UrbanBishop.ps1*\" OR contextinfo=\"*Invoke-UserHunter.ps1*\" OR contextinfo=\"*Invoke-VoiceTroll.ps1*\" OR contextinfo=\"*Invoke-Whisker.ps1*\" OR contextinfo=\"*Invoke-WinEnum.ps1*\" OR contextinfo=\"*Invoke-winPEAS.ps1*\" OR contextinfo=\"*Invoke-WireTap.ps1*\" OR contextinfo=\"*Invoke-WmiCommand.ps1*\" OR contextinfo=\"*Invoke-WScriptBypassUAC.ps1*\" OR contextinfo=\"*Invoke-Zerologon.ps1*\" OR contextinfo=\"*Keylogger.ps1*\" OR contextinfo=\"*MailRaider.ps1*\" OR contextinfo=\"*New-HoneyHash.ps1*\" OR contextinfo=\"*OfficeMemScraper.ps1*\" OR contextinfo=\"*Offline_Winpwn.ps1*\" OR contextinfo=\"*Out-CHM.ps1*\" OR contextinfo=\"*Out-DnsTxt.ps1*\" OR contextinfo=\"*Out-Excel.ps1*\" OR contextinfo=\"*Out-HTA.ps1*\" OR contextinfo=\"*Out-Java.ps1*\" OR contextinfo=\"*Out-JS.ps1*\" OR contextinfo=\"*Out-Minidump.ps1*\" OR contextinfo=\"*Out-RundllCommand.ps1*\" OR contextinfo=\"*Out-SCF.ps1*\" OR contextinfo=\"*Out-SCT.ps1*\" OR contextinfo=\"*Out-Shortcut.ps1*\" OR contextinfo=\"*Out-WebQuery.ps1*\" OR contextinfo=\"*Out-Word.ps1*\" OR contextinfo=\"*Parse_Keys.ps1*\" OR contextinfo=\"*Port-Scan.ps1*\" OR contextinfo=\"*PowerBreach.ps1*\" OR contextinfo=\"*powercat.ps1*\" OR contextinfo=\"*PowerRunAsSystem.psm1*\" OR contextinfo=\"*PowerSharpPack.ps1*\" OR contextinfo=\"*PowerUp.ps1*\" OR contextinfo=\"*PowerUpSQL.ps1*\" OR contextinfo=\"*PowerView.ps1*\" OR contextinfo=\"*PSAsyncShell.ps1*\" OR contextinfo=\"*RemoteHashRetrieval.ps1*\" OR contextinfo=\"*Remove-Persistence.ps1*\" OR contextinfo=\"*Remove-PoshRat.ps1*\" OR contextinfo=\"*Remove-Update.ps1*\" OR contextinfo=\"*Run-EXEonRemote.ps1*\" OR contextinfo=\"*Schtasks-Backdoor.ps1*\" OR contextinfo=\"*Set-DCShadowPermissions.ps1*\" OR contextinfo=\"*Set-MacAttribute.ps1*\" OR contextinfo=\"*Set-RemotePSRemoting.ps1*\" OR contextinfo=\"*Set-RemoteWMI.ps1*\" OR contextinfo=\"*Set-Wallpaper.ps1*\" OR contextinfo=\"*Show-TargetScreen.ps1*\" OR contextinfo=\"*Speak.ps1*\" OR contextinfo=\"*Start-CaptureServer.ps1*\" OR contextinfo=\"*Start-WebcamRecorder.ps1*\" OR contextinfo=\"*StringToBase64.ps1*\" OR contextinfo=\"*TexttoExe.ps1*\" OR contextinfo=\"*VolumeShadowCopyTools.ps1*\" OR contextinfo=\"*WinPwn.ps1*\" OR contextinfo=\"*WSUSpendu.ps1*\") OR (contextinfo=\"*Invoke-Sharp*\" contextinfo=\"*.ps1*\")",
  "Tags": [
    "attack.execution",
    "attack.t1059.001"
  ],
  "Version": "0.1"
}