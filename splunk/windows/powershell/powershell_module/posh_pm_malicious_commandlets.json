{
  "Description": "Detects Commandlet names from well-known PowerShell exploitation frameworks\n\nAuthor: Nasreddine Bencherchali (Nextron Systems)\nSigma Repository: [GitHub](https://github.com/SigmaHQ/sigma)",
  "ID": "7d0d0329-0ef1-4e84-a9f5-49500f9d7c6c",
  "InsertDate": "2025-02-03T20:32:28Z",
  "LastUpdateDate": "2025-02-03T20:32:28Z",
  "Level": "high",
  "Name": "Malicious PowerShell Commandlets - PoshModule",
  "Query": "sourcetype=\"windows-*\" (payload=\"*Add-Exfiltration*\" OR payload=\"*Add-Persistence*\" OR payload=\"*Add-RegBackdoor*\" OR payload=\"*Add-RemoteRegBackdoor*\" OR payload=\"*Add-ScrnSaveBackdoor*\" OR payload=\"*Check-VM*\" OR payload=\"*ConvertTo-Rc4ByteStream*\" OR payload=\"*Decrypt-Hash*\" OR payload=\"*Disable-ADIDNSNode*\" OR payload=\"*Disable-MachineAccount*\" OR payload=\"*Do-Exfiltration*\" OR payload=\"*Enable-ADIDNSNode*\" OR payload=\"*Enable-MachineAccount*\" OR payload=\"*Enabled-DuplicateToken*\" OR payload=\"*Exploit-Jboss*\" OR payload=\"*Export-ADR*\" OR payload=\"*Export-ADRCSV*\" OR payload=\"*Export-ADRExcel*\" OR payload=\"*Export-ADRHTML*\" OR payload=\"*Export-ADRJSON*\" OR payload=\"*Export-ADRXML*\" OR payload=\"*Find-Fruit*\" OR payload=\"*Find-GPOLocation*\" OR payload=\"*Find-TrustedDocuments*\" OR payload=\"*Get-ADIDNS*\" OR payload=\"*Get-ApplicationHost*\" OR payload=\"*Get-ChromeDump*\" OR payload=\"*Get-ClipboardContents*\" OR payload=\"*Get-FoxDump*\" OR payload=\"*Get-GPPPassword*\" OR payload=\"*Get-IndexedItem*\" OR payload=\"*Get-KerberosAESKey*\" OR payload=\"*Get-Keystrokes*\" OR payload=\"*Get-LSASecret*\" OR payload=\"*Get-MachineAccountAttribute*\" OR payload=\"*Get-MachineAccountCreator*\" OR payload=\"*Get-PassHashes*\" OR payload=\"*Get-RegAlwaysInstallElevated*\" OR payload=\"*Get-RegAutoLogon*\" OR payload=\"*Get-RemoteBootKey*\" OR payload=\"*Get-RemoteCachedCredential*\" OR payload=\"*Get-RemoteLocalAccountHash*\" OR payload=\"*Get-RemoteLSAKey*\" OR payload=\"*Get-RemoteMachineAccountHash*\" OR payload=\"*Get-RemoteNLKMKey*\" OR payload=\"*Get-RickAstley*\" OR payload=\"*Get-Screenshot*\" OR payload=\"*Get-SecurityPackages*\" OR payload=\"*Get-ServiceFilePermission*\" OR payload=\"*Get-ServicePermission*\" OR payload=\"*Get-ServiceUnquoted*\" OR payload=\"*Get-SiteListPassword*\" OR payload=\"*Get-System*\" OR payload=\"*Get-TimedScreenshot*\" OR payload=\"*Get-UnattendedInstallFile*\" OR payload=\"*Get-Unconstrained*\" OR payload=\"*Get-USBKeystrokes*\" OR payload=\"*Get-VaultCredential*\" OR payload=\"*Get-VulnAutoRun*\" OR payload=\"*Get-VulnSchTask*\" OR payload=\"*Grant-ADIDNSPermission*\" OR payload=\"*Gupt-Backdoor*\" OR payload=\"*HTTP-Login*\" OR payload=\"*Install-ServiceBinary*\" OR payload=\"*Install-SSP*\" OR payload=\"*Invoke-ACLScanner*\" OR payload=\"*Invoke-ADRecon*\" OR payload=\"*Invoke-ADSBackdoor*\" OR payload=\"*Invoke-AgentSmith*\" OR payload=\"*Invoke-AllChecks*\" OR payload=\"*Invoke-ARPScan*\" OR payload=\"*Invoke-AzureHound*\" OR payload=\"*Invoke-BackdoorLNK*\" OR payload=\"*Invoke-BadPotato*\" OR payload=\"*Invoke-BetterSafetyKatz*\" OR payload=\"*Invoke-BypassUAC*\" OR payload=\"*Invoke-Carbuncle*\" OR payload=\"*Invoke-Certify*\" OR payload=\"*Invoke-ConPtyShell*\" OR payload=\"*Invoke-CredentialInjection*\" OR payload=\"*Invoke-DAFT*\" OR payload=\"*Invoke-DCSync*\" OR payload=\"*Invoke-DinvokeKatz*\" OR payload=\"*Invoke-DllInjection*\" OR payload=\"*Invoke-DNSUpdate*\" OR payload=\"*Invoke-DomainPasswordSpray*\" OR payload=\"*Invoke-DowngradeAccount*\" OR payload=\"*Invoke-EgressCheck*\" OR payload=\"*Invoke-Eyewitness*\" OR payload=\"*Invoke-FakeLogonScreen*\" OR payload=\"*Invoke-Farmer*\" OR payload=\"*Invoke-Get-RBCD-Threaded*\" OR payload=\"*Invoke-Gopher*\" OR payload=\"*Invoke-Grouper*\" OR payload=\"*Invoke-HandleKatz*\" OR payload=\"*Invoke-ImpersonatedProcess*\" OR payload=\"*Invoke-ImpersonateSystem*\" OR payload=\"*Invoke-InteractiveSystemPowerShell*\" OR payload=\"*Invoke-Internalmonologue*\" OR payload=\"*Invoke-Inveigh*\" OR payload=\"*Invoke-InveighRelay*\" OR payload=\"*Invoke-KrbRelay*\" OR payload=\"*Invoke-LdapSignCheck*\" OR payload=\"*Invoke-Lockless*\" OR payload=\"*Invoke-MalSCCM*\" OR payload=\"*Invoke-Mimikatz*\" OR payload=\"*Invoke-Mimikittenz*\" OR payload=\"*Invoke-MITM6*\" OR payload=\"*Invoke-NanoDump*\" OR payload=\"*Invoke-NetRipper*\" OR payload=\"*Invoke-Nightmare*\" OR payload=\"*Invoke-NinjaCopy*\" OR payload=\"*Invoke-OfficeScrape*\" OR payload=\"*Invoke-OxidResolver*\" OR payload=\"*Invoke-P0wnedshell*\" OR payload=\"*Invoke-Paranoia*\" OR payload=\"*Invoke-PortScan*\" OR payload=\"*Invoke-PoshRatHttp*\" OR payload=\"*Invoke-PostExfil*\" OR payload=\"*Invoke-PowerDump*\" OR payload=\"*Invoke-PowerShellTCP*\" OR payload=\"*Invoke-PowerShellWMI*\" OR payload=\"*Invoke-PPLDump*\" OR payload=\"*Invoke-PsExec*\" OR payload=\"*Invoke-PSInject*\" OR payload=\"*Invoke-PsUaCme*\" OR payload=\"*Invoke-ReflectivePEInjection*\" OR payload=\"*Invoke-ReverseDNSLookup*\" OR payload=\"*Invoke-Rubeus*\" OR payload=\"*Invoke-RunAs*\" OR payload=\"*Invoke-SafetyKatz*\" OR payload=\"*Invoke-SauronEye*\" OR payload=\"*Invoke-SCShell*\" OR payload=\"*Invoke-Seatbelt*\" OR payload=\"*Invoke-ServiceAbuse*\" OR payload=\"*Invoke-ShadowSpray*\" OR payload=\"*Invoke-Sharp*\" OR payload=\"*Invoke-Shellcode*\" OR payload=\"*Invoke-SMBScanner*\" OR payload=\"*Invoke-Snaffler*\" OR payload=\"*Invoke-Spoolsample*\" OR payload=\"*Invoke-SpraySinglePassword*\" OR payload=\"*Invoke-SSHCommand*\" OR payload=\"*Invoke-StandIn*\" OR payload=\"*Invoke-StickyNotesExtract*\" OR payload=\"*Invoke-SystemCommand*\" OR payload=\"*Invoke-Tasksbackdoor*\" OR payload=\"*Invoke-Tater*\" OR payload=\"*Invoke-Thunderfox*\" OR payload=\"*Invoke-ThunderStruck*\" OR payload=\"*Invoke-TokenManipulation*\" OR payload=\"*Invoke-Tokenvator*\" OR payload=\"*Invoke-TotalExec*\" OR payload=\"*Invoke-UrbanBishop*\" OR payload=\"*Invoke-UserHunter*\" OR payload=\"*Invoke-VoiceTroll*\" OR payload=\"*Invoke-Whisker*\" OR payload=\"*Invoke-WinEnum*\" OR payload=\"*Invoke-winPEAS*\" OR payload=\"*Invoke-WireTap*\" OR payload=\"*Invoke-WmiCommand*\" OR payload=\"*Invoke-WMIExec*\" OR payload=\"*Invoke-WScriptBypassUAC*\" OR payload=\"*Invoke-Zerologon*\" OR payload=\"*MailRaider*\" OR payload=\"*New-ADIDNSNode*\" OR payload=\"*New-DNSRecordArray*\" OR payload=\"*New-HoneyHash*\" OR payload=\"*New-InMemoryModule*\" OR payload=\"*New-MachineAccount*\" OR payload=\"*New-SOASerialNumberArray*\" OR payload=\"*Out-Minidump*\" OR payload=\"*Port-Scan*\" OR payload=\"*PowerBreach*\" OR payload=\"*powercat *\" OR payload=\"*PowerUp*\" OR payload=\"*PowerView*\" OR payload=\"*Remove-ADIDNSNode*\" OR payload=\"*Remove-MachineAccount*\" OR payload=\"*Remove-Update*\" OR payload=\"*Rename-ADIDNSNode*\" OR payload=\"*Revoke-ADIDNSPermission*\" OR payload=\"*Set-ADIDNSNode*\" OR payload=\"*Set-MacAttribute*\" OR payload=\"*Set-MachineAccountAttribute*\" OR payload=\"*Set-Wallpaper*\" OR payload=\"*Show-TargetScreen*\" OR payload=\"*Start-CaptureServer*\" OR payload=\"*Start-Dnscat2*\" OR payload=\"*Start-WebcamRecorder*\" OR payload=\"*VolumeShadowCopyTools*\")",
  "Tags": [
    "attack.execution",
    "attack.discovery",
    "attack.t1482",
    "attack.t1087",
    "attack.t1087.001",
    "attack.t1087.002",
    "attack.t1069.001",
    "attack.t1069.002",
    "attack.t1069",
    "attack.t1059.001"
  ],
  "Version": "0.1"
}